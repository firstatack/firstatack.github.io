<p>En este reto de <a href="https://dockerlabs.es" title="DockerLabs">DockerLabs</a> practicamos.</p>

<ul>
  <li>Un poco de nmap</li>
  <li>Bash</li>
  <li>Esteganografia</li>
</ul>

<h2 id="herramientas-y-recursos">Herramientas y recursos</h2>

<ul>
  <li>nmap</li>
  <li>steghide</li>
  <li>John th ripper</li>
</ul>

<h2 id="reconocimiento-y-enumeracion">Reconocimiento y enumeracion</h2>

<p>Lo primero como siempre le tiramos un nmap con los parámetros de costumbre.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>nmap <span class="nt">-p-</span> <span class="nt">-sS</span> <span class="nt">-sC</span> <span class="nt">-sV</span> <span class="nt">--min-rate</span><span class="o">=</span>5000 <span class="nt">-n</span> <span class="nt">-Pn</span> <span class="nt">-oX</span> nuevo 172.17.0.2
</code></pre></div></div>

<p><a href="/reporte/nuevo.html">reporte</a></p>

<p>Como vemos en el reporte disponemos de dos puertos abiertos uno el 22 servicio ssh y el 80 http con apache.</p>

<p>La version que nos indica nmap de ssh parece ser buena para enumeracion de usuarios.</p>

<p>No obsatante y por si trabajamos o pensamos trabajar realizando pentest es importante ser sigilisos  y recabar toda la informacion posible antes de empezar a hacer ruido de verdad.</p>

<p>Dicho eso hay comandos de nmap mejores no como el de arriba.</p>

<p>Primero reviso la WEB</p>

<p>La web parace que es la default de apache pero hay varias cosas cambiadas sutilmente.</p>

<p><img src="assets/nuevo/web.png" alt="web" /></p>

<p>Si leemos bien veremos que nos da info y rutas interesantes y que no debia estar en esa pagina.</p>

<p>Sigiendo uno de los enlaces me lleva a otra pagina con con mas info.</p>

<p><img src="assets/nuevo/bob.png" alt="bobsponge" /></p>

<p>Aqui nos habla de la importancia de los metodos como haciendo referecnia al tipo de solicitud.</p>

<p>En una de las rutas encuentraremos un directorio upload que contiene una imagen la descargo.</p>

<p><img src="assets/nuevo/imgre.png" alt="recall" /></p>

<p>Lo primero que pruebo es por si la imagen esconde algo , hago uso de steghide.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>steghide info ohrecallwin.jpg
</code></pre></div></div>

<p><img src="assets/nuevo/imginfo.png" alt="imginfo" /></p>

<p>Como vemos nos indica que necesitamos un salvoconducto para ver como se cifro y que contiene.</p>

<p>Si regresamos a la web de bob nos habla de los metodos  y la de default nos da un ruta , hay que fijarse.</p>

<p>Si lanzamos una peticion GET nos da esa respuesta.</p>

<p><img src="assets/nuevo/metodono.png" alt="method" /></p>

<p>Ahora desde la terminal lanzo la correcta.</p>

<p><img src="assets/nuevo/put.png" alt="put" /></p>

<p>Me devuelve lo que debe ser el salvoconducto.</p>

<p><img src="assets/nuevo/stegofull.png" alt="ste" /></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>steghide extract <span class="nt">-sf</span> ohnorecallwin.jpg
</code></pre></div></div>
<p>Nos devuelve un archivo zip que esta tambien protegido , hacemos uso de john, primero hasheamos y a posterior crak.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>zip2jonh seguro.zip <span class="o">&gt;</span> <span class="nb">hash
</span>john <span class="nb">hash</span> <span class="nt">--show</span>
</code></pre></div></div>

<p>Abrimos el zip con el pass que nos entrega john y leemos el contenido del txt.</p>

<p>Ahora tenemos un pass es momento de entrar al sistema.</p>

<h2 id="infiltracion">Infiltracion</h2>

<p>Hacemos login con rosa y despues de un ls -la vemos un directorio <strong>guion</strong> entramos y esta claro que ahi se escondio la pass del siguiente usuario es hora de hacer uso de unos comandos de bash.
Aqui podemos tener varias situaciones que todos los archivos pesen lo mismo y tengamos que buscar leyendo el contenido de cada uno o que el que contenga la pass sea distinto.</p>

<p><img src="assets/nuevo/rosa.png" alt="rosa" /></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">ls</span> <span class="nt">-laR</span> | <span class="nb">awk</span> <span class="s1">'{print $1, $5, $9}'</span> | <span class="nb">sed</span> <span class="s1">'/14/d'</span>
</code></pre></div></div>

<p><img src="assets/nuevo/direcotio.png" alt="direc" /></p>

<p>Una vez obtenido solo leemos el fichero y obtenemos el pass del otro usuario.</p>

<h2 id="movimiento-lateral">Movimiento lateral</h2>

<p>Una vez dentro como pedro tenemos un directorio nombrado “…” acedemos y leemos la nota , en esta ocoasion con un simple comando podemos encontrar la siguiente pass.</p>

<p><img src="assets/nuevo/secretope.png" alt="secrepe" /></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>find / <span class="nt">-type</span> <span class="nt">-f</span> <span class="nt">-user</span> pedro 2&gt;/dev/null
</code></pre></div></div>

<p>Encontamos el archivo y la pass esta codificada en base64 la decodeamos y hacermos login con juan.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s1">'cadena a decodear'</span> | <span class="nb">base64</span> <span class="nt">-d</span>
</code></pre></div></div>

<p>Por fin somos juan veamos que tenemos.</p>

<p>Despues de revisar todo encontramos el pass de root en un alias.</p>

<p><img src="assets/nuevo/root.png" alt="root" /></p>

<p>Gracias por leer</p>

