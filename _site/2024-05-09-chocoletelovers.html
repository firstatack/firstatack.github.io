<p><img src="assets/logo-dockerlabs.png" alt="logodocker" w="200" h="200" /></p>

<p>En este reto de <a href="https://dockerlabs.es" title="dockerlabs">DockerLabs</a>  encontramos con escaneo de puertos para buscar una entrada al sistema  , fuzzing de directorios y de parametros y por ultimo escalada.</p>

<h2 id="herramientas-y-recursos-usados">Herramientas y recursos usados</h2>

<ul>
  <li>nmap</li>
  <li>Feroxbuster</li>
  <li>Exploit nibble</li>
</ul>

<h2 id="enumeracion">Enumeracion</h2>

<p>Empezamos lanzando un nmap contra el objetivo .</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>nmap <span class="nt">-p-</span> <span class="nt">-sS</span> <span class="nt">-sC</span> <span class="nt">-sV</span> <span class="nt">--min-rate</span><span class="o">=</span>5000 <span class="nt">-n</span> <span class="nt">-vvv</span> 172.17.0.2 <span class="nt">-oX</span> Chocolate
</code></pre></div></div>
<p><a href="/reporte/chocolatelover.html" title="reportesnmap">Reporte nmap</a></p>

<p>Revisamos la web a ver que encontramos es la de default , mientras le miramos el codigo lanzamos , feroxbuster.</p>

<p><img src="assets/chocolatelover/codepage.png" alt="codepage" /></p>

<p>Encontramos un comentario que hace alusion a un cms. Modificamos parametros en ferox buster y lo lanzamos a la nueva ruta.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>feroxbuster <span class="nt">-t</span> 400 <span class="nt">-e</span> <span class="nt">-x</span> php,txt,html,jpg,json,js <span class="nt">-s</span> 200 <span class="nt">-u</span> http://172.17.0.2/nibbleblog
</code></pre></div></div>

<p><img src="assets/chocolatelover/feroxnibble.png" alt="ferox" /></p>

<p>Como podemos ver nos muestra todo lo que hay incluso el login ,vamos al login directos no parece que se hay modificado nada y sea una instalacion totalmente limpia.</p>

<p>Estamos de suerte con password por defecto y dentro.</p>

<p><img src="assets/chocolatelover/webadmin.png" alt="web" /></p>

<p>Vamos a buscar la version del nibbleblog y buscar en google que se puede hacer.San google.</p>

<p><img src="assets/chocolatelover/nibbleversion.png" alt="versionnib" /></p>

<p>En todo lo que he mirado activan un plugin “my image” despues suben su archivo malicioso , si no he leido mal tambien lo podeis hacer con msfconcole.</p>

<h2 id="explotacion">Explotacion</h2>

<p>Activo plugin cargando el fichero.</p>

<p><img src="assets/chocolatelover/myimage.png" alt="myimage" /></p>

<p>Una vez cargado solo que queda ir a la url correcta.</p>

<p><img src="assets/chocolatelover/webshell.png" alt="webshell" /></p>

<p>Ahora nos enviamos una revshell , primero nc a la escucha.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nc <span class="nt">-lnvp</span> 443
</code></pre></div></div>

<p>Y en la webshell.</p>

<p><img src="assets/chocolatelover/revshell.png" alt="revshell" /></p>

<h2 id="infiltracion-y-movimientos-laterales">Infiltracion y movimientos laterales</h2>

<p>Yo en la conexion recibida hacemos un sudo -l .</p>

<p><img src="assets/chocolatelover/sudowww.png" alt="sudowww" /></p>

<p>Podemos convertinos en el usario chocolate usando php , para ello hacemos caso a searchbins.</p>

<p><img src="assets/chocolatelover/searchbins.png" alt="searchbins" /></p>

<p><img src="assets/chocolatelover/chocolate.png" alt="chocolate" /></p>

<p>Ahora ya como usuario chocolate volvemos a buscar como escalar.</p>

<p>Encontramos un script ejecutado por root pero en el que podemos escribir.
lover
<img src="assets/chocolatelover/psaux.png" alt="ps" /></p>

<p><img src="assets/chocolatelover/permisos.png" alt="permisos" /></p>

<p>Como yo sigo con mis problemas con las revshells y los editores de texto (todos me dicen unknown terminal).</p>

<h2 id="escalada-final">Escalada Final</h2>

<p>Creo un archivo con el mismo nombre en mi computador y lo subo a traves de python en atacante y wget en victima , me espero 5 segundos a que se ejecute y bualaaa!!!!</p>

<blockquote class="prompt-info">
  <p>Como revshell utilice la de pentestmonkey</p>
</blockquote>

<p><img src="assets/chocolatelover/root.png" alt="root" /></p>

<p>Saludos y muchas gracias por leer, pueden comentar dudas o si la han resuleto de otra forma debatamos cual metodo es mas eficaz.</p>

