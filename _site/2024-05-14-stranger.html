<p><img src="assets/logo-dockerlabs.png" alt="logodocker" w="200" h="200" /></p>

<p>En este reto de <a href="https://dockerlabs.es" title="dockerlabs">DockerLabs</a>  encontramos con escaneo de puertos para buscar una entrada al sistema, enumeracion de directorios ,desencriptacion</p>

<h2 id="herramientas-y-recursos-usados">Herramientas y recursos usados</h2>

<ul>
  <li>Nmap</li>
  <li>feroxbuster</li>
  <li>file</li>
  <li>openssl</li>
</ul>

<h2 id="enumeracion">Enumeracion</h2>

<p>Empezamos lanzando un nmap contra el objetivo .</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap <span class="nt">-p</span> 21,22,80 <span class="nt">-sCV</span>  <span class="nt">--min-rate</span> 5000 172.17.0.2 <span class="nt">-oX</span> stranger  
</code></pre></div></div>
<p><a href="/reporte/stranger_nmap.html" title="reportesnmap">Reporte nmap</a></p>

<p>Como podemos extraer del reporte de nmap disponemos de servicio ftp , apache y ssh.</p>

<p>Revismos la web y lo primero que encointramos es un posible user.Lanzamos Feroxbuster en busca de directorios.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>feroxbuster <span class="nt">-w</span> /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt <span class="nt">-t</span> 400 <span class="nt">-e</span> <span class="nt">-x</span> php,txt,html,jpg,js <span class="nt">-u</span> http://172.17.0.2/
</code></pre></div></div>

<p><img src="assets/stranger/ferox.png" alt="ferox" /></p>

<p>Como vemos nos muestra varios archivos y carpeta que no veiamos.</p>

<p>Tratemos de ver los dos archivos y revisemos esa nueva web, de la web podemos extraer lo que tambien podrian ser usuarios y passwords anotemos.
En <strong>secret.html</strong> nos da isntruciones precisas asi que al lio con hydra.</p>

<p>Mientra hydra trabaja revisamos el <strong>private.txt</strong>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wget http://172.17.0.2/strange/private.txt
</code></pre></div></div>

<p><img src="assets/stranger/wgetprivate.png" alt="private" /></p>

<p>Para empezar no es un txt me devuelve cosas incoherentes.</p>

<p><img src="assets/stranger/file.png" alt="file" /></p>

<p>El comando file nos indica que son datos, no es asci por lo tanto diria que puede ser algo encriptado , le paso herramientas para estego y no lo reconoce.</p>

<p>No hay problema hydra encontro la passs para el ftp asi que miremos por ahi.</p>

<p><img src="assets/stranger/ftphydra.png" alt="hydraftp" /></p>

<p><img src="assets/stranger/loginftp.png" alt="ftp" /></p>

<p>Hacemos login con los credenciales obtenidos de hydra y descargamos el fichero.</p>

<p><img src="assets/stranger/pem.png" alt="pem" /></p>

<h2 id="openssl">Openssl</h2>

<p>Tenemos el fichero <strong>private.txt y el .pem</strong> file nos dijo que eran datos y desde el ftp se nos dio una clave.</p>

<p>Los ficheros <strong>pem,crt,key,ca,…</strong> para mi se asocian todos con ssl , ahora nos faltaria averiguar el algoritmo de codificacion.Y para mi conocimiento esta parte es prueba y error.</p>

<p>A probar con openssl hasta que nos de resultado positivo.</p>

<p>Despues de unos cuantos comandos sin exito y unas busquedas de google hallo el comando esquivo y resulta ser rsa.¿como se corfima en que esta encriptado?.prueba y error es una locura.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>openssl pkeyutl <span class="nt">-decrypt</span> <span class="nt">-inkey</span> private_key.pem <span class="nt">-in</span> private.txt <span class="nt">-out</span> contenido
</code></pre></div></div>
<p>Tenemos exito y nos da un pass o eso quiero pensar.</p>

<p><img src="assets/stranger/contenido.png" alt="contenido" /></p>

<h2 id="infiltracion">Infiltracion</h2>

<p>Probemos manualmente los login y el pass que tenemos.
Probe con <strong>mweeler</strong> , primer user que nos dio en la web raiz “creo recordar” y estamos dentro.</p>

<p>Una vez dentro hacemos uso de find , sudo, buscamos scripts para cambiar de usuario y no soi capaz de encontar nada con esos metodos.</p>

<p>Listo usuarios haber quienes tienen sh.</p>

<p><img src="assets/stranger/users.png" alt="users" /></p>

<p>Como vemos en la salida del passwd admin tambien tiene cuenta local y no solo en ftp probemos a entrar con las credenciales que ya tenemos.</p>

<p><img src="assets/stranger/adminin.png" alt="adminin" /></p>

<p>Llegamos al fondo eso si , no sin complicaciones.</p>

<p>Garcias por leer, si ves errores comenta yo tambien sigo aprendiendo.</p>

<blockquote>
  <table>
    <thead>
      <tr>
        <th>Posibles usuarios</th>
        <th>Posibles passwords</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>mwheeler</td>
        <td>iloveu</td>
      </tr>
      <tr>
        <td>will</td>
        <td>demogorgon</td>
      </tr>
      <tr>
        <td>demogorgon</td>
        <td> </td>
      </tr>
      <tr>
        <td>admin</td>
        <td> </td>
      </tr>
    </tbody>
  </table>
</blockquote>

<p>Muchas pistas falsas esta bueno asi hay que emplear un poco mas de logica no tanto lanzar comandos.</p>
